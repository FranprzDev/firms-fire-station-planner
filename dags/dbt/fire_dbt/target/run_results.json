{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-24T03:03:59.341322Z", "invocation_id": "4d20f832-f740-41ef-a6d1-88987cff2eeb", "invocation_started_at": "2025-09-24T03:03:56.484496Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T03:03:58.394350Z", "completed_at": "2025-09-24T03:03:58.407315Z"}, {"name": "execute", "started_at": "2025-09-24T03:03:58.407976Z", "completed_at": "2025-09-24T03:03:58.704351Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.31205010414123535, "adapter_response": {"_message": "SELECT 39429", "code": "SELECT", "rows_affected": 39429}, "message": "SELECT 39429", "failures": null, "unique_id": "model.fires_dbt.fires_data_silver", "compiled": true, "compiled_code": "\n\n-- Transici\u00f3n de Bronze a Silver: agregar provincia\nSELECT\n    CAST(latitude AS FLOAT) AS latitude,\n    CAST(longitude AS FLOAT) AS longitude,\n    CAST(brightness AS FLOAT) AS brightness,\n    CAST(scan AS FLOAT) AS scan,\n    CAST(track AS FLOAT) AS track,\n    CAST(acq_date AS DATE) AS acq_date,\n    CAST(acq_time AS VARCHAR(10)) AS acq_time,\n    CAST(satellite AS VARCHAR(10)) AS satellite,\n    CAST(instrument AS VARCHAR(10)) AS instrument,\n    CAST(confidence AS INTEGER) AS confidence,\n    CAST(version AS VARCHAR(10)) AS version,\n    CAST(bright_t31 AS FLOAT) AS bright_t31,\n    CAST(frp AS FLOAT) AS frp,\n    CAST(daynight AS VARCHAR(5)) AS daynight,\n    ingested_at,\n    validation_status,\n    source_file,\n    processing_date,\n    CAST(data_quality_score AS INTEGER) AS data_quality_score,\n    CASE\n        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'C\u00f3rdoba'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre R\u00edos'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucum\u00e1n'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuqu\u00e9n'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'R\u00edo Negro'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'\n        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'\n        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'\n        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'\n        ELSE 'Pampa'\n    END AS province\nFROM \"postgres\".\"public\".\"fires_bronze\"", "relation_name": "\"postgres\".\"public_public\".\"fires_data_silver\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T03:03:58.712157Z", "completed_at": "2025-09-24T03:03:58.719730Z"}, {"name": "execute", "started_at": "2025-09-24T03:03:58.720432Z", "completed_at": "2025-09-24T03:03:58.855983Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14580035209655762, "adapter_response": {"_message": "SELECT 13143", "code": "SELECT", "rows_affected": 13143}, "message": "SELECT 13143", "failures": null, "unique_id": "model.fires_dbt.fires_raw", "compiled": true, "compiled_code": "\n\n\n\n-- Modelo Bronze: datos MODIS validados y con metadata\nSELECT\n    CAST(latitude as FLOAT) as latitude,\n    CAST(longitude as FLOAT) as longitude,\n    CAST(brightness as FLOAT) as brightness,\n    CAST(scan as FLOAT) as scan,\n    CAST(track as FLOAT) as track,\n    CAST(acq_date as DATE) as acq_date,\n    acq_time,\n    CAST(satellite as VARCHAR(10)) as satellite,\n    CAST(instrument as VARCHAR(10)) as instrument,\n    CAST(confidence as INTEGER) as confidence,\n    CAST(version as VARCHAR(10)) as version,\n    CAST(bright_t31 as FLOAT) as bright_t31,\n    CAST(frp as FLOAT) as frp,\n    CAST(daynight as VARCHAR(5)) as daynight,\n\n    -- Metadata Bronze\n    CURRENT_TIMESTAMP as ingested_at,\n    'valid' as validation_status,\n    'modis-fire-two-months.csv' as source_file,\n    CURRENT_DATE as processing_date,\n\n    -- Data Quality Score basado en confidence\n    CASE\n        WHEN CAST(confidence as INTEGER) >= 80 THEN 100\n        WHEN CAST(confidence as INTEGER) >= 50 THEN 75\n        ELSE 50\n    END as data_quality_score\n\nFROM \"postgres\".\"public\".\"fires_raw\"\n\n-- Validaciones Bronze aplicadas en WHERE\nWHERE CAST(frp as FLOAT) > 0\n    AND CAST(confidence as INTEGER) > 30\n    AND CAST(latitude as FLOAT) IS NOT NULL\n    AND CAST(longitude as FLOAT) IS NOT NULL\n    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21\n    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53\n    AND CAST(acq_date as DATE) IS NOT NULL", "relation_name": "\"postgres\".\"public_public\".\"fires_raw\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T03:03:58.861432Z", "completed_at": "2025-09-24T03:03:58.870324Z"}, {"name": "execute", "started_at": "2025-09-24T03:03:58.871301Z", "completed_at": "2025-09-24T03:03:59.081996Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.22212672233581543, "adapter_response": {"_message": "SELECT 39429", "code": "SELECT", "rows_affected": 39429}, "message": "SELECT 39429", "failures": null, "unique_id": "model.fires_dbt.fires_enriched", "compiled": true, "compiled_code": "\n\nSELECT\n    fc.*,\n\n    CAST('Argentina' AS VARCHAR(20)) AS country,\n\n    CASE\n        WHEN fc.province IN ('Buenos Aires', 'C\u00f3rdoba', 'Santa Fe', 'Entre R\u00edos') THEN 'Pampa'\n        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucum\u00e1n', 'Santiago del Estero', 'Catamarca') THEN 'Norte'\n        ELSE 'Patagonia'\n    END AS region,\n\n    CASE\n        WHEN fc.frp >= 50 THEN 'Alta'\n        WHEN fc.frp >= 20 THEN 'Media'\n        ELSE 'Baja'\n    END as intensity_level,\n\n    ROW_NUMBER() OVER (\n        PARTITION BY fc.acq_date, fc.latitude, fc.longitude\n        ORDER BY fc.acq_time\n    ) as fire_id\n\nFROM \"postgres\".\"public_public\".\"fires_data_silver\" fc", "relation_name": "\"postgres\".\"public_public\".\"fires_enriched\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T03:03:59.087070Z", "completed_at": "2025-09-24T03:03:59.094654Z"}, {"name": "execute", "started_at": "2025-09-24T03:03:59.095264Z", "completed_at": "2025-09-24T03:03:59.184742Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09937286376953125, "adapter_response": {"_message": "SELECT 13143", "code": "SELECT", "rows_affected": 13143}, "message": "SELECT 13143", "failures": null, "unique_id": "model.fires_dbt.fires_cleaned", "compiled": true, "compiled_code": "\n\n-- Modelo intermedio: datos limpios desde fires_raw\n-- Este modelo act\u00faa como puente entre bronze y silver layer\nSELECT\n    *,\n    CASE\n        WHEN frp >= 50 THEN 'Alta'\n        WHEN frp >= 20 THEN 'Media'\n        ELSE 'Baja'\n    END as intensity_level,\n    \n    ROW_NUMBER() OVER (\n        PARTITION BY acq_date, latitude, longitude \n        ORDER BY acq_time\n    ) as fire_id\n\nFROM \"postgres\".\"public_public\".\"fires_raw\"\n\nWHERE validation_status = 'valid'\n    AND confidence > 30\n    AND frp > 0", "relation_name": "\"postgres\".\"public_public\".\"fires_cleaned\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T03:03:59.190335Z", "completed_at": "2025-09-24T03:03:59.197808Z"}, {"name": "execute", "started_at": "2025-09-24T03:03:59.198392Z", "completed_at": "2025-09-24T03:03:59.318397Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1300525665283203, "adapter_response": {"_message": "SELECT 1042", "code": "SELECT", "rows_affected": 1042}, "message": "SELECT 1042", "failures": null, "unique_id": "model.fires_dbt.fires_daily", "compiled": true, "compiled_code": "\n\nSELECT\n    acq_date,\n    satellite,\n    province,\n    region,\n\n    COUNT(*) as total_fires,\n    COUNT(DISTINCT fire_id) as unique_fires,\n\n    ROUND(AVG(frp)::numeric, 2) as avg_frp,\n    ROUND(MAX(frp)::numeric, 2) as max_frp,\n    ROUND(SUM(frp)::numeric, 2) as total_frp,\n\n    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,\n    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,\n    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,\n\n    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,\n    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,\n\n    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,\n    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31\n\nFROM \"postgres\".\"public_public\".\"fires_enriched\"\nGROUP BY acq_date, satellite, province, region\nORDER BY acq_date DESC, total_fires DESC", "relation_name": "\"postgres\".\"public_public\".\"fires_daily\"", "batch_results": null}], "elapsed_time": 1.0927894115447998, "args": {"use_fast_test_edges": false, "send_anonymous_usage_stats": true, "select": [], "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "printer_width": 80, "project_dir": "/usr/local/airflow/dags/dbt/fire_dbt", "favor_state": false, "log_format": "default", "partial_parse": true, "profiles_dir": "/usr/local/airflow/dags/dbt/fire_dbt", "require_batched_execution_for_custom_microbatch_strategy": false, "defer": false, "invocation_command": "dbt run", "exclude": [], "state_modified_compare_vars": false, "static_parser": true, "populate_cache": true, "require_resource_names_without_spaces": true, "log_file_max_bytes": 10485760, "show_all_deprecations": false, "skip_nodes_if_on_run_start_fails": false, "indirect_selection": "eager", "use_colors": true, "version_check": true, "cache_selected_only": false, "require_all_warnings_handled_by_warn_error": false, "partial_parse_file_diff": true, "show_resource_report": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "log_path": "/usr/local/airflow/dags/dbt/fire_dbt/logs", "print": true, "vars": {}, "empty": false, "write_json": true, "quiet": false, "introspect": true, "state_modified_compare_more_unrendered_values": false, "require_yaml_configuration_for_mf_time_spines": false, "which": "run", "require_generic_test_arguments_property": true, "log_level": "info", "use_colors_file": true, "log_format_file": "debug", "strict_mode": false, "validate_macro_args": false, "source_freshness_run_project_hooks": true, "upload_to_artifacts_ingest_api": false, "require_nested_cumulative_type_params": false, "macro_debugging": false}}