[0m05:01:06.364357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d535a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d507cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d5368a40>]}


============================== 05:01:06.404918 | a5291720-4f37-4ecd-9cac-aa62204bb2ab ==============================
[0m05:01:06.404918 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:01:06.405788 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'empty': 'False', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_format': 'default', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'static_parser': 'True'}
[0m05:01:06.411421 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
  
[0m05:01:06.413302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11072302, "process_in_blocks": "728", "process_kernel_time": 0.28657, "process_mem_max_rss": "123040", "process_out_blocks": "0", "process_user_time": 1.838829}
[0m05:01:06.413884 [debug] [MainThread]: Command `dbt run` failed at 05:01:06.413787 after 0.11 seconds
[0m05:01:06.414340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d7767830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d4ab9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d53de840>]}
[0m05:01:06.414823 [debug] [MainThread]: Flushing usage events
[0m05:01:07.658736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:12:28.679083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747809b11c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747809891bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747809b25280>]}


============================== 05:12:28.720971 | bb9996a3-2391-4640-88d0-91c1c9dd9a75 ==============================
[0m05:12:28.720971 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:12:28.721644 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'no_print': 'None', 'partial_parse': 'True'}
[0m05:12:28.727817 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:12:28.728339 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev
[0m05:12:28.729794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.108145274, "process_in_blocks": "56200", "process_kernel_time": 0.298636, "process_mem_max_rss": "122872", "process_out_blocks": "0", "process_user_time": 1.892708}
[0m05:12:28.730277 [debug] [MainThread]: Command `dbt run` failed at 05:12:28.730182 after 0.11 seconds
[0m05:12:28.730689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74780a10b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747809032120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747809068440>]}
[0m05:12:28.731117 [debug] [MainThread]: Flushing usage events
[0m05:12:29.791985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:13:16.143385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3fac1cf5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3fac23c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3fac414c20>]}


============================== 05:13:16.189040 | 7ffc74bb-7634-47be-b9c6-b791b780ec53 ==============================
[0m05:13:16.189040 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:13:16.189845 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'debug': 'False', 'use_colors': 'True', 'log_format': 'default', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'quiet': 'False', 'warn_error': 'None', 'introspect': 'True'}
[0m05:13:16.197742 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:13:16.198401 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev
[0m05:13:16.199855 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11445144, "process_in_blocks": "56520", "process_kernel_time": 0.295073, "process_mem_max_rss": "122904", "process_out_blocks": "0", "process_user_time": 1.894052}
[0m05:13:16.200390 [debug] [MainThread]: Command `dbt run` failed at 05:13:16.200277 after 0.12 seconds
[0m05:13:16.200809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3fac2cb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3fabe2acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3fae523860>]}
[0m05:13:16.201239 [debug] [MainThread]: Flushing usage events
[0m05:13:16.821317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:14:15.455230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757188ffb8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757188542de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75718870b110>]}


============================== 05:14:15.499902 | 33c58034-bffb-46d3-8571-090ccd2e8ca2 ==============================
[0m05:14:15.499902 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:14:15.500570 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'use_experimental_parser': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'target_path': 'None', 'empty': 'False', 'printer_width': '80', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'quiet': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'debug': 'False'}
[0m05:14:15.506486 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:14:15.506993 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev
[0m05:14:15.508501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.112531126, "process_in_blocks": "56520", "process_kernel_time": 0.327147, "process_mem_max_rss": "122376", "process_out_blocks": "0", "process_user_time": 1.923468}
[0m05:14:15.509056 [debug] [MainThread]: Command `dbt run` failed at 05:14:15.508898 after 0.11 seconds
[0m05:14:15.509512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757188713500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75718855cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757188971c10>]}
[0m05:14:15.509954 [debug] [MainThread]: Flushing usage events
[0m05:14:16.679717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:14:30.037899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71367b0d9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71367d5d8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71367d5f0f80>]}


============================== 05:14:30.075897 | 33f01a71-3e8d-4b5f-9d62-420dd925f47d ==============================
[0m05:14:30.075897 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:14:30.076588 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'log_format': 'default', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'empty': 'False', 'write_json': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None'}
[0m05:14:30.082984 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:14:30.083705 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev
[0m05:14:30.084937 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.104628675, "process_in_blocks": "0", "process_kernel_time": 0.310821, "process_mem_max_rss": "122976", "process_out_blocks": "0", "process_user_time": 1.89282}
[0m05:14:30.085506 [debug] [MainThread]: Command `dbt run` failed at 05:14:30.085404 after 0.11 seconds
[0m05:14:30.085955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71367ef7ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71367aa76030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71367b1093a0>]}
[0m05:14:30.086429 [debug] [MainThread]: Flushing usage events
[0m05:14:30.679916 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:14:37.660838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77be7d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77c7b0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77c7c8890>]}


============================== 05:14:37.699673 | ad0eef74-dd23-413b-afc8-55d84b044afd ==============================
[0m05:14:37.699673 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:14:37.700429 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'quiet': 'False', 'warn_error': 'None', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'indirect_selection': 'eager', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'empty': 'None'}
[0m05:14:37.729259 [info ] [MainThread]: dbt version: 1.10.11
[0m05:14:37.729905 [info ] [MainThread]: python version: 3.12.11
[0m05:14:37.730404 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:14:37.730913 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m05:14:37.740094 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:14:37.740798 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/fire_dbt
[0m05:14:37.741364 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
[0m05:14:37.741801 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml
[0m05:14:37.798816 [info ] [MainThread]: Configuration:
[0m05:14:37.799657 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m05:14:37.800164 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m05:14:37.800677 [info ] [MainThread]: Required dependencies:
[0m05:14:37.801192 [debug] [MainThread]: Executing "git --help"
[0m05:14:37.805992 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m05:14:37.806700 [info ] [MainThread]: Connection test skipped since no profile was found
[0m05:14:37.807331 [info ] [MainThread]: [31m3 checks failed:[0m
[0m05:14:37.807828 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev


[0m05:14:37.808358 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path []: Additional properties are not allowed ('target' was unexpected)

Error encountered in /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml


[0m05:14:37.808951 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m05:14:37.810340 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.20945089, "process_in_blocks": "768", "process_kernel_time": 0.307861, "process_mem_max_rss": "122936", "process_out_blocks": "0", "process_user_time": 1.95912}
[0m05:14:37.810893 [debug] [MainThread]: Command `dbt debug` failed at 05:14:37.810800 after 0.21 seconds
[0m05:14:37.811377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77a33acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77a33cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb779d35130>]}
[0m05:14:37.811916 [debug] [MainThread]: Flushing usage events
[0m05:14:38.425390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:14:47.729897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecd54b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecddb4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecdf1d2b0>]}


============================== 05:14:47.769494 | 8f5a033e-1cdc-49c2-b7b2-b3cf29240364 ==============================
[0m05:14:47.769494 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:14:47.770317 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'warn_error': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'version_check': 'True', 'empty': 'None', 'use_colors': 'True', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None'}
[0m05:14:47.788569 [info ] [MainThread]: dbt version: 1.10.11
[0m05:14:47.789165 [info ] [MainThread]: python version: 3.12.11
[0m05:14:47.789688 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:14:47.790157 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m05:14:47.800007 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:14:47.800734 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/fire_dbt
[0m05:14:47.801334 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
[0m05:14:47.801808 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml
[0m05:14:47.898461 [info ] [MainThread]: Configuration:
[0m05:14:47.899340 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m05:14:47.899980 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:14:47.900494 [info ] [MainThread]: Required dependencies:
[0m05:14:47.901006 [debug] [MainThread]: Executing "git --help"
[0m05:14:47.902465 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m05:14:47.902965 [info ] [MainThread]: Connection test skipped since no profile was found
[0m05:14:47.903497 [info ] [MainThread]: [31m2 checks failed:[0m
[0m05:14:47.903940 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev


[0m05:14:47.904446 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m05:14:47.905582 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.23957731, "process_in_blocks": "0", "process_kernel_time": 0.326112, "process_mem_max_rss": "123000", "process_out_blocks": "0", "process_user_time": 1.968603}
[0m05:14:47.906097 [debug] [MainThread]: Command `dbt debug` failed at 05:14:47.906004 after 0.24 seconds
[0m05:14:47.906603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecdd1d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecd6928a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecd71d880>]}
[0m05:14:47.907132 [debug] [MainThread]: Flushing usage events
[0m05:14:48.552452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:15:26.489634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a497a12e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a49708ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a499521970>]}


============================== 05:15:26.530377 | 09eb88ca-e597-4238-8773-bcfd1616def6 ==============================
[0m05:15:26.530377 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:15:26.531106 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt debug', 'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'log_format': 'default', 'empty': 'None', 'no_print': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False'}
[0m05:15:26.548254 [info ] [MainThread]: dbt version: 1.10.11
[0m05:15:26.548921 [info ] [MainThread]: python version: 3.12.11
[0m05:15:26.549463 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:15:26.550001 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m05:15:26.559102 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:15:26.559701 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/fire_dbt
[0m05:15:26.560149 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
[0m05:15:26.560632 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml
[0m05:15:26.617633 [info ] [MainThread]: Configuration:
[0m05:15:26.618309 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m05:15:26.618834 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m05:15:26.619372 [info ] [MainThread]: Required dependencies:
[0m05:15:26.620029 [debug] [MainThread]: Executing "git --help"
[0m05:15:26.621711 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m05:15:26.622217 [info ] [MainThread]: Connection test skipped since no profile was found
[0m05:15:26.622791 [info ] [MainThread]: [31m3 checks failed:[0m
[0m05:15:26.623308 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev


[0m05:15:26.623827 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path []: Additional properties are not allowed ('target' was unexpected)

Error encountered in /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml


[0m05:15:26.624306 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m05:15:26.625526 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.19257554, "process_in_blocks": "0", "process_kernel_time": 0.29175, "process_mem_max_rss": "123084", "process_out_blocks": "0", "process_user_time": 1.85841}
[0m05:15:26.626059 [debug] [MainThread]: Command `dbt debug` failed at 05:15:26.625960 after 0.19 seconds
[0m05:15:26.626516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a497a14980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a4967c3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a4967c21e0>]}
[0m05:15:26.626991 [debug] [MainThread]: Flushing usage events
[0m05:15:27.842136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:16:50.852931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc4141e4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc415eec770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc413a60c20>]}


============================== 05:16:50.894095 | 3d00c53c-503f-48a8-ac26-2c1e5e148794 ==============================
[0m05:16:50.894095 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:16:50.894802 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'use_colors': 'True', 'quiet': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'None', 'no_print': 'None'}
[0m05:16:50.911086 [info ] [MainThread]: dbt version: 1.10.11
[0m05:16:50.911651 [info ] [MainThread]: python version: 3.12.11
[0m05:16:50.912196 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:16:50.912732 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m05:16:50.921636 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:16:50.922236 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/fire_dbt
[0m05:16:50.922769 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
[0m05:16:50.923195 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml
[0m05:16:51.008926 [info ] [MainThread]: Configuration:
[0m05:16:51.009627 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m05:16:51.010081 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:16:51.010528 [info ] [MainThread]: Required dependencies:
[0m05:16:51.010989 [debug] [MainThread]: Executing "git --help"
[0m05:16:51.012333 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m05:16:51.012772 [info ] [MainThread]: Connection test skipped since no profile was found
[0m05:16:51.013289 [info ] [MainThread]: [31m2 checks failed:[0m
[0m05:16:51.013728 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev


[0m05:16:51.014214 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m05:16:51.015240 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.21890254, "process_in_blocks": "0", "process_kernel_time": 0.252374, "process_mem_max_rss": "122908", "process_out_blocks": "0", "process_user_time": 1.910834}
[0m05:16:51.015732 [debug] [MainThread]: Command `dbt debug` failed at 05:16:51.015636 after 0.22 seconds
[0m05:16:51.016169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc413bc6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc4141e8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc413a60c20>]}
[0m05:16:51.016595 [debug] [MainThread]: Flushing usage events
[0m05:16:52.242465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:17:09.826645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f87bad30e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f87d455580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f87dd0c650>]}


============================== 05:17:09.867665 | 565b2037-c749-4933-a69a-e8921a5830a8 ==============================
[0m05:17:09.867665 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:17:09.868652 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'invocation_command': 'dbt debug', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'use_colors': 'True', 'version_check': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'printer_width': '80', 'warn_error': 'None', 'fail_fast': 'False'}
[0m05:17:09.885037 [info ] [MainThread]: dbt version: 1.10.11
[0m05:17:09.885590 [info ] [MainThread]: python version: 3.12.11
[0m05:17:09.886147 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:17:09.886652 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m05:17:09.895165 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:17:09.895712 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/fire_dbt
[0m05:17:09.896163 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
[0m05:17:09.896653 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml
[0m05:17:09.983366 [info ] [MainThread]: Configuration:
[0m05:17:09.984154 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m05:17:09.984780 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:17:09.985297 [info ] [MainThread]: Required dependencies:
[0m05:17:09.985803 [debug] [MainThread]: Executing "git --help"
[0m05:17:09.987136 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m05:17:09.987573 [info ] [MainThread]: Connection test skipped since no profile was found
[0m05:17:09.988020 [info ] [MainThread]: [31m2 checks failed:[0m
[0m05:17:09.988486 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev


[0m05:17:09.988968 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m05:17:09.990023 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.22047564, "process_in_blocks": "0", "process_kernel_time": 0.294966, "process_mem_max_rss": "122960", "process_out_blocks": "0", "process_user_time": 1.885395}
[0m05:17:09.990517 [debug] [MainThread]: Command `dbt debug` failed at 05:17:09.990430 after 0.22 seconds
[0m05:17:09.990942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f87b34c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f87d455580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f87da55fa0>]}
[0m05:17:09.991390 [debug] [MainThread]: Flushing usage events
[0m05:17:10.662337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:18:35.558560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c37f6d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c3783c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c3814d580>]}


============================== 05:18:35.600670 | 0d82ce88-7859-4334-ae1f-e26e8eb08c68 ==============================
[0m05:18:35.600670 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:18:35.601418 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'debug': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'partial_parse': 'True', 'printer_width': '80', 'quiet': 'False', 'empty': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'invocation_command': 'dbt debug'}
[0m05:18:35.618398 [info ] [MainThread]: dbt version: 1.10.11
[0m05:18:35.619014 [info ] [MainThread]: python version: 3.12.11
[0m05:18:35.619505 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:18:35.619979 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m05:18:35.628784 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:18:35.700188 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:18:35.701303 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/fire_dbt
[0m05:18:35.702128 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
[0m05:18:35.702861 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml
[0m05:18:35.704174 [info ] [MainThread]: adapter type: postgres
[0m05:18:35.704751 [info ] [MainThread]: adapter version: 1.9.1
[0m05:18:35.809948 [info ] [MainThread]: Configuration:
[0m05:18:35.810671 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:18:35.811284 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:18:35.811752 [info ] [MainThread]: Required dependencies:
[0m05:18:35.812218 [debug] [MainThread]: Executing "git --help"
[0m05:18:35.813619 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m05:18:35.814083 [info ] [MainThread]: Connection:
[0m05:18:35.814628 [info ] [MainThread]:   host: host.docker.internal
[0m05:18:35.815072 [info ] [MainThread]:   port: 5432
[0m05:18:35.815524 [info ] [MainThread]:   user: postgres
[0m05:18:35.815968 [info ] [MainThread]:   database: postgres
[0m05:18:35.816433 [info ] [MainThread]:   schema: public
[0m05:18:35.816867 [info ] [MainThread]:   connect_timeout: 10
[0m05:18:35.817378 [info ] [MainThread]:   role: None
[0m05:18:35.817829 [info ] [MainThread]:   search_path: None
[0m05:18:35.818273 [info ] [MainThread]:   keepalives_idle: 0
[0m05:18:35.818726 [info ] [MainThread]:   sslmode: None
[0m05:18:35.819241 [info ] [MainThread]:   sslcert: None
[0m05:18:35.819676 [info ] [MainThread]:   sslkey: None
[0m05:18:35.820103 [info ] [MainThread]:   sslrootcert: None
[0m05:18:35.820502 [info ] [MainThread]:   application_name: dbt
[0m05:18:35.820947 [info ] [MainThread]:   retries: 1
[0m05:18:35.821582 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m05:18:35.899718 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m05:18:35.943330 [debug] [MainThread]: Using postgres connection "debug"
[0m05:18:35.943950 [debug] [MainThread]: On debug: select 1 as id
[0m05:18:35.944378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:18:35.954948 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m05:18:35.956187 [debug] [MainThread]: On debug: Close
[0m05:18:35.956698 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:18:35.957181 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:18:35.957691 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m05:18:35.958826 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.45813006, "process_in_blocks": "4056", "process_kernel_time": 0.328092, "process_mem_max_rss": "122988", "process_out_blocks": "0", "process_user_time": 2.200622}
[0m05:18:35.959348 [debug] [MainThread]: Command `dbt debug` failed at 05:18:35.959252 after 0.46 seconds
[0m05:18:35.959771 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:18:35.960197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c3859aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c37690650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c3749b290>]}
[0m05:18:35.960628 [debug] [MainThread]: Flushing usage events
[0m05:18:36.950369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:18:47.704254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368db96fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368da8a0f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368db9efe00>]}


============================== 05:18:47.747772 | f8906437-8587-4266-b1b1-763c070dc1b9 ==============================
[0m05:18:47.747772 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:18:47.748538 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'write_json': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error': 'None', 'empty': 'False', 'version_check': 'True'}
[0m05:18:47.754943 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:18:48.020751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368dd0a2270>]}
[0m05:18:48.074854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368db01a150>]}
[0m05:18:48.075976 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m05:18:48.160012 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m05:18:48.162423 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m05:18:48.162960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368da70b800>]}
[0m05:18:49.011153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368db6391c0>]}
[0m05:18:49.066275 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m05:18:49.071248 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m05:18:49.108052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368d955d130>]}
[0m05:18:49.108729 [info ] [MainThread]: Found 2 models, 434 macros
[0m05:18:49.109295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368da759970>]}
[0m05:18:49.111200 [info ] [MainThread]: 
[0m05:18:49.111831 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m05:18:49.112371 [info ] [MainThread]: 
[0m05:18:49.113069 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:18:49.116957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:18:49.165603 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:18:49.166484 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:18:49.167036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:18:49.178171 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m05:18:49.179802 [debug] [ThreadPool]: On list_postgres: Close
[0m05:18:49.181555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m05:18:49.187161 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m05:18:49.187673 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m05:18:49.188088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:18:49.197054 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m05:18:49.197649 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m05:18:49.198207 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:18:49.208179 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.009 seconds
[0m05:18:49.210118 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m05:18:49.211262 [debug] [ThreadPool]: On list_postgres_public: Close
[0m05:18:49.220447 [debug] [MainThread]: Using postgres connection "master"
[0m05:18:49.220974 [debug] [MainThread]: On master: BEGIN
[0m05:18:49.221385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:18:49.230771 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m05:18:49.231451 [debug] [MainThread]: Using postgres connection "master"
[0m05:18:49.231999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m05:18:49.242180 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m05:18:49.243615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368da7098b0>]}
[0m05:18:49.244208 [debug] [MainThread]: On master: ROLLBACK
[0m05:18:49.245491 [debug] [MainThread]: Using postgres connection "master"
[0m05:18:49.245975 [debug] [MainThread]: On master: BEGIN
[0m05:18:49.247872 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m05:18:49.248283 [debug] [MainThread]: On master: COMMIT
[0m05:18:49.248680 [debug] [MainThread]: Using postgres connection "master"
[0m05:18:49.249043 [debug] [MainThread]: On master: COMMIT
[0m05:18:49.250138 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:18:49.250555 [debug] [MainThread]: On master: Close
[0m05:18:49.254445 [debug] [Thread-1 (]: Began running node model.fires_dbt.model1
[0m05:18:49.255135 [info ] [Thread-1 (]: 1 of 2 START sql view model public.model1 ...................................... [RUN]
[0m05:18:49.255791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.fires_dbt.model1)
[0m05:18:49.256251 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.model1
[0m05:18:49.266601 [debug] [Thread-1 (]: Compilation Error in model model1 (models/model1.sql)
  Required var 'my_name' not found in config:
  Vars supplied to model1 = {}
[0m05:18:49.268691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368d952fa70>]}
[0m05:18:49.269475 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.model1 ............................. [[31mERROR[0m in 0.01s]
[0m05:18:49.270174 [debug] [Thread-1 (]: Finished running node model.fires_dbt.model1
[0m05:18:49.270799 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.model1' to be skipped because of status 'error'.  Reason: Compilation Error in model model1 (models/model1.sql)
  Required var 'my_name' not found in config:
  Vars supplied to model1 = {}.
[0m05:18:49.272102 [debug] [Thread-1 (]: Began running node model.fires_dbt.model2
[0m05:18:49.272715 [info ] [Thread-1 (]: 2 of 2 SKIP relation public.model2 ............................................. [[33mSKIP[0m]
[0m05:18:49.273277 [debug] [Thread-1 (]: Finished running node model.fires_dbt.model2
[0m05:18:49.274576 [debug] [MainThread]: Using postgres connection "master"
[0m05:18:49.274956 [debug] [MainThread]: On master: BEGIN
[0m05:18:49.275278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:18:49.284490 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m05:18:49.285146 [debug] [MainThread]: On master: COMMIT
[0m05:18:49.285605 [debug] [MainThread]: Using postgres connection "master"
[0m05:18:49.285990 [debug] [MainThread]: On master: COMMIT
[0m05:18:49.287190 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:18:49.287621 [debug] [MainThread]: On master: Close
[0m05:18:49.288192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:18:49.288581 [debug] [MainThread]: Connection 'model.fires_dbt.model1' was properly closed.
[0m05:18:49.289076 [info ] [MainThread]: 
[0m05:18:49.289536 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m05:18:49.290369 [debug] [MainThread]: Command end result
[0m05:18:49.313368 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m05:18:49.317957 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m05:18:49.326831 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m05:18:49.327367 [info ] [MainThread]: 
[0m05:18:49.327908 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:18:49.328426 [info ] [MainThread]: 
[0m05:18:49.329018 [error] [MainThread]: [31mFailure in model model1 (models/model1.sql)[0m
[0m05:18:49.329535 [error] [MainThread]:   Compilation Error in model model1 (models/model1.sql)
  Required var 'my_name' not found in config:
  Vars supplied to model1 = {}
[0m05:18:49.329995 [info ] [MainThread]: 
[0m05:18:49.330497 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m05:18:49.331902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6843011, "process_in_blocks": "5064", "process_kernel_time": 0.369253, "process_mem_max_rss": "126276", "process_out_blocks": "0", "process_user_time": 3.030285}
[0m05:18:49.332651 [debug] [MainThread]: Command `dbt run` failed at 05:18:49.332529 after 1.69 seconds
[0m05:18:49.333194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368da7c9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368da7302c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368db01a0f0>]}
[0m05:18:49.333723 [debug] [MainThread]: Flushing usage events
[0m05:18:49.970008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:25:56.052732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176db8ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176df8d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176f13c050>]}


============================== 05:25:56.097163 | 78df600d-e2ad-4a40-9a8e-b6b909982412 ==============================
[0m05:25:56.097163 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:25:56.097906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'log_format': 'default', 'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'debug': 'False', 'version_check': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'no_print': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'empty': 'False', 'indirect_selection': 'eager'}
[0m05:25:56.104050 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:25:56.266747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176fb421b0>]}
[0m05:25:56.320187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176f9cad50>]}
[0m05:25:56.321372 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m05:25:56.404532 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m05:25:56.499643 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m05:25:56.500557 [debug] [MainThread]: Partial parsing: added file: fires_dbt://models/fires_raw.sql
[0m05:25:56.501145 [debug] [MainThread]: Partial parsing: added file: fires_dbt://models/sources.yml
[0m05:25:56.501524 [debug] [MainThread]: Partial parsing: deleted file: fires_dbt://models/model2.sql
[0m05:25:56.501891 [debug] [MainThread]: Partial parsing: deleted file: fires_dbt://models/model1.sql
[0m05:25:56.810602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176bffcd40>]}
[0m05:25:56.869381 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m05:25:56.873465 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m05:25:56.907887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176ccdf8c0>]}
[0m05:25:56.908528 [info ] [MainThread]: Found 1 model, 1 source, 434 macros
[0m05:25:56.909070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176cfc50d0>]}
[0m05:25:56.910880 [info ] [MainThread]: 
[0m05:25:56.911548 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m05:25:56.912179 [info ] [MainThread]: 
[0m05:25:56.912963 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:25:56.914259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:25:56.962778 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:25:56.963546 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:25:56.964091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:56.975411 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m05:25:56.976928 [debug] [ThreadPool]: On list_postgres: Close
[0m05:25:56.978472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m05:25:56.984700 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m05:25:56.985289 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m05:25:56.985796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:56.995115 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m05:25:56.995850 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m05:25:56.996401 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:25:57.000535 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.004 seconds
[0m05:25:57.002434 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m05:25:57.003865 [debug] [ThreadPool]: On list_postgres_public: Close
[0m05:25:57.012887 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:57.013460 [debug] [MainThread]: On master: BEGIN
[0m05:25:57.013896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:25:57.023319 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m05:25:57.023965 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:57.024461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m05:25:57.029044 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m05:25:57.030496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176b386f60>]}
[0m05:25:57.031086 [debug] [MainThread]: On master: ROLLBACK
[0m05:25:57.032446 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:57.032861 [debug] [MainThread]: On master: BEGIN
[0m05:25:57.034768 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:25:57.035234 [debug] [MainThread]: On master: COMMIT
[0m05:25:57.035630 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:57.036056 [debug] [MainThread]: On master: COMMIT
[0m05:25:57.037346 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:25:57.037780 [debug] [MainThread]: On master: Close
[0m05:25:57.040440 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m05:25:57.041106 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fires_raw .................................. [RUN]
[0m05:25:57.041737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.fires_dbt.fires_raw)
[0m05:25:57.042275 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m05:25:57.048823 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m05:25:57.057216 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m05:25:57.091775 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m05:25:57.101847 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:25:57.102526 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m05:25:57.102973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:25:57.112833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m05:25:57.113608 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:25:57.114063 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    

select
    cast(latitude as float) as latitude,
    cast(longitude as float) as longitude,
    cast(brightness as float) as brightness,
    cast(scan as float) as scan,
    cast(track as float) as track,
    cast(acq_date as date) as acq_date,
    cast(acq_time as varchar) as acq_time,
    cast(satellite as varchar) as satellite,
    cast(instrument as varchar) as instrument,
    cast(confidence as int) as confidence,
    cast(version as varchar) as version,
    cast(bright_t31 as float) as bright_t31,
    cast(frp as float) as frp,
    cast(daynight as varchar) as daynight
from "postgres"."public"."fires_raw"
  );
  
[0m05:25:57.135020 [debug] [Thread-1 (]: SQL status: SELECT 13877 in 0.020 seconds
[0m05:25:57.143907 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:25:57.144435 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m05:25:57.146144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:25:57.149633 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:25:57.150094 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m05:25:57.151598 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:25:57.165396 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m05:25:57.166029 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:25:57.166557 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m05:25:57.179651 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m05:25:57.185684 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."fires_raw__dbt_backup"
[0m05:25:57.190972 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:25:57.191521 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public"."fires_raw__dbt_backup" cascade
[0m05:25:57.195951 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m05:25:57.198633 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m05:25:57.200560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176cfe01d0>]}
[0m05:25:57.201352 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.fires_raw ............................. [[32mSELECT 13877[0m in 0.16s]
[0m05:25:57.202115 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m05:25:57.203830 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:57.204306 [debug] [MainThread]: On master: BEGIN
[0m05:25:57.204709 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:25:57.214256 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m05:25:57.214984 [debug] [MainThread]: On master: COMMIT
[0m05:25:57.215474 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:57.215888 [debug] [MainThread]: On master: COMMIT
[0m05:25:57.217100 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:25:57.217519 [debug] [MainThread]: On master: Close
[0m05:25:57.218067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:25:57.218491 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m05:25:57.218935 [info ] [MainThread]: 
[0m05:25:57.219455 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m05:25:57.220360 [debug] [MainThread]: Command end result
[0m05:25:57.244044 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m05:25:57.248762 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m05:25:57.257357 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m05:25:57.257938 [info ] [MainThread]: 
[0m05:25:57.258545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:25:57.259078 [info ] [MainThread]: 
[0m05:25:57.259584 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m05:25:57.260788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2679242, "process_in_blocks": "264", "process_kernel_time": 0.460989, "process_mem_max_rss": "130400", "process_out_blocks": "0", "process_user_time": 2.666588}
[0m05:25:57.261368 [debug] [MainThread]: Command `dbt run` succeeded at 05:25:57.261266 after 1.27 seconds
[0m05:25:57.261893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176d6577a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176ce6baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176e0d8530>]}
[0m05:25:57.262494 [debug] [MainThread]: Flushing usage events
[0m05:25:58.778985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:29:09.121002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f2c675c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f5401970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f21e4bf0>]}


============================== 05:29:09.166617 | b1395102-37b2-4014-9143-7fd63a9e17df ==============================
[0m05:29:09.166617 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:29:09.167493 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'debug': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'printer_width': '80', 'empty': 'False', 'target_path': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs'}
[0m05:29:09.173344 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:29:09.437778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f1770410>]}
[0m05:29:09.490725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f22e6780>]}
[0m05:29:09.492222 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m05:29:09.579433 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m05:29:09.719824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:29:09.720448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:29:09.746533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f16a10d0>]}
[0m05:29:09.811050 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m05:29:09.815988 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m05:29:09.861428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f15f54c0>]}
[0m05:29:09.862078 [info ] [MainThread]: Found 1 model, 1 source, 434 macros
[0m05:29:09.862637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f15f6240>]}
[0m05:29:09.864496 [info ] [MainThread]: 
[0m05:29:09.865189 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m05:29:09.865676 [info ] [MainThread]: 
[0m05:29:09.866412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:29:09.867613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:29:09.922680 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:29:09.923266 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:29:09.923808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:29:09.936054 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m05:29:09.937572 [debug] [ThreadPool]: On list_postgres: Close
[0m05:29:09.938958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m05:29:09.944006 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m05:29:09.944437 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m05:29:09.944858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:29:09.954564 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m05:29:09.955138 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m05:29:09.955693 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:29:09.960851 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.005 seconds
[0m05:29:09.962739 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m05:29:09.964137 [debug] [ThreadPool]: On list_postgres_public: Close
[0m05:29:09.973047 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:09.973544 [debug] [MainThread]: On master: BEGIN
[0m05:29:09.973900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:29:09.983581 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m05:29:09.984199 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:09.984672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m05:29:09.989861 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m05:29:09.991123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f15f5820>]}
[0m05:29:09.991688 [debug] [MainThread]: On master: ROLLBACK
[0m05:29:09.992879 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:09.993266 [debug] [MainThread]: On master: BEGIN
[0m05:29:09.995104 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:29:09.995595 [debug] [MainThread]: On master: COMMIT
[0m05:29:09.995982 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:09.996444 [debug] [MainThread]: On master: COMMIT
[0m05:29:09.998182 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:29:09.998858 [debug] [MainThread]: On master: Close
[0m05:29:10.002741 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m05:29:10.003477 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fires_raw .................................. [RUN]
[0m05:29:10.004029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.fires_dbt.fires_raw)
[0m05:29:10.004459 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m05:29:10.010468 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m05:29:10.016382 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m05:29:10.052905 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m05:29:10.057690 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:29:10.058216 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m05:29:10.058625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:10.068671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m05:29:10.069336 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:29:10.069837 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    

select
    cast(latitude as float) as latitude,
    cast(longitude as float) as longitude,
    cast(brightness as float) as brightness,
    cast(scan as float) as scan,
    cast(track as float) as track,
    cast(acq_date as date) as acq_date,
    cast(acq_time as varchar) as acq_time,
    cast(satellite as varchar) as satellite,
    cast(instrument as varchar) as instrument,
    cast(confidence as int) as confidence,
    cast(version as varchar) as version,
    cast(bright_t31 as float) as bright_t31,
    cast(frp as float) as frp,
    cast(daynight as varchar) as daynight
from "postgres"."public"."fires_raw"
  );
  
[0m05:29:10.094452 [debug] [Thread-1 (]: SQL status: SELECT 13877 in 0.024 seconds
[0m05:29:10.103859 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:29:10.104484 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m05:29:10.106742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:29:10.109846 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:29:10.110325 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m05:29:10.111949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:29:10.126479 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m05:29:10.127162 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:29:10.127729 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m05:29:10.138451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m05:29:10.144331 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."fires_raw__dbt_backup"
[0m05:29:10.149334 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:29:10.149944 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public"."fires_raw__dbt_backup" cascade
[0m05:29:10.154441 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m05:29:10.156881 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m05:29:10.158743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f429f710>]}
[0m05:29:10.159540 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.fires_raw ............................. [[32mSELECT 13877[0m in 0.15s]
[0m05:29:10.160387 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m05:29:10.162019 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:10.162449 [debug] [MainThread]: On master: BEGIN
[0m05:29:10.162841 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:29:10.172658 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m05:29:10.173339 [debug] [MainThread]: On master: COMMIT
[0m05:29:10.173773 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:10.174167 [debug] [MainThread]: On master: COMMIT
[0m05:29:10.175379 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:29:10.175806 [debug] [MainThread]: On master: Close
[0m05:29:10.176377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:29:10.176792 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m05:29:10.177218 [info ] [MainThread]: 
[0m05:29:10.177751 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m05:29:10.178489 [debug] [MainThread]: Command end result
[0m05:29:10.200758 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m05:29:10.204770 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m05:29:10.212218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m05:29:10.212727 [info ] [MainThread]: 
[0m05:29:10.213356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:29:10.213840 [info ] [MainThread]: 
[0m05:29:10.214347 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m05:29:10.215915 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.156132, "process_in_blocks": "64976", "process_kernel_time": 0.514134, "process_mem_max_rss": "124652", "process_out_blocks": "0", "process_user_time": 2.535078}
[0m05:29:10.216500 [debug] [MainThread]: Command `dbt run` succeeded at 05:29:10.216408 after 1.16 seconds
[0m05:29:10.216966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f2405130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f294c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f14ab6e0>]}
[0m05:29:10.217438 [debug] [MainThread]: Flushing usage events
[0m05:29:11.430517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:01.561925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f9053a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f7cdb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f84a7980>]}


============================== 19:34:01.607310 | c504c1f3-c906-4e03-84dc-c17e78ee7a4a ==============================
[0m19:34:01.607310 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:34:01.607980 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'empty': 'False', 'debug': 'False', 'printer_width': '80', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'version_check': 'True', 'static_parser': 'True', 'target_path': 'None'}
[0m19:34:01.614066 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:34:01.893607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f711cb90>]}
[0m19:34:01.949086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f70a42c0>]}
[0m19:34:01.950638 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:34:02.036975 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:34:02.192054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:34:02.192896 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/sources.yml
[0m19:34:02.193356 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/fires_raw.sql
[0m19:34:02.517856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f639cda0>]}
[0m19:34:02.584188 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:34:02.588904 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:34:02.639762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f6d84710>]}
[0m19:34:02.640392 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:34:02.640903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f6ec8980>]}
[0m19:34:02.642571 [info ] [MainThread]: 
[0m19:34:02.643129 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:34:02.643623 [info ] [MainThread]: 
[0m19:34:02.644345 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:34:02.645468 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:34:02.704044 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:34:02.704668 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:34:02.705117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:02.718204 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m19:34:02.719852 [debug] [ThreadPool]: On list_postgres: Close
[0m19:34:02.720878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_bronze)
[0m19:34:02.721516 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_bronze"
"
[0m19:34:02.726395 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_bronze"
[0m19:34:02.726962 [debug] [ThreadPool]: On create_postgres_public_bronze: BEGIN
[0m19:34:02.727375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:02.737532 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:34:02.738185 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_bronze"
[0m19:34:02.738601 [debug] [ThreadPool]: On create_postgres_public_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "create_postgres_public_bronze"} */
create schema if not exists "public_bronze"
[0m19:34:02.740231 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m19:34:02.741351 [debug] [ThreadPool]: On create_postgres_public_bronze: COMMIT
[0m19:34:02.741780 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_bronze"
[0m19:34:02.742174 [debug] [ThreadPool]: On create_postgres_public_bronze: COMMIT
[0m19:34:02.744738 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m19:34:02.745209 [debug] [ThreadPool]: On create_postgres_public_bronze: Close
[0m19:34:02.746663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_bronze, now list_postgres_public_bronze)
[0m19:34:02.752159 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_bronze"
[0m19:34:02.752712 [debug] [ThreadPool]: On list_postgres_public_bronze: BEGIN
[0m19:34:02.753118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:02.763235 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:34:02.763864 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_bronze"
[0m19:34:02.764397 [debug] [ThreadPool]: On list_postgres_public_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_bronze"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m19:34:02.768717 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:34:02.770089 [debug] [ThreadPool]: On list_postgres_public_bronze: ROLLBACK
[0m19:34:02.771443 [debug] [ThreadPool]: On list_postgres_public_bronze: Close
[0m19:34:02.775514 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:02.776008 [debug] [MainThread]: On master: BEGIN
[0m19:34:02.776385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:02.786385 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:34:02.787103 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:02.787612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:34:02.793243 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:34:02.794627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f571a6f0>]}
[0m19:34:02.795212 [debug] [MainThread]: On master: ROLLBACK
[0m19:34:02.796890 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:02.797403 [debug] [MainThread]: On master: BEGIN
[0m19:34:02.799738 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:34:02.800293 [debug] [MainThread]: On master: COMMIT
[0m19:34:02.800735 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:02.801188 [debug] [MainThread]: On master: COMMIT
[0m19:34:02.802515 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:34:02.802984 [debug] [MainThread]: On master: Close
[0m19:34:02.806864 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:34:02.807612 [info ] [Thread-1 (]: 1 of 1 START sql table model public_bronze.fires_raw ........................... [RUN]
[0m19:34:02.808278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_bronze, now model.fires_dbt.fires_raw)
[0m19:34:02.808746 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:34:02.816207 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:34:02.820891 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:34:02.855441 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:34:02.860130 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:34:02.860658 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:34:02.861066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:02.871066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m19:34:02.871793 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:34:02.872426 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_bronze"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:34:02.904134 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.031 seconds
[0m19:34:02.914051 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:34:02.914716 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_bronze"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:34:02.916759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:34:02.919102 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:34:02.919639 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO bronze.fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:34:02.965245 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no partition of relation "fires_bronze" found for row
DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).

[0m19:34:02.965976 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:34:02.967555 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:34:03.075462 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  no partition of relation "fires_bronze" found for row
  DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:34:03.077761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f4bec950>]}
[0m19:34:03.078462 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_bronze.fires_raw .................. [[31mERROR[0m in 0.27s]
[0m19:34:03.079202 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:34:03.079904 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  no partition of relation "fires_bronze" found for row
  DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:34:03.081953 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:03.082375 [debug] [MainThread]: On master: BEGIN
[0m19:34:03.082742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:34:03.092480 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:34:03.093096 [debug] [MainThread]: On master: COMMIT
[0m19:34:03.093479 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:03.093815 [debug] [MainThread]: On master: COMMIT
[0m19:34:03.094974 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:34:03.095366 [debug] [MainThread]: On master: Close
[0m19:34:03.095911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:03.096382 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:34:03.096849 [info ] [MainThread]: 
[0m19:34:03.097358 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m19:34:03.098296 [debug] [MainThread]: Command end result
[0m19:34:03.123140 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:34:03.127333 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:34:03.134702 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:34:03.135268 [info ] [MainThread]: 
[0m19:34:03.135788 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:34:03.136256 [info ] [MainThread]: 
[0m19:34:03.136762 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:34:03.137273 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  no partition of relation "fires_bronze" found for row
  DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:34:03.137701 [info ] [MainThread]: 
[0m19:34:03.138191 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:34:03.138615 [info ] [MainThread]: 
[0m19:34:03.139098 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:34:03.140553 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6389753, "process_in_blocks": "68200", "process_kernel_time": 0.535609, "process_mem_max_rss": "130500", "process_out_blocks": "0", "process_user_time": 2.931967}
[0m19:34:03.141062 [debug] [MainThread]: Command `dbt run` failed at 19:34:03.140966 after 1.64 seconds
[0m19:34:03.141564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f9dd4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f4fa36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f5b8f260>]}
[0m19:34:03.141998 [debug] [MainThread]: Flushing usage events
[0m19:34:03.951846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:35:49.938689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7ac4ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7deceb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7cff87d0>]}


============================== 19:35:49.978453 | e7e06cef-9a39-4f12-a69f-3da48ca2f1ec ==============================
[0m19:35:49.978453 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:35:49.979225 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'partial_parse': 'True', 'empty': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'introspect': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False'}
[0m19:35:49.985319 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:35:50.145986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7a988d10>]}
[0m19:35:50.200892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7acc2ed0>]}
[0m19:35:50.202067 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:35:50.285555 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:35:50.397192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:35:50.397843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:35:50.426144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7a2c34d0>]}
[0m19:35:50.491685 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:35:50.496279 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:35:50.530530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe79edafc0>]}
[0m19:35:50.531274 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:35:50.531758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe79922180>]}
[0m19:35:50.533934 [info ] [MainThread]: 
[0m19:35:50.534462 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:35:50.534955 [info ] [MainThread]: 
[0m19:35:50.535620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:35:50.536687 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:35:50.585472 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:35:50.586159 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:35:50.586620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:50.597898 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m19:35:50.599534 [debug] [ThreadPool]: On list_postgres: Close
[0m19:35:50.601052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_bronze)
[0m19:35:50.606417 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_bronze"
[0m19:35:50.606927 [debug] [ThreadPool]: On list_postgres_public_bronze: BEGIN
[0m19:35:50.607416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:50.617118 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:35:50.617794 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_bronze"
[0m19:35:50.618286 [debug] [ThreadPool]: On list_postgres_public_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_bronze"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m19:35:50.622133 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m19:35:50.623579 [debug] [ThreadPool]: On list_postgres_public_bronze: ROLLBACK
[0m19:35:50.624846 [debug] [ThreadPool]: On list_postgres_public_bronze: Close
[0m19:35:50.629184 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:50.629801 [debug] [MainThread]: On master: BEGIN
[0m19:35:50.630267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:50.639479 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:35:50.640126 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:50.640659 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:35:50.645632 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:35:50.647207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7a065670>]}
[0m19:35:50.647826 [debug] [MainThread]: On master: ROLLBACK
[0m19:35:50.649261 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:50.649742 [debug] [MainThread]: On master: BEGIN
[0m19:35:50.651878 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:35:50.652389 [debug] [MainThread]: On master: COMMIT
[0m19:35:50.652831 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:50.653239 [debug] [MainThread]: On master: COMMIT
[0m19:35:50.654478 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:35:50.654913 [debug] [MainThread]: On master: Close
[0m19:35:50.657756 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:35:50.658535 [info ] [Thread-1 (]: 1 of 1 START sql table model public_bronze.fires_raw ........................... [RUN]
[0m19:35:50.659281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_bronze, now model.fires_dbt.fires_raw)
[0m19:35:50.659849 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:35:50.667395 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:35:50.673108 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:35:50.708859 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:35:50.714244 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:35:50.714826 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:35:50.715323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:50.724867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:35:50.725574 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:35:50.726099 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_bronze"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:35:50.755136 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m19:35:50.764971 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:35:50.765648 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_bronze"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:35:50.767620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:35:50.769878 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:35:50.770414 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO bronze.fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:35:50.810733 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no partition of relation "fires_bronze" found for row
DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).

[0m19:35:50.811469 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:35:50.813188 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:35:50.817318 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  no partition of relation "fires_bronze" found for row
  DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:35:50.819075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe789386e0>]}
[0m19:35:50.819808 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_bronze.fires_raw .................. [[31mERROR[0m in 0.16s]
[0m19:35:50.820566 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:35:50.821366 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  no partition of relation "fires_bronze" found for row
  DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:35:50.823343 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:50.823729 [debug] [MainThread]: On master: BEGIN
[0m19:35:50.824175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:35:50.833765 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:35:50.834441 [debug] [MainThread]: On master: COMMIT
[0m19:35:50.834903 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:50.835328 [debug] [MainThread]: On master: COMMIT
[0m19:35:50.836512 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:35:50.836922 [debug] [MainThread]: On master: Close
[0m19:35:50.837557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:50.837939 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:35:50.838373 [info ] [MainThread]: 
[0m19:35:50.838825 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m19:35:50.839722 [debug] [MainThread]: Command end result
[0m19:35:50.863334 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:35:50.867384 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:35:50.875246 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:35:50.875751 [info ] [MainThread]: 
[0m19:35:50.876304 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:35:50.876844 [info ] [MainThread]: 
[0m19:35:50.877593 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:35:50.878169 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  no partition of relation "fires_bronze" found for row
  DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:35:50.878620 [info ] [MainThread]: 
[0m19:35:50.879166 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:35:50.879600 [info ] [MainThread]: 
[0m19:35:50.880078 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:35:50.881215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0049814, "process_in_blocks": "0", "process_kernel_time": 0.368274, "process_mem_max_rss": "125160", "process_out_blocks": "0", "process_user_time": 2.525879}
[0m19:35:50.881735 [debug] [MainThread]: Command `dbt run` failed at 19:35:50.881636 after 1.01 seconds
[0m19:35:50.882238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7a5ac440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7a03dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7a1492b0>]}
[0m19:35:50.882663 [debug] [MainThread]: Flushing usage events
[0m19:35:51.688737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:39.830024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bf3f45f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bf23cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bf10deb0>]}


============================== 19:37:39.870193 | bccc81e0-8267-4979-ac85-a8cc1a150c1b ==============================
[0m19:37:39.870193 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:37:39.870929 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'target_path': 'None', 'empty': 'False', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False'}
[0m19:37:39.877483 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:37:40.039137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34be48f290>]}
[0m19:37:40.097584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bf985160>]}
[0m19:37:40.098703 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:37:40.182422 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:37:40.291589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:37:40.292544 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/sources.yml
[0m19:37:40.293010 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/fires_raw.sql
[0m19:37:40.611037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bcda4ad0>]}
[0m19:37:40.670993 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:37:40.675869 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:37:40.708784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34be242d80>]}
[0m19:37:40.709517 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:37:40.710128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bd58f8c0>]}
[0m19:37:40.711952 [info ] [MainThread]: 
[0m19:37:40.712490 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:37:40.712956 [info ] [MainThread]: 
[0m19:37:40.713663 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:37:40.714767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:37:40.761944 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:37:40.762634 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:37:40.763105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:40.773854 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m19:37:40.775495 [debug] [ThreadPool]: On list_postgres: Close
[0m19:37:40.776691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_public)
[0m19:37:40.777383 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_public"
"
[0m19:37:40.782507 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_public"
[0m19:37:40.782965 [debug] [ThreadPool]: On create_postgres_public_public: BEGIN
[0m19:37:40.783346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:40.792886 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:37:40.793598 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_public"
[0m19:37:40.794007 [debug] [ThreadPool]: On create_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "create_postgres_public_public"} */
create schema if not exists "public_public"
[0m19:37:40.795647 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m19:37:40.796710 [debug] [ThreadPool]: On create_postgres_public_public: COMMIT
[0m19:37:40.797125 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_public"
[0m19:37:40.797478 [debug] [ThreadPool]: On create_postgres_public_public: COMMIT
[0m19:37:40.799515 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m19:37:40.799948 [debug] [ThreadPool]: On create_postgres_public_public: Close
[0m19:37:40.801395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_public, now list_postgres_public_public)
[0m19:37:40.806326 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:37:40.806786 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:37:40.807233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:40.816747 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:37:40.817366 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:37:40.817813 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:37:40.821343 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m19:37:40.822689 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:37:40.823840 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:37:40.829088 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:40.829681 [debug] [MainThread]: On master: BEGIN
[0m19:37:40.830115 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:40.839646 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:37:40.840274 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:40.840813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:37:40.845625 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:37:40.847538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bc1ac650>]}
[0m19:37:40.848187 [debug] [MainThread]: On master: ROLLBACK
[0m19:37:40.849753 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:40.850263 [debug] [MainThread]: On master: BEGIN
[0m19:37:40.852173 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:37:40.852600 [debug] [MainThread]: On master: COMMIT
[0m19:37:40.852988 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:40.853363 [debug] [MainThread]: On master: COMMIT
[0m19:37:40.854447 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:37:40.854875 [debug] [MainThread]: On master: Close
[0m19:37:40.857632 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:37:40.858488 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:37:40.859294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:37:40.859837 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:37:40.867155 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:37:40.871676 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:37:40.905174 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:37:40.911207 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:37:40.911839 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:37:40.912332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:40.921890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:37:40.922702 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:37:40.923278 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:37:40.951697 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m19:37:40.961744 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:37:40.962440 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:37:40.964228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:37:40.966188 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:37:40.966717 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:37:40.969969 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:37:40.970620 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:37:40.971970 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:37:40.976092 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:37:40.978087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34b9597710>]}
[0m19:37:40.978898 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.12s]
[0m19:37:40.979647 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:37:40.980288 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:37:40.982206 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:40.982681 [debug] [MainThread]: On master: BEGIN
[0m19:37:40.983050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:40.992328 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:37:40.992993 [debug] [MainThread]: On master: COMMIT
[0m19:37:40.993479 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:40.993845 [debug] [MainThread]: On master: COMMIT
[0m19:37:40.995120 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:37:40.995553 [debug] [MainThread]: On master: Close
[0m19:37:40.996133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:40.996535 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:37:40.996985 [info ] [MainThread]: 
[0m19:37:40.997440 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m19:37:40.998239 [debug] [MainThread]: Command end result
[0m19:37:41.021586 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:37:41.025767 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:37:41.033658 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:37:41.034267 [info ] [MainThread]: 
[0m19:37:41.034841 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:37:41.035323 [info ] [MainThread]: 
[0m19:37:41.035844 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:37:41.036383 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:37:41.036805 [info ] [MainThread]: 
[0m19:37:41.037280 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:37:41.037712 [info ] [MainThread]: 
[0m19:37:41.038174 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:37:41.039299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2736015, "process_in_blocks": "0", "process_kernel_time": 0.418026, "process_mem_max_rss": "130928", "process_out_blocks": "0", "process_user_time": 2.725056}
[0m19:37:41.039805 [debug] [MainThread]: Command `dbt run` failed at 19:37:41.039711 after 1.27 seconds
[0m19:37:41.040278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34beea4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bf654590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bf10deb0>]}
[0m19:37:41.040863 [debug] [MainThread]: Flushing usage events
[0m19:37:41.869088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:59.813486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca43c5c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca458aca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca43781b20>]}


============================== 19:38:59.860127 | eb00b737-efde-478c-a975-1619fa5f4536 ==============================
[0m19:38:59.860127 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:38:59.860867 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --debug', 'empty': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'debug': 'True', 'static_parser': 'True', 'version_check': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'fail_fast': 'False'}
[0m19:38:59.868128 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:39:00.040905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca429f97f0>]}
[0m19:39:00.097635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca42d49730>]}
[0m19:39:00.099110 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:39:00.184706 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:39:00.297000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:00.297860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:00.326847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca429346b0>]}
[0m19:39:00.393938 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:39:00.398877 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:39:00.434710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca41fb3e30>]}
[0m19:39:00.435533 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:39:00.436169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca42935280>]}
[0m19:39:00.437928 [info ] [MainThread]: 
[0m19:39:00.438493 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:39:00.438976 [info ] [MainThread]: 
[0m19:39:00.439702 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:00.441183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:39:00.493641 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:39:00.494552 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:39:00.495284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:00.506650 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m19:39:00.508546 [debug] [ThreadPool]: On list_postgres: Close
[0m19:39:00.510213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:39:00.516667 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:39:00.517509 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:39:00.518051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:00.528129 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:39:00.528852 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:39:00.529419 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:39:00.534420 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:39:00.536237 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:39:00.537905 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:39:00.542526 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:00.543204 [debug] [MainThread]: On master: BEGIN
[0m19:39:00.543746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:00.554196 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:39:00.554912 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:00.555526 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:39:00.561015 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:39:00.562657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca41fb05c0>]}
[0m19:39:00.563437 [debug] [MainThread]: On master: ROLLBACK
[0m19:39:00.565103 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:00.565778 [debug] [MainThread]: On master: BEGIN
[0m19:39:00.568346 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:39:00.569008 [debug] [MainThread]: On master: COMMIT
[0m19:39:00.569633 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:00.570186 [debug] [MainThread]: On master: COMMIT
[0m19:39:00.571826 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:39:00.572532 [debug] [MainThread]: On master: Close
[0m19:39:00.575629 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:39:00.576554 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:39:00.577373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:39:00.577950 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:39:00.585608 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:39:00.591314 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:39:00.628707 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:39:00.634699 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:00.635367 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:39:00.636006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:00.646769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m19:39:00.647593 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:00.648274 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:39:00.700074 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.051 seconds
[0m19:39:00.711500 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:00.712704 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:39:00.714407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:39:00.716871 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:00.717566 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:39:00.721404 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:39:00.722225 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:39:00.723725 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:39:00.729889 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:39:00.732259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca40f3c410>]}
[0m19:39:00.733304 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.15s]
[0m19:39:00.734374 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:39:00.735219 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:39:00.737461 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:00.738058 [debug] [MainThread]: On master: BEGIN
[0m19:39:00.738541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:00.749710 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m19:39:00.750526 [debug] [MainThread]: On master: COMMIT
[0m19:39:00.751117 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:00.751658 [debug] [MainThread]: On master: COMMIT
[0m19:39:00.752978 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:39:00.753479 [debug] [MainThread]: On master: Close
[0m19:39:00.754177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:00.754642 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:39:00.755155 [info ] [MainThread]: 
[0m19:39:00.755743 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m19:39:00.756654 [debug] [MainThread]: Command end result
[0m19:39:00.781671 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:39:00.786419 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:39:00.795494 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:39:00.796238 [info ] [MainThread]: 
[0m19:39:00.797032 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:39:00.797733 [info ] [MainThread]: 
[0m19:39:00.798385 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:39:00.799025 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:39:00.799575 [info ] [MainThread]: 
[0m19:39:00.800178 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:39:00.800722 [info ] [MainThread]: 
[0m19:39:00.801318 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:39:00.802583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0528926, "process_in_blocks": "0", "process_kernel_time": 0.457724, "process_mem_max_rss": "125252", "process_out_blocks": "0", "process_user_time": 2.615}
[0m19:39:00.803442 [debug] [MainThread]: Command `dbt run` failed at 19:39:00.803329 after 1.05 seconds
[0m19:39:00.804109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca4352ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca43f0fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca4405fb90>]}
[0m19:39:00.804721 [debug] [MainThread]: Flushing usage events
[0m19:39:01.635515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:08.112742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c800962090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8004aebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c800392030>]}


============================== 19:39:08.160182 | b6ead55f-aea6-497f-90d1-80af8331688c ==============================
[0m19:39:08.160182 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:39:08.160867 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'fail_fast': 'False', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'warn_error': 'None'}
[0m19:39:08.167528 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:39:08.333771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ffc6f440>]}
[0m19:39:08.392217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c800696fc0>]}
[0m19:39:08.393398 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:39:08.477090 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:39:08.593068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:08.593669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:08.622784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ffa490d0>]}
[0m19:39:08.687823 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:39:08.692074 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:39:08.726861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ff8a3230>]}
[0m19:39:08.727530 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:39:08.727989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ffa29040>]}
[0m19:39:08.729588 [info ] [MainThread]: 
[0m19:39:08.730087 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:39:08.730588 [info ] [MainThread]: 
[0m19:39:08.731369 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:08.732729 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:39:08.786115 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:39:08.786821 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:39:08.787352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:08.798528 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m19:39:08.800183 [debug] [ThreadPool]: On list_postgres: Close
[0m19:39:08.802182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:39:08.807859 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:39:08.808385 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:39:08.808809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:08.819149 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:39:08.819990 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:39:08.820517 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:39:08.825066 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:39:08.826596 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:39:08.827959 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:39:08.832157 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.832655 [debug] [MainThread]: On master: BEGIN
[0m19:39:08.833117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:08.843229 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:39:08.843849 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.844320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:39:08.848519 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:39:08.850140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ffa48bf0>]}
[0m19:39:08.851005 [debug] [MainThread]: On master: ROLLBACK
[0m19:39:08.852955 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.853485 [debug] [MainThread]: On master: BEGIN
[0m19:39:08.855423 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:39:08.855869 [debug] [MainThread]: On master: COMMIT
[0m19:39:08.856341 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.856731 [debug] [MainThread]: On master: COMMIT
[0m19:39:08.857841 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:39:08.858272 [debug] [MainThread]: On master: Close
[0m19:39:08.860995 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:39:08.861686 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:39:08.862348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:39:08.862830 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:39:08.870712 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:39:08.875582 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:39:08.912590 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:39:08.918577 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:08.919329 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:39:08.919778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:08.929134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:39:08.929798 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:08.930344 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:39:08.959676 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.029 seconds
[0m19:39:08.969324 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:08.970191 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:39:08.972353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:39:08.974907 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:08.975508 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:39:08.979067 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:39:08.979860 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:39:08.981515 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:39:08.986298 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:39:08.988432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ffa020c0>]}
[0m19:39:08.989245 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.12s]
[0m19:39:08.990153 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:39:08.990833 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:39:08.992889 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.993393 [debug] [MainThread]: On master: BEGIN
[0m19:39:08.993781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:09.006280 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m19:39:09.006951 [debug] [MainThread]: On master: COMMIT
[0m19:39:09.007456 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:09.007889 [debug] [MainThread]: On master: COMMIT
[0m19:39:09.009103 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:39:09.009518 [debug] [MainThread]: On master: Close
[0m19:39:09.010123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:09.010550 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:39:09.011042 [info ] [MainThread]: 
[0m19:39:09.011525 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m19:39:09.012322 [debug] [MainThread]: Command end result
[0m19:39:09.036682 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:39:09.040893 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:39:09.048432 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:39:09.049023 [info ] [MainThread]: 
[0m19:39:09.049839 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:39:09.050600 [info ] [MainThread]: 
[0m19:39:09.051263 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:39:09.051887 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:39:09.052465 [info ] [MainThread]: 
[0m19:39:09.053043 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:39:09.053468 [info ] [MainThread]: 
[0m19:39:09.053906 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:39:09.055003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0023806, "process_in_blocks": "0", "process_kernel_time": 0.463931, "process_mem_max_rss": "125432", "process_out_blocks": "0", "process_user_time": 2.599613}
[0m19:39:09.055529 [debug] [MainThread]: Command `dbt run` failed at 19:39:09.055428 after 1.00 seconds
[0m19:39:09.056008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8005eede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c800cb4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ffc0cfb0>]}
[0m19:39:09.056487 [debug] [MainThread]: Flushing usage events
[0m19:39:09.691708 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:55.013508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052b517680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052adb5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052ae65670>]}


============================== 19:40:55.061131 | b35e3534-d3f2-465d-949d-6d007714106a ==============================
[0m19:40:55.061131 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:40:55.061959 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'target_path': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'quiet': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False'}
[0m19:40:55.067865 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:40:55.230700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052cc39fd0>]}
[0m19:40:55.284920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052aa54da0>]}
[0m19:40:55.286080 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:40:55.368508 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:40:55.478714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:40:55.479571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:40:55.507771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052a06af60>]}
[0m19:40:55.572562 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:40:55.576831 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:40:55.609386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720529dfade0>]}
[0m19:40:55.610019 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:40:55.610496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052a127050>]}
[0m19:40:55.612482 [info ] [MainThread]: 
[0m19:40:55.613245 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:40:55.613750 [info ] [MainThread]: 
[0m19:40:55.614412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:55.615482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:40:55.664096 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:40:55.664801 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:40:55.665425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:55.675976 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.010 seconds
[0m19:40:55.677560 [debug] [ThreadPool]: On list_postgres: Close
[0m19:40:55.679624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:40:55.685215 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:40:55.685753 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:40:55.686150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:55.696223 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:40:55.696980 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:40:55.697481 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:40:55.701664 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:40:55.703084 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:40:55.704315 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:40:55.708303 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:55.708826 [debug] [MainThread]: On master: BEGIN
[0m19:40:55.709297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:55.720199 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m19:40:55.720810 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:55.721348 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:40:55.725588 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:40:55.726941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7205295be840>]}
[0m19:40:55.727543 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:55.729623 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:55.730334 [debug] [MainThread]: On master: BEGIN
[0m19:40:55.732519 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:40:55.733041 [debug] [MainThread]: On master: COMMIT
[0m19:40:55.733472 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:55.733828 [debug] [MainThread]: On master: COMMIT
[0m19:40:55.734994 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:40:55.735411 [debug] [MainThread]: On master: Close
[0m19:40:55.738054 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:40:55.738738 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:40:55.739336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:40:55.739791 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:40:55.747284 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:40:55.752218 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:40:55.787732 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:40:55.793272 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:40:55.793809 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:40:55.794247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:55.804334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m19:40:55.805004 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:40:55.805582 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:40:55.871026 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.065 seconds
[0m19:40:55.879664 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:40:55.880364 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:40:55.882169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:40:55.884266 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:40:55.884967 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:40:55.887954 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:40:55.888531 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:40:55.889848 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:40:55.893824 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:40:55.895882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720528105e80>]}
[0m19:40:55.896987 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.16s]
[0m19:40:55.897832 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:40:55.898499 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:40:55.900557 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:55.901076 [debug] [MainThread]: On master: BEGIN
[0m19:40:55.901481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:55.910879 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:40:55.911812 [debug] [MainThread]: On master: COMMIT
[0m19:40:55.912545 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:55.913096 [debug] [MainThread]: On master: COMMIT
[0m19:40:55.914872 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:40:55.915428 [debug] [MainThread]: On master: Close
[0m19:40:55.916064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:55.916449 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:40:55.916956 [info ] [MainThread]: 
[0m19:40:55.917482 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m19:40:55.918304 [debug] [MainThread]: Command end result
[0m19:40:55.941516 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:40:55.946417 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:40:55.954360 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:40:55.954902 [info ] [MainThread]: 
[0m19:40:55.955460 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:40:55.955921 [info ] [MainThread]: 
[0m19:40:55.956459 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:40:55.956953 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:40:55.957414 [info ] [MainThread]: 
[0m19:40:55.957947 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:40:55.958382 [info ] [MainThread]: 
[0m19:40:55.958830 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:40:55.960079 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0115949, "process_in_blocks": "0", "process_kernel_time": 0.463195, "process_mem_max_rss": "125416", "process_out_blocks": "0", "process_user_time": 2.502047}
[0m19:40:55.961293 [debug] [MainThread]: Command `dbt run` failed at 19:40:55.961080 after 1.01 seconds
[0m19:40:55.962550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052abd1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052b3f5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052a0c83e0>]}
[0m19:40:55.964317 [debug] [MainThread]: Flushing usage events
[0m19:40:56.761561 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:42:45.552014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db728614f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db728601a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db7291d580>]}


============================== 19:42:45.599451 | 5d9c0dad-c2f4-4ab6-a913-447256cc242e ==============================
[0m19:42:45.599451 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:42:45.600164 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None', 'empty': 'False', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_colors': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs'}
[0m19:42:45.606136 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:42:45.772889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db71c37050>]}
[0m19:42:45.827943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db72871be0>]}
[0m19:42:45.829415 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:42:45.912578 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:42:46.022528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:42:46.023165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:42:46.052272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db71aedd00>]}
[0m19:42:46.119258 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:42:46.123328 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:42:46.157102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db71882d20>]}
[0m19:42:46.157774 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:42:46.158309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db7183b860>]}
[0m19:42:46.160151 [info ] [MainThread]: 
[0m19:42:46.160965 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:42:46.161549 [info ] [MainThread]: 
[0m19:42:46.162288 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:42:46.163794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:42:46.211062 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:42:46.211858 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:42:46.212339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:46.223428 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m19:42:46.225007 [debug] [ThreadPool]: On list_postgres: Close
[0m19:42:46.226617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:42:46.232423 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:42:46.233001 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:42:46.233526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:46.242900 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:42:46.243624 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:42:46.244270 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:42:46.248831 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:42:46.250345 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:42:46.251625 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:42:46.255684 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:46.256181 [debug] [MainThread]: On master: BEGIN
[0m19:42:46.256609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:42:46.267027 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:42:46.267688 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:46.268299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:42:46.273060 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:42:46.274339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db6ff05850>]}
[0m19:42:46.274842 [debug] [MainThread]: On master: ROLLBACK
[0m19:42:46.276063 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:46.276464 [debug] [MainThread]: On master: BEGIN
[0m19:42:46.278857 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:42:46.279578 [debug] [MainThread]: On master: COMMIT
[0m19:42:46.280030 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:46.280414 [debug] [MainThread]: On master: COMMIT
[0m19:42:46.281843 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:42:46.282305 [debug] [MainThread]: On master: Close
[0m19:42:46.284975 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:42:46.285765 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:42:46.286430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:42:46.286905 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:42:46.293962 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:42:46.299733 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:42:46.336405 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:42:46.341400 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:42:46.341928 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:42:46.342326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:46.352154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m19:42:46.352800 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:42:46.353335 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:42:46.383369 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.029 seconds
[0m19:42:46.392208 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:42:46.392770 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:42:46.394833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:42:46.397465 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:42:46.398122 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:42:46.401632 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:42:46.402240 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:42:46.403588 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:42:46.407703 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:42:46.409499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db6fb05cd0>]}
[0m19:42:46.410261 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.12s]
[0m19:42:46.411143 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:42:46.411911 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:42:46.414198 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:46.414700 [debug] [MainThread]: On master: BEGIN
[0m19:42:46.415103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:42:46.424498 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:42:46.425142 [debug] [MainThread]: On master: COMMIT
[0m19:42:46.425682 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:46.426106 [debug] [MainThread]: On master: COMMIT
[0m19:42:46.427540 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:42:46.428249 [debug] [MainThread]: On master: Close
[0m19:42:46.429098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:46.429574 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:42:46.430102 [info ] [MainThread]: 
[0m19:42:46.430590 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m19:42:46.431401 [debug] [MainThread]: Command end result
[0m19:42:46.454435 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:42:46.458509 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:42:46.466516 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:42:46.467059 [info ] [MainThread]: 
[0m19:42:46.467735 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:42:46.468259 [info ] [MainThread]: 
[0m19:42:46.468817 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:42:46.469385 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:42:46.469838 [info ] [MainThread]: 
[0m19:42:46.470340 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:42:46.470773 [info ] [MainThread]: 
[0m19:42:46.471249 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:42:46.472318 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9813851, "process_in_blocks": "0", "process_kernel_time": 0.451478, "process_mem_max_rss": "125188", "process_out_blocks": "0", "process_user_time": 2.457161}
[0m19:42:46.472828 [debug] [MainThread]: Command `dbt run` failed at 19:42:46.472719 after 0.98 seconds
[0m19:42:46.473332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db71f185c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db71b68ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db71b6b200>]}
[0m19:42:46.473799 [debug] [MainThread]: Flushing usage events
[0m19:42:47.312593 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:13.231666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754648703620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546480e0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546483f0920>]}


============================== 19:44:13.275787 | e923b039-74f2-4801-8845-aae84acb1bcf ==============================
[0m19:44:13.275787 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:44:13.276434 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'empty': 'False', 'fail_fast': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt'}
[0m19:44:13.283559 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:44:13.463935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546472d3320>]}
[0m19:44:13.523509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754647312e10>]}
[0m19:44:13.524672 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:44:13.614730 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:44:13.727515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:44:13.728050 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:44:13.755926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754647155a60>]}
[0m19:44:13.818125 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:44:13.822802 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:44:13.855193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754646fe75f0>]}
[0m19:44:13.855933 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:44:13.856488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75464677b800>]}
[0m19:44:13.858122 [info ] [MainThread]: 
[0m19:44:13.858596 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:44:13.859011 [info ] [MainThread]: 
[0m19:44:13.859619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:44:13.860681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:44:13.906797 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:44:13.907424 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:44:13.907846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:13.918292 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.010 seconds
[0m19:44:13.919923 [debug] [ThreadPool]: On list_postgres: Close
[0m19:44:13.921423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:44:13.926473 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:44:13.926922 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:44:13.927316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:13.936223 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:44:13.936808 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:44:13.937235 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:44:13.940792 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m19:44:13.942233 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:44:13.943418 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:44:13.947262 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:13.947721 [debug] [MainThread]: On master: BEGIN
[0m19:44:13.948111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:13.956941 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:44:13.957558 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:13.958067 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:44:13.962157 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:44:13.963461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754645701ac0>]}
[0m19:44:13.964004 [debug] [MainThread]: On master: ROLLBACK
[0m19:44:13.965330 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:13.965769 [debug] [MainThread]: On master: BEGIN
[0m19:44:13.967733 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:44:13.968216 [debug] [MainThread]: On master: COMMIT
[0m19:44:13.968707 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:13.969115 [debug] [MainThread]: On master: COMMIT
[0m19:44:13.970329 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:44:13.970741 [debug] [MainThread]: On master: Close
[0m19:44:13.973268 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:44:13.973970 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:44:13.974548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:44:13.974992 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:44:13.982020 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:44:13.987275 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:44:14.021128 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:44:14.026451 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:44:14.026992 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:44:14.027397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:14.036758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:44:14.037403 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:44:14.037919 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:44:14.066265 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m19:44:14.074912 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:44:14.075425 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:44:14.077127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:44:14.079010 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:44:14.079504 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:44:14.082659 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:44:14.083297 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:44:14.084607 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:44:14.088701 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:44:14.090505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754645713a70>]}
[0m19:44:14.091298 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.11s]
[0m19:44:14.092045 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:44:14.092771 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:44:14.094605 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:14.095037 [debug] [MainThread]: On master: BEGIN
[0m19:44:14.095428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:44:14.104638 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:44:14.105284 [debug] [MainThread]: On master: COMMIT
[0m19:44:14.105764 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:14.106163 [debug] [MainThread]: On master: COMMIT
[0m19:44:14.107409 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:44:14.107858 [debug] [MainThread]: On master: Close
[0m19:44:14.108477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:14.108881 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:44:14.109287 [info ] [MainThread]: 
[0m19:44:14.109762 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m19:44:14.110586 [debug] [MainThread]: Command end result
[0m19:44:14.134359 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:44:14.140173 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:44:14.151112 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:44:14.151791 [info ] [MainThread]: 
[0m19:44:14.152727 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:44:14.153476 [info ] [MainThread]: 
[0m19:44:14.154215 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:44:14.154945 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:44:14.155463 [info ] [MainThread]: 
[0m19:44:14.156065 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:44:14.156539 [info ] [MainThread]: 
[0m19:44:14.157032 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:44:14.158252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9836856, "process_in_blocks": "0", "process_kernel_time": 0.469254, "process_mem_max_rss": "125496", "process_out_blocks": "0", "process_user_time": 2.414455}
[0m19:44:14.158822 [debug] [MainThread]: Command `dbt run` failed at 19:44:14.158716 after 0.98 seconds
[0m19:44:14.159361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754647d3dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546483e4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546457172f0>]}
[0m19:44:14.159901 [debug] [MainThread]: Flushing usage events
[0m19:44:15.010336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:46:00.447509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8ee61940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8ecfc320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8ecfcce0>]}


============================== 19:46:00.490362 | e6e6a48f-4ec7-4106-a918-2eba14c9a009 ==============================
[0m19:46:00.490362 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:46:00.491155 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error': 'None', 'empty': 'False', 'invocation_command': 'dbt run', 'introspect': 'True', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'printer_width': '80', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False'}
[0m19:46:00.496901 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:46:00.650282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8da62540>]}
[0m19:46:00.702902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8db340e0>]}
[0m19:46:00.703876 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:46:00.783578 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:46:00.887684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:46:00.888395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:46:00.915584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8da634d0>]}
[0m19:46:00.977318 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:46:00.981624 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:46:01.013893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8d86aae0>]}
[0m19:46:01.014581 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:46:01.015064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8dc33200>]}
[0m19:46:01.016640 [info ] [MainThread]: 
[0m19:46:01.017133 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:46:01.017637 [info ] [MainThread]: 
[0m19:46:01.018298 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:46:01.019371 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:46:01.066620 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:46:01.067236 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:46:01.067733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:01.078887 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m19:46:01.080497 [debug] [ThreadPool]: On list_postgres: Close
[0m19:46:01.081967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:46:01.087091 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:46:01.087580 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:46:01.088038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:01.098027 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:46:01.098715 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:46:01.099175 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:46:01.103602 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:46:01.104940 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:46:01.106556 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:46:01.111152 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:01.111819 [debug] [MainThread]: On master: BEGIN
[0m19:46:01.112346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:46:01.122606 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:46:01.123226 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:01.123712 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:46:01.128164 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:46:01.129520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8bf7bc80>]}
[0m19:46:01.130157 [debug] [MainThread]: On master: ROLLBACK
[0m19:46:01.131427 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:01.131890 [debug] [MainThread]: On master: BEGIN
[0m19:46:01.133975 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:46:01.134433 [debug] [MainThread]: On master: COMMIT
[0m19:46:01.134850 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:01.135261 [debug] [MainThread]: On master: COMMIT
[0m19:46:01.136520 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:46:01.136960 [debug] [MainThread]: On master: Close
[0m19:46:01.139739 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:46:01.140517 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:46:01.141201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:46:01.141680 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:46:01.149041 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:46:01.154662 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:46:01.192580 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:46:01.198550 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:46:01.199202 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:46:01.199737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:46:01.209776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m19:46:01.210611 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:46:01.211273 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:46:01.241393 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.029 seconds
[0m19:46:01.251390 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:46:01.252067 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:46:01.254023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:46:01.256249 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:46:01.256777 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:46:01.260346 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:46:01.260975 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:46:01.262386 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:46:01.266356 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:46:01.268152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8bf24380>]}
[0m19:46:01.268948 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.13s]
[0m19:46:01.269782 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:46:01.270453 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:46:01.272475 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:01.272908 [debug] [MainThread]: On master: BEGIN
[0m19:46:01.273296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:46:01.282618 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:46:01.283264 [debug] [MainThread]: On master: COMMIT
[0m19:46:01.283784 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:01.284254 [debug] [MainThread]: On master: COMMIT
[0m19:46:01.285439 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:46:01.285887 [debug] [MainThread]: On master: Close
[0m19:46:01.286478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:01.286961 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:46:01.287467 [info ] [MainThread]: 
[0m19:46:01.288013 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m19:46:01.288937 [debug] [MainThread]: Command end result
[0m19:46:01.311864 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:46:01.316224 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:46:01.324103 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:46:01.324676 [info ] [MainThread]: 
[0m19:46:01.325241 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:46:01.325695 [info ] [MainThread]: 
[0m19:46:01.326253 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:46:01.326784 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:46:01.327244 [info ] [MainThread]: 
[0m19:46:01.327825 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:46:01.328307 [info ] [MainThread]: 
[0m19:46:01.328788 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:46:01.329968 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.94080716, "process_in_blocks": "0", "process_kernel_time": 0.418693, "process_mem_max_rss": "125784", "process_out_blocks": "0", "process_user_time": 2.436394}
[0m19:46:01.330500 [debug] [MainThread]: Command `dbt run` failed at 19:46:01.330400 after 0.94 seconds
[0m19:46:01.331024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8dda52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8db51100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8dc1f050>]}
[0m19:46:01.331506 [debug] [MainThread]: Flushing usage events
[0m19:46:02.185348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:50.597245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367322a0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736730060a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672fda2780>]}


============================== 19:47:50.646488 | edd88da0-9a31-414f-8123-779b15990977 ==============================
[0m19:47:50.646488 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:47:50.647256 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'invocation_command': 'dbt run', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None'}
[0m19:47:50.653456 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:47:50.827345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736731ffdd00>]}
[0m19:47:50.882720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672f4836e0>]}
[0m19:47:50.883840 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:47:50.969348 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:47:51.086670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:47:51.087391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:47:51.117643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672f4358e0>]}
[0m19:47:51.188919 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:47:51.193929 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:47:51.229708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672f195640>]}
[0m19:47:51.230420 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:47:51.230931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672e5e5eb0>]}
[0m19:47:51.232787 [info ] [MainThread]: 
[0m19:47:51.233366 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:47:51.233892 [info ] [MainThread]: 
[0m19:47:51.234608 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:47:51.235909 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:47:51.293033 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:47:51.293810 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:47:51.294424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:51.306258 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m19:47:51.307871 [debug] [ThreadPool]: On list_postgres: Close
[0m19:47:51.309558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:47:51.315479 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:47:51.316237 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:47:51.316838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:51.327160 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:47:51.327874 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:47:51.328400 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:47:51.332945 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:47:51.334682 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:47:51.336028 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:47:51.340333 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:51.340863 [debug] [MainThread]: On master: BEGIN
[0m19:47:51.341273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:51.351000 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:47:51.351773 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:51.352397 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:47:51.357051 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:47:51.358492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672e581910>]}
[0m19:47:51.359081 [debug] [MainThread]: On master: ROLLBACK
[0m19:47:51.360847 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:51.361581 [debug] [MainThread]: On master: BEGIN
[0m19:47:51.364216 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:47:51.364808 [debug] [MainThread]: On master: COMMIT
[0m19:47:51.365291 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:51.365760 [debug] [MainThread]: On master: COMMIT
[0m19:47:51.366962 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:47:51.367392 [debug] [MainThread]: On master: Close
[0m19:47:51.370217 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:47:51.370969 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:47:51.371619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:47:51.372158 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:47:51.379967 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:47:51.385377 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:47:51.422504 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:47:51.428036 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:47:51.428663 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:47:51.429195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:51.439290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m19:47:51.440047 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:47:51.440643 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:47:51.472559 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.031 seconds
[0m19:47:51.483364 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:47:51.484137 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:47:51.486305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:47:51.488814 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:47:51.489433 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:47:51.492901 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:47:51.493596 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:47:51.495137 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:47:51.499434 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:47:51.501299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672f153fe0>]}
[0m19:47:51.502181 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.13s]
[0m19:47:51.503014 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:47:51.503718 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:47:51.505785 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:51.506214 [debug] [MainThread]: On master: BEGIN
[0m19:47:51.506610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:51.516560 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:47:51.517370 [debug] [MainThread]: On master: COMMIT
[0m19:47:51.517917 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:51.518393 [debug] [MainThread]: On master: COMMIT
[0m19:47:51.519771 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:47:51.520236 [debug] [MainThread]: On master: Close
[0m19:47:51.520899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:51.521329 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:47:51.521819 [info ] [MainThread]: 
[0m19:47:51.522296 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m19:47:51.523044 [debug] [MainThread]: Command end result
[0m19:47:51.547755 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:47:51.551975 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:47:51.562431 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:47:51.563118 [info ] [MainThread]: 
[0m19:47:51.563949 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:47:51.564535 [info ] [MainThread]: 
[0m19:47:51.565093 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:47:51.565666 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:47:51.566103 [info ] [MainThread]: 
[0m19:47:51.566626 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:47:51.567070 [info ] [MainThread]: 
[0m19:47:51.567575 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:47:51.568787 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0339226, "process_in_blocks": "0", "process_kernel_time": 0.411693, "process_mem_max_rss": "125268", "process_out_blocks": "0", "process_user_time": 2.47016}
[0m19:47:51.569337 [debug] [MainThread]: Command `dbt run` failed at 19:47:51.569216 after 1.03 seconds
[0m19:47:51.569866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736732317260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672f810c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367308f35c0>]}
[0m19:47:51.570413 [debug] [MainThread]: Flushing usage events
[0m19:47:52.411410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:49:18.438223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bbac2ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bee26b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bbae2f30>]}


============================== 19:49:18.483453 | f5c05b5b-f3a7-4a0d-a785-f298192f5f20 ==============================
[0m19:49:18.483453 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:49:18.484325 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'debug': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'use_colors': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'target_path': 'None', 'write_json': 'True', 'invocation_command': 'dbt run'}
[0m19:49:18.490377 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:49:18.648895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bdcb2150>]}
[0m19:49:18.701157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0baffc0e0>]}
[0m19:49:18.702207 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:49:18.782801 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:49:18.886719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:49:18.887361 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:49:18.914596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bb2357f0>]}
[0m19:49:18.977719 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:49:18.981864 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:49:19.014583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bae6b4d0>]}
[0m19:49:19.015220 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:49:19.015695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bb31a360>]}
[0m19:49:19.017282 [info ] [MainThread]: 
[0m19:49:19.017824 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:49:19.018362 [info ] [MainThread]: 
[0m19:49:19.019082 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:49:19.020245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:49:19.069013 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:49:19.069613 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:49:19.070054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:19.080974 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m19:49:19.082559 [debug] [ThreadPool]: On list_postgres: Close
[0m19:49:19.084071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:49:19.089494 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:49:19.089983 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:49:19.090398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:19.100260 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:49:19.100886 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:49:19.101399 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:49:19.105481 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:49:19.106829 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:49:19.108143 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:49:19.111894 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:19.112394 [debug] [MainThread]: On master: BEGIN
[0m19:49:19.112878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:19.122607 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:49:19.123246 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:19.123751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:49:19.128055 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:49:19.129352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bd0fe090>]}
[0m19:49:19.129888 [debug] [MainThread]: On master: ROLLBACK
[0m19:49:19.131072 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:19.131493 [debug] [MainThread]: On master: BEGIN
[0m19:49:19.133448 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:49:19.133863 [debug] [MainThread]: On master: COMMIT
[0m19:49:19.134295 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:19.134700 [debug] [MainThread]: On master: COMMIT
[0m19:49:19.135875 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:49:19.136298 [debug] [MainThread]: On master: Close
[0m19:49:19.138975 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:49:19.139714 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:49:19.140403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:49:19.140940 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:49:19.148521 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:49:19.153261 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:49:19.187708 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:49:19.193971 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:49:19.194519 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:49:19.195016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:19.204625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:49:19.205281 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:49:19.205786 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:49:19.249643 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.043 seconds
[0m19:49:19.258926 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:49:19.259468 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:49:19.261173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:49:19.263137 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:49:19.263628 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:49:19.266846 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:49:19.267511 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:49:19.268963 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:49:19.272998 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:49:19.274704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0b9524530>]}
[0m19:49:19.275476 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.13s]
[0m19:49:19.276341 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:49:19.277008 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:49:19.278896 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:19.279327 [debug] [MainThread]: On master: BEGIN
[0m19:49:19.279673 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:49:19.288944 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:49:19.289536 [debug] [MainThread]: On master: COMMIT
[0m19:49:19.289994 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:19.290360 [debug] [MainThread]: On master: COMMIT
[0m19:49:19.291538 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:49:19.291977 [debug] [MainThread]: On master: Close
[0m19:49:19.292583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:19.292981 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:49:19.293398 [info ] [MainThread]: 
[0m19:49:19.293869 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m19:49:19.294683 [debug] [MainThread]: Command end result
[0m19:49:19.316926 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:49:19.321031 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:49:19.328657 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:49:19.329318 [info ] [MainThread]: 
[0m19:49:19.330022 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:49:19.330540 [info ] [MainThread]: 
[0m19:49:19.331118 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:49:19.331621 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:49:19.332078 [info ] [MainThread]: 
[0m19:49:19.332560 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:49:19.332993 [info ] [MainThread]: 
[0m19:49:19.333455 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:49:19.334516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9555712, "process_in_blocks": "0", "process_kernel_time": 0.373051, "process_mem_max_rss": "125400", "process_out_blocks": "0", "process_user_time": 2.434862}
[0m19:49:19.335064 [debug] [MainThread]: Command `dbt run` failed at 19:49:19.334928 after 0.96 seconds
[0m19:49:19.335558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bf8faf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bb06c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bb0bff80>]}
[0m19:49:19.335982 [debug] [MainThread]: Flushing usage events
[0m19:49:20.334383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:06.046738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7a97f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a79bbc4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7a06a840>]}


============================== 19:51:06.091098 | 7c1b8844-8e79-4dc1-8045-d2458a7c5b2d ==============================
[0m19:51:06.091098 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:51:06.091892 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'debug': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'quiet': 'False', 'use_colors': 'True', 'introspect': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'target_path': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt run'}
[0m19:51:06.097856 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:51:06.262100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a79fbe450>]}
[0m19:51:06.316712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7a97d760>]}
[0m19:51:06.317813 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:51:06.401074 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:51:06.507578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:06.508094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:06.534993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7937a5d0>]}
[0m19:51:06.597973 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:51:06.602285 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:51:06.634131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7919f710>]}
[0m19:51:06.634782 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:51:06.635275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a79379970>]}
[0m19:51:06.636836 [info ] [MainThread]: 
[0m19:51:06.637302 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:51:06.637800 [info ] [MainThread]: 
[0m19:51:06.638413 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:51:06.639527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:51:06.686555 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:51:06.687211 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:51:06.687829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:06.698965 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m19:51:06.700581 [debug] [ThreadPool]: On list_postgres: Close
[0m19:51:06.702023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:51:06.707184 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:51:06.707665 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:51:06.708092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:06.717771 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:51:06.718374 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:51:06.718827 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:51:06.723411 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:51:06.724817 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:51:06.726076 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:51:06.730053 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:06.730505 [debug] [MainThread]: On master: BEGIN
[0m19:51:06.730939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:06.740452 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:51:06.741052 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:06.741563 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:51:06.746439 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:51:06.747799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a77901460>]}
[0m19:51:06.748325 [debug] [MainThread]: On master: ROLLBACK
[0m19:51:06.749492 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:06.749899 [debug] [MainThread]: On master: BEGIN
[0m19:51:06.751918 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:51:06.752350 [debug] [MainThread]: On master: COMMIT
[0m19:51:06.752750 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:06.753120 [debug] [MainThread]: On master: COMMIT
[0m19:51:06.754213 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:51:06.754651 [debug] [MainThread]: On master: Close
[0m19:51:06.757301 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:51:06.757966 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:51:06.758583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:51:06.759064 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:51:06.765919 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:51:06.771200 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:51:06.805069 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:51:06.810577 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:51:06.811087 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:51:06.811560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:06.821053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:51:06.821724 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:51:06.822234 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:51:06.852912 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.030 seconds
[0m19:51:06.861583 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:51:06.862124 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:51:06.863831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:51:06.865669 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:51:06.866134 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:51:06.869279 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:51:06.869999 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:51:06.871428 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:51:06.875295 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:51:06.877015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a77539fa0>]}
[0m19:51:06.877720 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.12s]
[0m19:51:06.878498 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:51:06.879203 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:51:06.881108 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:06.881507 [debug] [MainThread]: On master: BEGIN
[0m19:51:06.881860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:06.890911 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:51:06.891509 [debug] [MainThread]: On master: COMMIT
[0m19:51:06.891913 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:06.892263 [debug] [MainThread]: On master: COMMIT
[0m19:51:06.893400 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:51:06.893811 [debug] [MainThread]: On master: Close
[0m19:51:06.894364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:06.894785 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:51:06.895205 [info ] [MainThread]: 
[0m19:51:06.895700 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m19:51:06.896456 [debug] [MainThread]: Command end result
[0m19:51:06.918775 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:51:06.923074 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:51:06.930742 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:51:06.931269 [info ] [MainThread]: 
[0m19:51:06.931821 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:51:06.932271 [info ] [MainThread]: 
[0m19:51:06.932791 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:51:06.933298 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:51:06.933750 [info ] [MainThread]: 
[0m19:51:06.934275 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:51:06.934704 [info ] [MainThread]: 
[0m19:51:06.935219 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:51:06.936365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9464002, "process_in_blocks": "0", "process_kernel_time": 0.382956, "process_mem_max_rss": "125172", "process_out_blocks": "0", "process_user_time": 2.393477}
[0m19:51:06.936881 [debug] [MainThread]: Command `dbt run` failed at 19:51:06.936769 after 0.95 seconds
[0m19:51:06.937380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7a091280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7a64c4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7a64c9b0>]}
[0m19:51:06.937888 [debug] [MainThread]: Flushing usage events
[0m19:51:07.740648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:52:55.470477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6d9cb830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6e6d21b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6d7319d0>]}


============================== 19:52:55.513954 | d9c3bc4b-6792-4f8d-a9c5-91d408215bbd ==============================
[0m19:52:55.513954 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:52:55.514748 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'quiet': 'False', 'invocation_command': 'dbt run', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'False', 'introspect': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'use_colors': 'True', 'debug': 'False'}
[0m19:52:55.520645 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:52:55.675906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6c526900>]}
[0m19:52:55.727868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6d346e70>]}
[0m19:52:55.728990 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:52:55.809564 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:52:55.912557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:52:55.913192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:52:55.940576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6c40f320>]}
[0m19:52:56.002974 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:52:56.007319 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:52:56.038762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6c2ab050>]}
[0m19:52:56.039353 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:52:56.039913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6c3f0380>]}
[0m19:52:56.041477 [info ] [MainThread]: 
[0m19:52:56.041970 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:52:56.042386 [info ] [MainThread]: 
[0m19:52:56.043016 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:52:56.044114 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:52:56.091272 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:52:56.091958 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:52:56.092441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:56.102953 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.010 seconds
[0m19:52:56.104456 [debug] [ThreadPool]: On list_postgres: Close
[0m19:52:56.105745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:52:56.111111 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:52:56.111665 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:52:56.112112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:56.121285 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:52:56.121954 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:52:56.122398 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:52:56.126168 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m19:52:56.127499 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:52:56.128609 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:52:56.132427 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:56.132903 [debug] [MainThread]: On master: BEGIN
[0m19:52:56.133278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:52:56.142055 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:52:56.142687 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:56.143147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:52:56.147472 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:52:56.148829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6c3c6b40>]}
[0m19:52:56.149336 [debug] [MainThread]: On master: ROLLBACK
[0m19:52:56.150644 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:56.151087 [debug] [MainThread]: On master: BEGIN
[0m19:52:56.153050 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:52:56.153598 [debug] [MainThread]: On master: COMMIT
[0m19:52:56.154127 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:56.154534 [debug] [MainThread]: On master: COMMIT
[0m19:52:56.155906 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:52:56.156357 [debug] [MainThread]: On master: Close
[0m19:52:56.158827 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:52:56.159453 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:52:56.160073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:52:56.160567 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:52:56.167608 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:52:56.173079 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:52:56.206789 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:52:56.211766 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:52:56.212268 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:52:56.212678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:56.222057 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:52:56.222690 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:52:56.223174 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:52:56.251944 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m19:52:56.260726 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:52:56.261308 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:52:56.262857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:56.264734 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:52:56.265211 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:52:56.268201 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:52:56.268777 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:52:56.270164 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:52:56.274087 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:52:56.275817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6a9454c0>]}
[0m19:52:56.276515 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.11s]
[0m19:52:56.277195 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:52:56.277930 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:52:56.279764 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:56.280187 [debug] [MainThread]: On master: BEGIN
[0m19:52:56.280572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:52:56.289434 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:52:56.290039 [debug] [MainThread]: On master: COMMIT
[0m19:52:56.290482 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:56.290832 [debug] [MainThread]: On master: COMMIT
[0m19:52:56.292070 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:52:56.292460 [debug] [MainThread]: On master: Close
[0m19:52:56.293043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:56.293413 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:52:56.293842 [info ] [MainThread]: 
[0m19:52:56.294333 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m19:52:56.295078 [debug] [MainThread]: Command end result
[0m19:52:56.316778 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:52:56.320856 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:52:56.328304 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:52:56.328814 [info ] [MainThread]: 
[0m19:52:56.329335 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:52:56.329813 [info ] [MainThread]: 
[0m19:52:56.330424 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:52:56.330920 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:52:56.331358 [info ] [MainThread]: 
[0m19:52:56.331845 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:52:56.332266 [info ] [MainThread]: 
[0m19:52:56.332716 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:52:56.333766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.92035383, "process_in_blocks": "0", "process_kernel_time": 0.405948, "process_mem_max_rss": "125712", "process_out_blocks": "0", "process_user_time": 2.347265}
[0m19:52:56.334312 [debug] [MainThread]: Command `dbt run` failed at 19:52:56.334216 after 0.92 seconds
[0m19:52:56.334766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6d438980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6da82a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6a94ae70>]}
[0m19:52:56.335226 [debug] [MainThread]: Flushing usage events
[0m19:52:57.132683 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:25.320203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d581a733080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5819986570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5819984a70>]}


============================== 20:54:25.361147 | edef70bc-74a3-4194-97c0-eb6f3b8309ba ==============================
[0m20:54:25.361147 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:54:25.361759 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error': 'None', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'invocation_command': 'dbt run', 'introspect': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'version_check': 'True', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'partial_parse': 'True'}
[0m20:54:25.367488 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m20:54:25.647672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58192b7230>]}
[0m20:54:25.704905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d581bc8e8d0>]}
[0m20:54:25.706439 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:54:25.794383 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:54:26.002415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:54:26.003305 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/fires_raw.sql
[0m20:54:26.250287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5817fa9970>]}
[0m20:54:26.315755 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m20:54:26.320690 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m20:54:26.368348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58183fc620>]}
[0m20:54:26.369130 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m20:54:26.369783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5818347410>]}
[0m20:54:26.371619 [info ] [MainThread]: 
[0m20:54:26.372206 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m20:54:26.372677 [info ] [MainThread]: 
[0m20:54:26.373316 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:54:26.374444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:54:26.433898 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:54:26.434941 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:54:26.435567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:26.449083 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m20:54:26.450793 [debug] [ThreadPool]: On list_postgres: Close
[0m20:54:26.452483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m20:54:26.458330 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m20:54:26.458885 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m20:54:26.459298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:26.469242 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:54:26.470098 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m20:54:26.470646 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m20:54:26.475780 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m20:54:26.477176 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m20:54:26.478564 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m20:54:26.482987 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:26.483548 [debug] [MainThread]: On master: BEGIN
[0m20:54:26.483962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:26.493534 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:54:26.494164 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:26.494718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:54:26.500625 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m20:54:26.502228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5816f04f20>]}
[0m20:54:26.503303 [debug] [MainThread]: On master: ROLLBACK
[0m20:54:26.505030 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:26.505513 [debug] [MainThread]: On master: BEGIN
[0m20:54:26.507427 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:54:26.507894 [debug] [MainThread]: On master: COMMIT
[0m20:54:26.508331 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:26.508733 [debug] [MainThread]: On master: COMMIT
[0m20:54:26.509885 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:54:26.510300 [debug] [MainThread]: On master: Close
[0m20:54:26.514179 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m20:54:26.514855 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m20:54:26.515438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m20:54:26.515869 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m20:54:26.523544 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m20:54:26.528765 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m20:54:26.564102 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m20:54:26.569277 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m20:54:26.570211 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m20:54:26.570746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:26.580489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:54:26.581172 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m20:54:26.581705 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m20:54:26.664412 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.082 seconds
[0m20:54:26.673497 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m20:54:26.674156 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m20:54:26.676749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:54:26.678781 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m20:54:26.679274 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m20:54:26.772339 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.092 seconds
[0m20:54:26.785454 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m20:54:26.786220 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m20:54:26.786829 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m20:54:26.971473 [debug] [Thread-1 (]: SQL status: COMMIT in 0.184 seconds
[0m20:54:26.977225 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m20:54:26.982107 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m20:54:26.982596 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m20:54:26.984187 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:54:26.986480 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m20:54:26.989014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5816fba000>]}
[0m20:54:26.989823 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.47s]
[0m20:54:26.990478 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m20:54:26.991938 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:26.992375 [debug] [MainThread]: On master: BEGIN
[0m20:54:26.992762 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:27.001182 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:54:27.001767 [debug] [MainThread]: On master: COMMIT
[0m20:54:27.002182 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:27.002537 [debug] [MainThread]: On master: COMMIT
[0m20:54:27.004289 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:54:27.004859 [debug] [MainThread]: On master: Close
[0m20:54:27.005411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:27.005811 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m20:54:27.006310 [info ] [MainThread]: 
[0m20:54:27.006773 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m20:54:27.007572 [debug] [MainThread]: Command end result
[0m20:54:27.031060 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m20:54:27.035509 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m20:54:27.043749 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m20:54:27.044287 [info ] [MainThread]: 
[0m20:54:27.044834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:54:27.045284 [info ] [MainThread]: 
[0m20:54:27.045756 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:54:27.047187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7855008, "process_in_blocks": "65656", "process_kernel_time": 0.466441, "process_mem_max_rss": "128400", "process_out_blocks": "0", "process_user_time": 2.83886}
[0m20:54:27.047756 [debug] [MainThread]: Command `dbt run` succeeded at 20:54:27.047663 after 1.79 seconds
[0m20:54:27.048218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d581a421d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58187583e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58187c95e0>]}
[0m20:54:27.048687 [debug] [MainThread]: Flushing usage events
[0m20:54:27.928662 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:25.619693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e12f7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e32e99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e12f6d20>]}


============================== 21:02:25.664303 | 8a69ccf1-7b85-4f7f-989f-45fdf085205d ==============================
[0m21:02:25.664303 [info ] [MainThread]: Running with dbt=1.10.11
[0m21:02:25.665033 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'printer_width': '80', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'version_check': 'True', 'static_parser': 'True', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'debug': 'False'}
[0m21:02:25.671032 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m21:02:26.754601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e0b6b230>]}
[0m21:02:26.806623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e04c2b10>]}
[0m21:02:26.820861 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:02:26.976360 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m21:02:27.348433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:02:27.349052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:02:27.376553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e0339790>]}
[0m21:02:27.440740 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m21:02:27.445422 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m21:02:27.491542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e01d8ec0>]}
[0m21:02:27.492181 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m21:02:27.492682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e03617c0>]}
[0m21:02:27.494287 [info ] [MainThread]: 
[0m21:02:27.494780 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m21:02:27.495223 [info ] [MainThread]: 
[0m21:02:27.495861 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:02:27.497127 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:02:27.556845 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:02:27.557453 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:02:27.557860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:27.570167 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m21:02:27.571813 [debug] [ThreadPool]: On list_postgres: Close
[0m21:02:27.573458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m21:02:27.578730 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m21:02:27.579317 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m21:02:27.579745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:27.588804 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m21:02:27.589414 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m21:02:27.589877 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:02:27.594712 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m21:02:27.596234 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m21:02:27.597441 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m21:02:27.601464 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.601930 [debug] [MainThread]: On master: BEGIN
[0m21:02:27.602329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:27.611866 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m21:02:27.612519 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.613010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:02:27.618003 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m21:02:27.619327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0df56f260>]}
[0m21:02:27.619888 [debug] [MainThread]: On master: ROLLBACK
[0m21:02:27.621231 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.621719 [debug] [MainThread]: On master: BEGIN
[0m21:02:27.624030 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:02:27.624542 [debug] [MainThread]: On master: COMMIT
[0m21:02:27.624986 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.625477 [debug] [MainThread]: On master: COMMIT
[0m21:02:27.626808 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:02:27.627283 [debug] [MainThread]: On master: Close
[0m21:02:27.631238 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m21:02:27.631932 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m21:02:27.632512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m21:02:27.632992 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m21:02:27.640257 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m21:02:27.645619 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m21:02:27.680886 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m21:02:27.686366 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:27.686880 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m21:02:27.687330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:27.696804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m21:02:27.697446 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:27.697930 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m21:02:27.860929 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.162 seconds
[0m21:02:27.869300 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:27.869778 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m21:02:27.871581 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:02:27.874648 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:27.875181 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m21:02:27.877060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:02:27.879153 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:27.879678 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m21:02:27.910115 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.030 seconds
[0m21:02:27.924100 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m21:02:27.924780 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:27.925279 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m21:02:28.700364 [debug] [Thread-1 (]: SQL status: COMMIT in 0.774 seconds
[0m21:02:28.706464 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m21:02:28.711703 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:28.712192 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m21:02:28.716167 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m21:02:28.718673 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m21:02:28.848549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e2fdf9b0>]}
[0m21:02:28.849590 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 1.09s]
[0m21:02:28.850365 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m21:02:28.851913 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:28.852310 [debug] [MainThread]: On master: BEGIN
[0m21:02:28.852675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:02:28.862604 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m21:02:28.863246 [debug] [MainThread]: On master: COMMIT
[0m21:02:28.863705 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:28.864128 [debug] [MainThread]: On master: COMMIT
[0m21:02:28.865284 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:02:28.865676 [debug] [MainThread]: On master: Close
[0m21:02:28.866246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:28.866633 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m21:02:28.867044 [info ] [MainThread]: 
[0m21:02:28.867569 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m21:02:28.868388 [debug] [MainThread]: Command end result
[0m21:02:28.892229 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m21:02:28.896135 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m21:02:28.903392 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m21:02:28.903895 [info ] [MainThread]: 
[0m21:02:28.904414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:28.904868 [info ] [MainThread]: 
[0m21:02:28.905335 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:02:28.907011 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4980469, "process_in_blocks": "65288", "process_kernel_time": 0.567091, "process_mem_max_rss": "124764", "process_out_blocks": "0", "process_user_time": 2.684761}
[0m21:02:28.907728 [debug] [MainThread]: Command `dbt run` succeeded at 21:02:28.907615 after 3.50 seconds
[0m21:02:28.908196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e32e44a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0df995bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e075b380>]}
[0m21:02:28.908661 [debug] [MainThread]: Flushing usage events
[0m21:02:29.658031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:51:15.292268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc31645a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc314044a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc31460f80>]}


============================== 23:51:15.340846 | f1f7a042-af6e-4243-87d2-7bb39633ae8d ==============================
[0m23:51:15.340846 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:51:15.341770 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'quiet': 'False', 'debug': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'warn_error': 'None', 'use_colors': 'True', 'log_format': 'default', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --debug', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'empty': 'False'}
[0m23:51:15.348607 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m23:51:15.659809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1f7a042-af6e-4243-87d2-7bb39633ae8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc30f65730>]}
[0m23:51:15.715880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1f7a042-af6e-4243-87d2-7bb39633ae8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc30caf920>]}
[0m23:51:15.717688 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:51:15.804372 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:51:15.880402 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:51:15.881118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f1f7a042-af6e-4243-87d2-7bb39633ae8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc3091acf0>]}
[0m23:51:16.738008 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fires_clean".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fires_clean").
  
  To fix this, change the name of one of these resources:
  - model.fires_dbt.fires_clean (models/silver/fires_clean.sql)
  - model.fires_dbt.fires_clean (models/silver/fires_clean.sql)
[0m23:51:16.740203 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5101727, "process_in_blocks": "63472", "process_kernel_time": 0.544834, "process_mem_max_rss": "122696", "process_out_blocks": "0", "process_user_time": 3.269007}
[0m23:51:16.740980 [debug] [MainThread]: Command `dbt run` failed at 23:51:16.740869 after 1.51 seconds
[0m23:51:16.741692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc31343050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc30b530e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc30d98c80>]}
[0m23:51:16.742335 [debug] [MainThread]: Flushing usage events
[0m23:51:17.561688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:52:50.965057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70720fafbb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70720efa71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707211780320>]}


============================== 23:52:51.006839 | 5f508222-13cb-48c4-be8e-ac7530d5ee0f ==============================
[0m23:52:51.006839 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:52:51.007515 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'quiet': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --debug', 'no_print': 'None', 'use_colors': 'True', 'empty': 'False', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'True', 'cache_selected_only': 'False'}
[0m23:52:51.014087 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m23:52:51.308750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f508222-13cb-48c4-be8e-ac7530d5ee0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70720e746de0>]}
[0m23:52:51.366683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f508222-13cb-48c4-be8e-ac7530d5ee0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7072111d5ee0>]}
[0m23:52:51.368445 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:52:51.459851 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:52:51.541256 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:52:51.541983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f508222-13cb-48c4-be8e-ac7530d5ee0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70720f15e240>]}
[0m23:52:52.377020 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fires_clean".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fires_clean").
  
  To fix this, change the name of one of these resources:
  - model.fires_dbt.fires_clean (models/silver/fires_clean.sql)
  - model.fires_dbt.fires_clean (models/silver/fires_clean.sql)
[0m23:52:52.378929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4740182, "process_in_blocks": "63208", "process_kernel_time": 0.433609, "process_mem_max_rss": "122904", "process_out_blocks": "0", "process_user_time": 3.031215}
[0m23:52:52.379649 [debug] [MainThread]: Command `dbt run` failed at 23:52:52.379544 after 1.47 seconds
[0m23:52:52.380211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70720ef75790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70720d77cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70720e4d1520>]}
[0m23:52:52.380789 [debug] [MainThread]: Flushing usage events
[0m23:52:53.209477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:56:36.047864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e0f0801730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e0f0c29940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e0f288c680>]}


============================== 23:56:36.097162 | 0bf0d929-beea-482c-b170-8d19bd018585 ==============================
[0m23:56:36.097162 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:56:36.098017 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'write_json': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'invocation_command': 'dbt run --debug', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'debug': 'True', 'static_parser': 'True'}
[0m23:56:36.104887 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m23:56:36.419349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bf0d929-beea-482c-b170-8d19bd018585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e0ef92e750>]}
[0m23:56:36.481245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bf0d929-beea-482c-b170-8d19bd018585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e0f020d6a0>]}
[0m23:56:36.483557 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:56:36.596521 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:56:36.682011 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:56:36.682854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0bf0d929-beea-482c-b170-8d19bd018585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e0f0559ee0>]}
[0m23:56:38.161157 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fires_cleaned".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fires_cleaned").
  
  To fix this, change the name of one of these resources:
  - model.fires_dbt.fires_cleaned (models/silver/fires_cleaned.sql)
  - model.fires_dbt.fires_cleaned (models/silver/fires_cleaned.sql)
[0m23:56:38.163147 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1781878, "process_in_blocks": "21584", "process_kernel_time": 0.451041, "process_mem_max_rss": "123120", "process_out_blocks": "0", "process_user_time": 3.047577}
[0m23:56:38.163842 [debug] [MainThread]: Command `dbt run` failed at 23:56:38.163728 after 2.18 seconds
[0m23:56:38.164398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e0f0d8f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e0efa4d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71e0f04eeab0>]}
[0m23:56:38.164977 [debug] [MainThread]: Flushing usage events
[0m23:56:40.097574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:58:10.289040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2224e979e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2224d2ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2224f031a0>]}


============================== 23:58:10.337405 | e30a4523-9f8d-44ef-9ae3-f01dbb868dc5 ==============================
[0m23:58:10.337405 [info ] [MainThread]: Running with dbt=1.10.11
[0m23:58:10.338203 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'partial_parse': 'True', 'quiet': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'invocation_command': 'dbt run --debug', 'log_cache_events': 'False', 'debug': 'True', 'empty': 'False', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'indirect_selection': 'eager', 'fail_fast': 'False', 'no_print': 'None', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_colors': 'True'}
[0m23:58:10.344817 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m23:58:10.640315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e30a4523-9f8d-44ef-9ae3-f01dbb868dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2224301dc0>]}
[0m23:58:10.698478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e30a4523-9f8d-44ef-9ae3-f01dbb868dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2224621b20>]}
[0m23:58:10.700326 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:58:10.789318 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m23:58:10.792159 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:58:10.792695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e30a4523-9f8d-44ef-9ae3-f01dbb868dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22242536b0>]}
[0m23:58:11.699941 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fires_cleaned".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fires_cleaned").
  
  To fix this, change the name of one of these resources:
  - model.fires_dbt.fires_cleaned (models/silver/fires_cleaned.sql)
  - model.fires_dbt.fires_cleaned (models/silver/fires_cleaned.sql)
[0m23:58:11.701880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4733608, "process_in_blocks": "63088", "process_kernel_time": 0.391276, "process_mem_max_rss": "123064", "process_out_blocks": "0", "process_user_time": 3.109395}
[0m23:58:11.702628 [debug] [MainThread]: Command `dbt run` failed at 23:58:11.702506 after 1.47 seconds
[0m23:58:11.703308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2225137d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2224250410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2226344800>]}
[0m23:58:11.704159 [debug] [MainThread]: Flushing usage events
[0m23:58:12.549252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:16:38.015055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36f56b5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36f7964410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36f4d7c380>]}


============================== 00:16:38.063026 | 41e61b27-fec1-4314-bcca-f18cf9583881 ==============================
[0m00:16:38.063026 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:16:38.063778 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'invocation_command': 'dbt run', 'no_print': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'debug': 'False', 'log_format': 'default', 'empty': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'fail_fast': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'static_parser': 'True', 'use_colors': 'True', 'printer_width': '80'}
[0m00:16:38.070072 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:16:38.357328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41e61b27-fec1-4314-bcca-f18cf9583881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36f4b4aa20>]}
[0m00:16:38.414052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41e61b27-fec1-4314-bcca-f18cf9583881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36f55920f0>]}
[0m00:16:38.415679 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:16:38.503534 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:16:38.506049 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:16:38.506571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '41e61b27-fec1-4314-bcca-f18cf9583881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36f49e5340>]}
[0m00:16:39.382049 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fires_daily".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fires_daily").
  
  To fix this, change the name of one of these resources:
  - model.fires_dbt.fires_daily (models/silver/fires_daily.sql)
  - model.fires_dbt.fires_daily (models/silver/fires_daily.sql)
[0m00:16:39.383959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4303504, "process_in_blocks": "63024", "process_kernel_time": 0.413559, "process_mem_max_rss": "122976", "process_out_blocks": "0", "process_user_time": 3.138189}
[0m00:16:39.384577 [debug] [MainThread]: Command `dbt run` failed at 00:16:39.384480 after 1.43 seconds
[0m00:16:39.385042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36f5466930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36f4822bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e36f583c530>]}
[0m00:16:39.385519 [debug] [MainThread]: Flushing usage events
[0m00:16:40.192288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:17:00.017677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f8d4629ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f8d3cbe120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f8d6435ee0>]}


============================== 00:17:00.069852 | a514b461-5b1a-4de6-ae2d-6a633bbcffb3 ==============================
[0m00:17:00.069852 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:17:00.070691 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'empty': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'warn_error': 'None', 'fail_fast': 'False'}
[0m00:17:00.076878 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:17:00.242689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a514b461-5b1a-4de6-ae2d-6a633bbcffb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f8d35719d0>]}
[0m00:17:00.298195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a514b461-5b1a-4de6-ae2d-6a633bbcffb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f8d3506930>]}
[0m00:17:00.299346 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:17:00.401024 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:17:00.404420 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:17:00.405190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a514b461-5b1a-4de6-ae2d-6a633bbcffb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f8d348bdd0>]}
[0m00:17:01.209550 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fires_daily".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fires_daily").
  
  To fix this, change the name of one of these resources:
  - model.fires_dbt.fires_daily (models/silver/fires_daily.sql)
  - model.fires_dbt.fires_daily (models/silver/fires_daily.sql)
[0m00:17:01.211030 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2578297, "process_in_blocks": "0", "process_kernel_time": 0.479477, "process_mem_max_rss": "122984", "process_out_blocks": "0", "process_user_time": 2.957451}
[0m00:17:01.211652 [debug] [MainThread]: Command `dbt run` failed at 00:17:01.211551 after 1.26 seconds
[0m00:17:01.212235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f8d3f9f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f8d2937a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f8d3f61880>]}
[0m00:17:01.212673 [debug] [MainThread]: Flushing usage events
[0m00:17:01.845344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:33:17.220490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b677017950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b67672d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b67672cb30>]}


============================== 00:33:17.267877 | 1b938f84-8a88-4120-9a69-60eb3ac312de ==============================
[0m00:33:17.267877 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:33:17.268558 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'version_check': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --models +fires_raw+fires_cleaned+fires_enriched+fires_daily', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'quiet': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'partial_parse': 'True', 'no_print': 'None', 'fail_fast': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False'}
[0m00:33:17.269171 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m00:33:17.269690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b938f84-8a88-4120-9a69-60eb3ac312de', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b676ce9310>]}
[0m00:33:17.276833 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:33:17.620268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b938f84-8a88-4120-9a69-60eb3ac312de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b675cb3410>]}
[0m00:33:17.675450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b938f84-8a88-4120-9a69-60eb3ac312de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b675bc2a80>]}
[0m00:33:17.677049 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:33:17.764320 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:33:17.766951 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:33:17.767552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b938f84-8a88-4120-9a69-60eb3ac312de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b675a7dac0>]}
[0m00:33:18.652731 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fires_cleaned".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fires_cleaned").
  
  To fix this, change the name of one of these resources:
  - model.fires_dbt.fires_cleaned (models/silver/fires_cleaned.sql)
  - model.fires_dbt.fires_cleaned (models/silver/fires_cleaned.sql)
[0m00:33:18.653573 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:33:18.655667 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4955622, "process_in_blocks": "63376", "process_kernel_time": 0.498432, "process_mem_max_rss": "122852", "process_out_blocks": "0", "process_user_time": 3.03213}
[0m00:33:18.656310 [debug] [MainThread]: Command `dbt run` failed at 00:33:18.656198 after 1.50 seconds
[0m00:33:18.656993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b675df82f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b675c40530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b675c40e30>]}
[0m00:33:18.657553 [debug] [MainThread]: Flushing usage events
[0m00:33:19.692601 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:43:05.704922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec59208500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec58e5fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec58da0bf0>]}


============================== 00:43:05.745562 | 11bd76a2-c38e-4fac-87e4-d7b9734178a6 ==============================
[0m00:43:05.745562 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:43:05.746276 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'target_path': 'None', 'use_colors': 'True', 'empty': 'False', 'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'log_format': 'default', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'printer_width': '80', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m00:43:05.752305 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:43:06.041451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11bd76a2-c38e-4fac-87e4-d7b9734178a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec5b201fa0>]}
[0m00:43:06.101159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11bd76a2-c38e-4fac-87e4-d7b9734178a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec59208500>]}
[0m00:43:06.103190 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:43:06.203137 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:43:06.206393 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:43:06.207043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '11bd76a2-c38e-4fac-87e4-d7b9734178a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec58766480>]}
[0m00:43:07.125109 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fires_daily".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fires_daily").
  
  To fix this, change the name of one of these resources:
  - model.fires_dbt.fires_daily (models/silver/fires_daily.sql)
  - model.fires_dbt.fires_daily (models/silver/fires_daily.sql)
[0m00:43:07.126964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4821672, "process_in_blocks": "62912", "process_kernel_time": 0.435447, "process_mem_max_rss": "122860", "process_out_blocks": "0", "process_user_time": 3.108609}
[0m00:43:07.127547 [debug] [MainThread]: Command `dbt run` failed at 00:43:07.127446 after 1.48 seconds
[0m00:43:07.128019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec58e5cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec58d3bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec586c2360>]}
[0m00:43:07.128441 [debug] [MainThread]: Flushing usage events
[0m00:43:08.000903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:45:52.649371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0ff42f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0fe994e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0fece1730>]}


============================== 00:45:52.690093 | a2a9682c-ef38-4b97-92e3-dcb4fed977b9 ==============================
[0m00:45:52.690093 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:45:52.690782 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'log_format': 'default', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'static_parser': 'True', 'use_colors': 'True', 'introspect': 'True', 'quiet': 'False', 'version_check': 'True', 'printer_width': '80', 'indirect_selection': 'eager'}
[0m00:45:52.696980 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:45:52.862535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2a9682c-ef38-4b97-92e3-dcb4fed977b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0fe6866c0>]}
[0m00:45:52.918791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2a9682c-ef38-4b97-92e3-dcb4fed977b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0fe684110>]}
[0m00:45:52.920019 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:45:53.002834 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:45:53.005131 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:45:53.005627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a2a9682c-ef38-4b97-92e3-dcb4fed977b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0fea87cb0>]}
[0m00:45:54.017867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2a9682c-ef38-4b97-92e3-dcb4fed977b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0fd3ef9b0>]}
[0m00:45:54.081840 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:45:54.087196 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:45:54.137311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2a9682c-ef38-4b97-92e3-dcb4fed977b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0fd3990d0>]}
[0m00:45:54.137935 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m00:45:54.138396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2a9682c-ef38-4b97-92e3-dcb4fed977b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0fcf72c00>]}
[0m00:45:54.140165 [info ] [MainThread]: 
[0m00:45:54.140664 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m00:45:54.141114 [info ] [MainThread]: 
[0m00:45:54.141805 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:45:54.146259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:45:54.216079 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:45:54.216728 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:45:54.217255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:45:54.228851 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m00:45:54.230649 [debug] [ThreadPool]: On list_postgres: Close
[0m00:45:54.233336 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:45:54.233873 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:45:54.234318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:45:54.244444 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.010 seconds
[0m00:45:54.246224 [debug] [ThreadPool]: On list_postgres: Close
[0m00:45:54.248106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m00:45:54.253873 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:45:54.254426 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m00:45:54.254961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:45:54.265058 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m00:45:54.265788 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:45:54.266372 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m00:45:54.270883 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m00:45:54.272320 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m00:45:54.273553 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m00:45:54.274262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_public_public, now list_postgres_public)
[0m00:45:54.278119 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:45:54.278619 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m00:45:54.279172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:45:54.289065 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m00:45:54.289689 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m00:45:54.290152 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:45:54.294148 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.003 seconds
[0m00:45:54.296564 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m00:45:54.298349 [debug] [ThreadPool]: On list_postgres_public: Close
[0m00:45:54.308460 [debug] [MainThread]: Using postgres connection "master"
[0m00:45:54.309010 [debug] [MainThread]: On master: BEGIN
[0m00:45:54.309411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:45:54.319265 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:45:54.319986 [debug] [MainThread]: Using postgres connection "master"
[0m00:45:54.320690 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:45:54.326723 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m00:45:54.328226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2a9682c-ef38-4b97-92e3-dcb4fed977b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0fc314740>]}
[0m00:45:54.328858 [debug] [MainThread]: On master: ROLLBACK
[0m00:45:54.330692 [debug] [MainThread]: Using postgres connection "master"
[0m00:45:54.331243 [debug] [MainThread]: On master: BEGIN
[0m00:45:54.333304 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:45:54.333764 [debug] [MainThread]: On master: COMMIT
[0m00:45:54.334189 [debug] [MainThread]: Using postgres connection "master"
[0m00:45:54.334605 [debug] [MainThread]: On master: COMMIT
[0m00:45:54.335857 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:45:54.336288 [debug] [MainThread]: On master: Close
[0m00:45:54.340765 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m00:45:54.341556 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m00:45:54.342203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.fires_dbt.fires_raw)
[0m00:45:54.342711 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m00:45:54.350048 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m00:45:54.359631 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m00:45:54.391949 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m00:45:54.401898 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:45:54.402555 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m00:45:54.403004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:45:54.413298 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:45:54.414031 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:45:54.414562 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m00:45:54.443663 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m00:45:54.453223 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:45:54.453876 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m00:45:54.455860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:45:54.458731 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:45:54.459189 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m00:45:54.460811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:45:54.463172 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:45:54.464059 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m00:45:54.506498 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.042 seconds
[0m00:45:54.521897 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:45:54.522676 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:45:54.523180 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:45:54.545856 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m00:45:54.552234 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m00:45:54.557792 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:45:54.558360 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m00:45:54.562670 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:45:54.565545 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m00:45:54.567837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2a9682c-ef38-4b97-92e3-dcb4fed977b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee100b07710>]}
[0m00:45:54.568606 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.22s]
[0m00:45:54.569446 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m00:45:54.570540 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m00:45:54.571099 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m00:45:54.571680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m00:45:54.572122 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m00:45:54.575032 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m00:45:54.584333 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m00:45:54.589378 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m00:45:54.600034 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:45:54.600644 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m00:45:54.601146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:45:54.611645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:45:54.612488 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:45:54.613132 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m00:45:54.663938 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.050 seconds
[0m00:45:54.667529 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:45:54.668175 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m00:45:54.669874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:45:54.671408 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:45:54.671894 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:45:54.672330 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:45:54.684923 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m00:45:54.687465 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m00:45:54.688264 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:45:54.688857 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m00:45:54.690740 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m00:45:54.692223 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m00:45:54.692966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2a9682c-ef38-4b97-92e3-dcb4fed977b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0feaf4320>]}
[0m00:45:54.693717 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.12s]
[0m00:45:54.694421 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m00:45:54.695380 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m00:45:54.696175 [info ] [Thread-1 (]: 3 of 4 START sql view model public.fires_enriched .............................. [RUN]
[0m00:45:54.697001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m00:45:54.697610 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m00:45:54.700816 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m00:45:54.706546 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m00:45:54.722797 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m00:45:54.729530 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:45:54.730319 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m00:45:54.731073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:45:54.741061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:45:54.741757 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:45:54.742519 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  create view "postgres"."public"."fires_enriched__dbt_tmp"
    
    
  as (
    FROM "postgres"."public_public"."fires_cleaned" fc

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
[0m00:45:54.744382 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 7:     FROM "postgres"."public_public"."fires_cleaned" fc
            ^

[0m00:45:54.744950 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: ROLLBACK
[0m00:45:54.746794 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m00:45:54.753161 [debug] [Thread-1 (]: Database Error in model fires_enriched (models/silver/fires_enriched.sql)
  syntax error at or near "FROM"
  LINE 7:     FROM "postgres"."public_public"."fires_cleaned" fc
              ^
  compiled code at target/run/fires_dbt/models/silver/fires_enriched.sql
[0m00:45:54.753912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2a9682c-ef38-4b97-92e3-dcb4fed977b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0fd796c00>]}
[0m00:45:54.754755 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model public.fires_enriched ..................... [[31mERROR[0m in 0.06s]
[0m00:45:54.755686 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m00:45:54.756383 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_enriched' to be skipped because of status 'error'.  Reason: Database Error in model fires_enriched (models/silver/fires_enriched.sql)
  syntax error at or near "FROM"
  LINE 7:     FROM "postgres"."public_public"."fires_cleaned" fc
              ^
  compiled code at target/run/fires_dbt/models/silver/fires_enriched.sql.
[0m00:45:54.757905 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m00:45:54.758432 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.fires_daily ........................................ [[33mSKIP[0m]
[0m00:45:54.758964 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m00:45:54.760435 [debug] [MainThread]: Using postgres connection "master"
[0m00:45:54.760879 [debug] [MainThread]: On master: BEGIN
[0m00:45:54.761239 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:45:54.771146 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:45:54.771823 [debug] [MainThread]: On master: COMMIT
[0m00:45:54.772287 [debug] [MainThread]: Using postgres connection "master"
[0m00:45:54.772688 [debug] [MainThread]: On master: COMMIT
[0m00:45:54.773978 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:45:54.774410 [debug] [MainThread]: On master: Close
[0m00:45:54.774963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:45:54.777082 [debug] [MainThread]: Connection 'model.fires_dbt.fires_enriched' was properly closed.
[0m00:45:54.777688 [info ] [MainThread]: 
[0m00:45:54.778244 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m00:45:54.779366 [debug] [MainThread]: Command end result
[0m00:45:54.804458 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:45:54.808486 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:45:54.816405 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m00:45:54.816947 [info ] [MainThread]: 
[0m00:45:54.817477 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:45:54.817960 [info ] [MainThread]: 
[0m00:45:54.818484 [error] [MainThread]: [31mFailure in model fires_enriched (models/silver/fires_enriched.sql)[0m
[0m00:45:54.819019 [error] [MainThread]:   Database Error in model fires_enriched (models/silver/fires_enriched.sql)
  syntax error at or near "FROM"
  LINE 7:     FROM "postgres"."public_public"."fires_cleaned" fc
              ^
  compiled code at target/run/fires_dbt/models/silver/fires_enriched.sql
[0m00:45:54.819466 [info ] [MainThread]: 
[0m00:45:54.820171 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_enriched.sql
[0m00:45:54.820709 [info ] [MainThread]: 
[0m00:45:54.821156 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=4
[0m00:45:54.822311 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2341611, "process_in_blocks": "2832", "process_kernel_time": 0.498579, "process_mem_max_rss": "128168", "process_out_blocks": "0", "process_user_time": 3.5182}
[0m00:45:54.822892 [debug] [MainThread]: Command `dbt run` failed at 00:45:54.822793 after 2.23 seconds
[0m00:45:54.823353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0fe994e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0fd38bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee0fdc3e2a0>]}
[0m00:45:54.823909 [debug] [MainThread]: Flushing usage events
[0m00:45:55.748550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:47:52.083845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d55b57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d543cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d78c1b80>]}


============================== 00:47:52.124215 | 49d2fe2e-4148-4513-9342-c10e06ff4f80 ==============================
[0m00:47:52.124215 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:47:52.125033 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'write_json': 'True', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'cache_selected_only': 'False', 'quiet': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'version_check': 'True', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'introspect': 'True', 'debug': 'False'}
[0m00:47:52.132258 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:47:52.321478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49d2fe2e-4148-4513-9342-c10e06ff4f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d512f6e0>]}
[0m00:47:52.375645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49d2fe2e-4148-4513-9342-c10e06ff4f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d4b252e0>]}
[0m00:47:52.376833 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:47:52.460257 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:47:52.609171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:47:52.610029 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/silver/fires_daily.sql
[0m00:47:52.610581 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/silver/fires_enriched.sql
[0m00:47:52.841640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49d2fe2e-4148-4513-9342-c10e06ff4f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d4ebc140>]}
[0m00:47:52.906063 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:47:52.910907 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:47:52.945836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49d2fe2e-4148-4513-9342-c10e06ff4f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d47d0aa0>]}
[0m00:47:52.946517 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m00:47:52.947035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49d2fe2e-4148-4513-9342-c10e06ff4f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d3b8fd40>]}
[0m00:47:52.948911 [info ] [MainThread]: 
[0m00:47:52.949464 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m00:47:52.949980 [info ] [MainThread]: 
[0m00:47:52.950647 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:47:52.954781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:47:53.004671 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:47:53.005298 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:47:53.005787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:53.017455 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m00:47:53.019139 [debug] [ThreadPool]: On list_postgres: Close
[0m00:47:53.021267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m00:47:53.027204 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:47:53.027867 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m00:47:53.028397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:47:53.039569 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m00:47:53.040215 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:47:53.040714 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m00:47:53.045276 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m00:47:53.046866 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m00:47:53.048500 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m00:47:53.053740 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:53.054477 [debug] [MainThread]: On master: BEGIN
[0m00:47:53.054950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:47:53.070096 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m00:47:53.070910 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:53.071444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:47:53.076655 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m00:47:53.078116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49d2fe2e-4148-4513-9342-c10e06ff4f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d4974770>]}
[0m00:47:53.078936 [debug] [MainThread]: On master: ROLLBACK
[0m00:47:53.080628 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:53.081125 [debug] [MainThread]: On master: BEGIN
[0m00:47:53.083224 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:47:53.083686 [debug] [MainThread]: On master: COMMIT
[0m00:47:53.084135 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:53.084518 [debug] [MainThread]: On master: COMMIT
[0m00:47:53.085666 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:47:53.086133 [debug] [MainThread]: On master: Close
[0m00:47:53.089245 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m00:47:53.090046 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m00:47:53.090797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m00:47:53.091289 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m00:47:53.098803 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m00:47:53.104350 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m00:47:53.137561 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m00:47:53.143594 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:47:53.144206 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m00:47:53.144623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:53.155671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:47:53.156438 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:47:53.156989 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m00:47:53.187439 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.030 seconds
[0m00:47:53.197122 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:47:53.197808 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m00:47:53.199814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:47:53.203262 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:47:53.203994 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m00:47:53.205931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:47:53.208416 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:47:53.209059 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m00:47:53.247898 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.038 seconds
[0m00:47:53.265480 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:47:53.266173 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:47:53.266727 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:47:53.276328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m00:47:53.283157 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m00:47:53.289010 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:47:53.289734 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m00:47:53.294415 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:47:53.297035 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m00:47:53.298831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d2fe2e-4148-4513-9342-c10e06ff4f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d75b74d0>]}
[0m00:47:53.299619 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.21s]
[0m00:47:53.300375 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m00:47:53.301276 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m00:47:53.301887 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m00:47:53.302607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m00:47:53.303149 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m00:47:53.306594 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m00:47:53.313250 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m00:47:53.317010 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m00:47:53.323695 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:47:53.324321 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m00:47:53.324801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:53.335169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:47:53.335890 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:47:53.336816 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m00:47:53.383481 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.046 seconds
[0m00:47:53.387951 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:47:53.388776 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m00:47:53.390831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:47:53.394176 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:47:53.394888 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m00:47:53.396755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:47:53.398961 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:47:53.399704 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:47:53.400169 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:47:53.413505 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m00:47:53.416751 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m00:47:53.417943 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:47:53.418547 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m00:47:53.424184 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:47:53.425895 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m00:47:53.426823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d2fe2e-4148-4513-9342-c10e06ff4f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d2726fc0>]}
[0m00:47:53.427723 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.12s]
[0m00:47:53.428486 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m00:47:53.429398 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m00:47:53.430224 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m00:47:53.430950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m00:47:53.431446 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m00:47:53.434736 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m00:47:53.442248 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m00:47:53.446025 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m00:47:53.453104 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:47:53.453970 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m00:47:53.454638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:53.466533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m00:47:53.467314 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:47:53.468032 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m00:47:53.495941 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.027 seconds
[0m00:47:53.499566 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:47:53.500090 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m00:47:53.501780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:47:53.503354 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:47:53.504277 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:47:53.504826 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:47:53.515671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m00:47:53.518404 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m00:47:53.521072 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:47:53.521798 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m00:47:53.523805 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m00:47:53.525435 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m00:47:53.526196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d2fe2e-4148-4513-9342-c10e06ff4f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d27c6fc0>]}
[0m00:47:53.526910 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.10s]
[0m00:47:53.527587 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m00:47:53.528621 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m00:47:53.529430 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m00:47:53.530040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m00:47:53.530519 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m00:47:53.533380 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m00:47:53.539929 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m00:47:53.543616 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m00:47:53.550091 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:47:53.550729 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m00:47:53.551267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:47:53.562472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:47:53.563129 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:47:53.563615 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m00:47:53.566966 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:47:53.567536 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m00:47:53.569222 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m00:47:53.573765 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:47:53.574724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d2fe2e-4148-4513-9342-c10e06ff4f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d27930b0>]}
[0m00:47:53.575582 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m00:47:53.576357 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m00:47:53.577054 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m00:47:53.579076 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:53.579524 [debug] [MainThread]: On master: BEGIN
[0m00:47:53.579929 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:47:53.590903 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m00:47:53.591600 [debug] [MainThread]: On master: COMMIT
[0m00:47:53.592136 [debug] [MainThread]: Using postgres connection "master"
[0m00:47:53.592706 [debug] [MainThread]: On master: COMMIT
[0m00:47:53.594021 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:47:53.594492 [debug] [MainThread]: On master: Close
[0m00:47:53.595084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:53.595571 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m00:47:53.596094 [info ] [MainThread]: 
[0m00:47:53.596589 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m00:47:53.598070 [debug] [MainThread]: Command end result
[0m00:47:53.622744 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:47:53.627120 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:47:53.635730 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m00:47:53.636286 [info ] [MainThread]: 
[0m00:47:53.636919 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:47:53.637628 [info ] [MainThread]: 
[0m00:47:53.638359 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m00:47:53.638988 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:47:53.639784 [info ] [MainThread]: 
[0m00:47:53.640340 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m00:47:53.640778 [info ] [MainThread]: 
[0m00:47:53.641258 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m00:47:53.642397 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.633681, "process_in_blocks": "0", "process_kernel_time": 0.454012, "process_mem_max_rss": "129208", "process_out_blocks": "0", "process_user_time": 2.953087}
[0m00:47:53.642930 [debug] [MainThread]: Command `dbt run` failed at 00:47:53.642830 after 1.63 seconds
[0m00:47:53.643435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d567e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d9276fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c1d2783050>]}
[0m00:47:53.643888 [debug] [MainThread]: Flushing usage events
[0m00:47:54.502028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:48:12.211779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535fcf2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535f7fa3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535fa96840>]}


============================== 00:48:12.255619 | 024b7032-2657-48bb-98e3-f77e4b2406ad ==============================
[0m00:48:12.255619 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:48:12.256794 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'introspect': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'write_json': 'True', 'debug': 'False'}
[0m00:48:12.265581 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:48:12.469030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '024b7032-2657-48bb-98e3-f77e4b2406ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535ee93320>]}
[0m00:48:12.543540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '024b7032-2657-48bb-98e3-f77e4b2406ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535fb0a7b0>]}
[0m00:48:12.544907 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:48:12.638540 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:48:12.794011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:48:12.794802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:48:12.824802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '024b7032-2657-48bb-98e3-f77e4b2406ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535efb6bd0>]}
[0m00:48:12.893139 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:48:12.897979 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:48:12.934922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '024b7032-2657-48bb-98e3-f77e4b2406ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535ecf90a0>]}
[0m00:48:12.935560 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m00:48:12.936032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '024b7032-2657-48bb-98e3-f77e4b2406ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535ecb6450>]}
[0m00:48:12.937881 [info ] [MainThread]: 
[0m00:48:12.938373 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m00:48:12.938815 [info ] [MainThread]: 
[0m00:48:12.939463 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:48:12.944411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:48:13.000576 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:48:13.001289 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:48:13.001917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:13.015310 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m00:48:13.016983 [debug] [ThreadPool]: On list_postgres: Close
[0m00:48:13.018851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m00:48:13.026411 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:48:13.027290 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m00:48:13.027911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:48:13.039071 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m00:48:13.040070 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:48:13.041060 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m00:48:13.047750 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m00:48:13.050134 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m00:48:13.052161 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m00:48:13.058239 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:13.059190 [debug] [MainThread]: On master: BEGIN
[0m00:48:13.059826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:48:13.072823 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m00:48:13.073645 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:13.074358 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:48:13.080666 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m00:48:13.082529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '024b7032-2657-48bb-98e3-f77e4b2406ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535d7060c0>]}
[0m00:48:13.083270 [debug] [MainThread]: On master: ROLLBACK
[0m00:48:13.084969 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:13.085599 [debug] [MainThread]: On master: BEGIN
[0m00:48:13.088715 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:48:13.089641 [debug] [MainThread]: On master: COMMIT
[0m00:48:13.090310 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:13.090913 [debug] [MainThread]: On master: COMMIT
[0m00:48:13.093518 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:48:13.094460 [debug] [MainThread]: On master: Close
[0m00:48:13.099211 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m00:48:13.100252 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m00:48:13.101051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m00:48:13.101643 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m00:48:13.110687 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m00:48:13.118819 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m00:48:13.163213 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m00:48:13.168719 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:48:13.169546 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m00:48:13.170100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:48:13.180885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:48:13.181807 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:48:13.182655 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m00:48:13.213330 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.030 seconds
[0m00:48:13.223330 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:48:13.224304 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m00:48:13.226611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:48:13.230449 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:48:13.231026 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m00:48:13.233143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:48:13.235698 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:48:13.236283 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m00:48:15.557117 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 2.320 seconds
[0m00:48:15.576713 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:48:15.577916 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:48:15.578630 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:48:15.717641 [debug] [Thread-1 (]: SQL status: COMMIT in 0.138 seconds
[0m00:48:15.724453 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m00:48:15.732236 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:48:15.733122 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m00:48:15.738321 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:48:15.741319 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m00:48:15.743628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024b7032-2657-48bb-98e3-f77e4b2406ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5361b1fc80>]}
[0m00:48:15.744871 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 2.64s]
[0m00:48:15.745764 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m00:48:15.747303 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m00:48:15.748279 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m00:48:15.749148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m00:48:15.749810 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m00:48:15.754216 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m00:48:15.761593 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m00:48:15.767062 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m00:48:15.774513 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:48:15.775133 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m00:48:15.775625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:48:15.788629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m00:48:15.789655 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:48:15.790412 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m00:48:15.832035 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.041 seconds
[0m00:48:15.836082 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:48:15.836664 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m00:48:15.838700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:48:15.841941 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:48:15.842495 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m00:48:15.845063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:48:15.847929 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:48:15.848924 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:48:15.849772 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:48:16.137629 [debug] [Thread-1 (]: SQL status: COMMIT in 0.287 seconds
[0m00:48:16.140374 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m00:48:16.141369 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:48:16.141928 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m00:48:16.147472 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:48:16.149547 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m00:48:16.150388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024b7032-2657-48bb-98e3-f77e4b2406ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535e7be2d0>]}
[0m00:48:16.151159 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.40s]
[0m00:48:16.151849 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m00:48:16.152670 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m00:48:16.153293 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m00:48:16.153979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m00:48:16.154542 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m00:48:16.157663 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m00:48:16.164262 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m00:48:16.169293 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m00:48:16.175045 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:48:16.175605 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m00:48:16.176078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:48:16.186784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:48:16.187511 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:48:16.188084 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m00:48:16.215434 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.027 seconds
[0m00:48:16.219027 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:48:16.219593 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m00:48:16.221378 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:48:16.224237 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:48:16.224718 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m00:48:16.226338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:48:16.228627 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:48:16.229606 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:48:16.230179 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:48:16.758319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.527 seconds
[0m00:48:16.761158 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m00:48:16.762504 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:48:16.763207 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m00:48:16.768778 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:48:16.770717 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m00:48:16.771583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024b7032-2657-48bb-98e3-f77e4b2406ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535d321640>]}
[0m00:48:16.772387 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.62s]
[0m00:48:16.773173 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m00:48:16.774172 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m00:48:16.774761 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m00:48:16.775355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m00:48:16.775820 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m00:48:16.779228 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m00:48:16.785349 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m00:48:16.788778 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m00:48:16.794058 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:48:16.794703 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m00:48:16.795499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:48:16.805617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:48:16.806358 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:48:16.806977 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m00:48:16.809152 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:48:16.809964 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m00:48:16.811999 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m00:48:16.816240 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:48:16.817245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '024b7032-2657-48bb-98e3-f77e4b2406ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535d7d2f90>]}
[0m00:48:16.818087 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m00:48:16.818742 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m00:48:16.819359 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m00:48:16.821351 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:16.821853 [debug] [MainThread]: On master: BEGIN
[0m00:48:16.822263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:48:16.833990 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m00:48:16.834628 [debug] [MainThread]: On master: COMMIT
[0m00:48:16.835068 [debug] [MainThread]: Using postgres connection "master"
[0m00:48:16.835480 [debug] [MainThread]: On master: COMMIT
[0m00:48:16.836722 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:48:16.837148 [debug] [MainThread]: On master: Close
[0m00:48:16.837725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:48:16.838133 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m00:48:16.838682 [info ] [MainThread]: 
[0m00:48:16.839185 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 3.90 seconds (3.90s).
[0m00:48:16.840336 [debug] [MainThread]: Command end result
[0m00:48:16.867247 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:48:16.871590 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:48:16.880827 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m00:48:16.881551 [info ] [MainThread]: 
[0m00:48:16.882175 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:48:16.882694 [info ] [MainThread]: 
[0m00:48:16.883240 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m00:48:16.883755 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:48:16.884225 [info ] [MainThread]: 
[0m00:48:16.884784 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m00:48:16.885201 [info ] [MainThread]: 
[0m00:48:16.885714 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m00:48:16.886786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.7423167, "process_in_blocks": "0", "process_kernel_time": 0.437646, "process_mem_max_rss": "125176", "process_out_blocks": "0", "process_user_time": 2.733301}
[0m00:48:16.887373 [debug] [MainThread]: Command `dbt run` failed at 00:48:16.887274 after 4.74 seconds
[0m00:48:16.887857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5361e24740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535f285070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535d32ed50>]}
[0m00:48:16.888315 [debug] [MainThread]: Flushing usage events
[0m00:48:17.666054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:50:58.828551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d436a1cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d438544860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4368c1280>]}


============================== 00:50:58.871472 | e7f086b0-ac30-407c-8420-34d998b2bf44 ==============================
[0m00:50:58.871472 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:50:58.872179 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'introspect': 'True', 'static_parser': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'empty': 'False', 'quiet': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80'}
[0m00:50:58.880916 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:50:59.093035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7f086b0-ac30-407c-8420-34d998b2bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4362ca5a0>]}
[0m00:50:59.151341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7f086b0-ac30-407c-8420-34d998b2bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d435accb30>]}
[0m00:50:59.152569 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:50:59.237010 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:50:59.389104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:50:59.389961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:50:59.422353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7f086b0-ac30-407c-8420-34d998b2bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4357eaea0>]}
[0m00:50:59.499682 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:50:59.505023 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:50:59.545661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7f086b0-ac30-407c-8420-34d998b2bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4353a8c50>]}
[0m00:50:59.546699 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m00:50:59.547627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f086b0-ac30-407c-8420-34d998b2bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d435373d40>]}
[0m00:50:59.551189 [info ] [MainThread]: 
[0m00:50:59.552145 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m00:50:59.552885 [info ] [MainThread]: 
[0m00:50:59.554490 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:50:59.561173 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:50:59.616144 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:50:59.617002 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:50:59.617653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:50:59.632448 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.015 seconds
[0m00:50:59.634159 [debug] [ThreadPool]: On list_postgres: Close
[0m00:50:59.636205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m00:50:59.643175 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:50:59.643854 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m00:50:59.644360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:50:59.655460 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m00:50:59.656314 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:50:59.656897 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m00:50:59.661194 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m00:50:59.662886 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m00:50:59.664697 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m00:50:59.670495 [debug] [MainThread]: Using postgres connection "master"
[0m00:50:59.671181 [debug] [MainThread]: On master: BEGIN
[0m00:50:59.671715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:50:59.682456 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m00:50:59.683163 [debug] [MainThread]: Using postgres connection "master"
[0m00:50:59.683680 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:50:59.689016 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m00:50:59.690781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f086b0-ac30-407c-8420-34d998b2bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d434b56060>]}
[0m00:50:59.691509 [debug] [MainThread]: On master: ROLLBACK
[0m00:50:59.693111 [debug] [MainThread]: Using postgres connection "master"
[0m00:50:59.693550 [debug] [MainThread]: On master: BEGIN
[0m00:50:59.695708 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:50:59.696246 [debug] [MainThread]: On master: COMMIT
[0m00:50:59.696753 [debug] [MainThread]: Using postgres connection "master"
[0m00:50:59.697190 [debug] [MainThread]: On master: COMMIT
[0m00:50:59.699056 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:50:59.699678 [debug] [MainThread]: On master: Close
[0m00:50:59.702800 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m00:50:59.704050 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m00:50:59.705099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m00:50:59.705840 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m00:50:59.713528 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m00:50:59.719634 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m00:50:59.767934 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m00:50:59.775545 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:50:59.776823 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m00:50:59.777449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:50:59.792670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m00:50:59.793799 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:50:59.794697 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m00:50:59.863089 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.067 seconds
[0m00:50:59.881071 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:50:59.882080 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m00:50:59.885148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:50:59.890033 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:50:59.890829 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m00:50:59.893024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:50:59.895742 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:50:59.896542 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m00:50:59.938720 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.041 seconds
[0m00:50:59.958725 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:50:59.959637 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:50:59.960388 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:50:59.975666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m00:50:59.983090 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m00:50:59.990137 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:50:59.990933 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m00:50:59.996887 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:51:00.000389 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m00:51:00.002732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f086b0-ac30-407c-8420-34d998b2bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d438223ad0>]}
[0m00:51:00.003713 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.30s]
[0m00:51:00.004638 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m00:51:00.005972 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m00:51:00.006737 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m00:51:00.007445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m00:51:00.007996 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m00:51:00.012381 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m00:51:00.020882 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m00:51:00.025035 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m00:51:00.032426 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:51:00.033087 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m00:51:00.033654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:00.044834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:51:00.045930 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:51:00.046707 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m00:51:00.089167 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.042 seconds
[0m00:51:00.094720 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:51:00.095958 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m00:51:00.098287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:51:00.102908 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:51:00.103715 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m00:51:00.106097 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:51:00.107941 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:51:00.108480 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:51:00.108920 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:51:00.118375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m00:51:00.121486 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m00:51:00.122490 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:51:00.123000 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m00:51:00.127774 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:51:00.129396 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m00:51:00.130274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f086b0-ac30-407c-8420-34d998b2bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d433b181d0>]}
[0m00:51:00.131196 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.12s]
[0m00:51:00.132030 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m00:51:00.133230 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m00:51:00.133934 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m00:51:00.134598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m00:51:00.135087 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m00:51:00.138626 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m00:51:00.144823 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m00:51:00.151608 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m00:51:00.159027 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:51:00.159695 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m00:51:00.160147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:00.171136 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:51:00.172184 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:51:00.172824 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m00:51:00.200123 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.027 seconds
[0m00:51:00.204007 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:51:00.204658 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m00:51:00.206651 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:51:00.210203 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:51:00.210828 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m00:51:00.212625 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:51:00.214317 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:51:00.214903 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:51:00.215414 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:51:00.229818 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m00:51:00.233094 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m00:51:00.234212 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:51:00.234751 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m00:51:00.240295 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:51:00.242108 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m00:51:00.243016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f086b0-ac30-407c-8420-34d998b2bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d433bde300>]}
[0m00:51:00.243916 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.11s]
[0m00:51:00.244755 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m00:51:00.245675 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m00:51:00.246291 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m00:51:00.246922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m00:51:00.247542 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m00:51:00.250913 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m00:51:00.257485 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m00:51:00.261337 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m00:51:00.268161 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:51:00.268850 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m00:51:00.269393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:00.279555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:51:00.280268 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:51:00.280993 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m00:51:00.283567 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:51:00.284294 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m00:51:00.286046 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m00:51:00.290436 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:51:00.291258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f086b0-ac30-407c-8420-34d998b2bf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d433bac6e0>]}
[0m00:51:00.292009 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m00:51:00.292732 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m00:51:00.293385 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m00:51:00.295533 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:00.295965 [debug] [MainThread]: On master: BEGIN
[0m00:51:00.296409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:51:00.307253 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m00:51:00.307942 [debug] [MainThread]: On master: COMMIT
[0m00:51:00.308428 [debug] [MainThread]: Using postgres connection "master"
[0m00:51:00.308884 [debug] [MainThread]: On master: COMMIT
[0m00:51:00.310174 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:51:00.310606 [debug] [MainThread]: On master: Close
[0m00:51:00.311252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:00.311673 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m00:51:00.312216 [info ] [MainThread]: 
[0m00:51:00.312681 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m00:51:00.314108 [debug] [MainThread]: Command end result
[0m00:51:00.341192 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:51:00.345368 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:51:00.353775 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m00:51:00.354385 [info ] [MainThread]: 
[0m00:51:00.354932 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:51:00.355409 [info ] [MainThread]: 
[0m00:51:00.355946 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m00:51:00.356526 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:51:00.356975 [info ] [MainThread]: 
[0m00:51:00.357498 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m00:51:00.358008 [info ] [MainThread]: 
[0m00:51:00.358537 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m00:51:00.359662 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6215962, "process_in_blocks": "0", "process_kernel_time": 0.507191, "process_mem_max_rss": "125276", "process_out_blocks": "0", "process_user_time": 2.899375}
[0m00:51:00.360199 [debug] [MainThread]: Command `dbt run` failed at 00:51:00.360097 after 1.62 seconds
[0m00:51:00.360682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4368c94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d43373edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d43373fe60>]}
[0m00:51:00.361138 [debug] [MainThread]: Flushing usage events
[0m00:51:01.199033 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:52:58.510990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d93bf5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6db3c2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d8c59580>]}


============================== 00:52:58.559981 | b9cb55d4-099a-493c-aa9c-b742f669a935 ==============================
[0m00:52:58.559981 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:52:58.560726 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'write_json': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'use_colors': 'True', 'printer_width': '80', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager'}
[0m00:52:58.566483 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:52:58.736192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9cb55d4-099a-493c-aa9c-b742f669a935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d80736e0>]}
[0m00:52:58.793630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9cb55d4-099a-493c-aa9c-b742f669a935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d7e3c1a0>]}
[0m00:52:58.794951 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:52:58.881345 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:52:59.044505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:52:59.045174 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:52:59.095988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9cb55d4-099a-493c-aa9c-b742f669a935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d7e11e80>]}
[0m00:52:59.212417 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:52:59.217439 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:52:59.258462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9cb55d4-099a-493c-aa9c-b742f669a935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d7c419a0>]}
[0m00:52:59.259226 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m00:52:59.259786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9cb55d4-099a-493c-aa9c-b742f669a935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d83834a0>]}
[0m00:52:59.262164 [info ] [MainThread]: 
[0m00:52:59.263230 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m00:52:59.263785 [info ] [MainThread]: 
[0m00:52:59.264639 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:52:59.268934 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:52:59.330303 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:52:59.331013 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:52:59.331534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:59.345124 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.014 seconds
[0m00:52:59.346738 [debug] [ThreadPool]: On list_postgres: Close
[0m00:52:59.348385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m00:52:59.354902 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:52:59.355692 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m00:52:59.356301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:52:59.368221 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m00:52:59.368865 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:52:59.369353 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m00:52:59.373979 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m00:52:59.376180 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m00:52:59.377965 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m00:52:59.383190 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:59.383872 [debug] [MainThread]: On master: BEGIN
[0m00:52:59.384433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:52:59.396213 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m00:52:59.396897 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:59.397387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:52:59.403044 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m00:52:59.405025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9cb55d4-099a-493c-aa9c-b742f669a935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d7e11f70>]}
[0m00:52:59.405919 [debug] [MainThread]: On master: ROLLBACK
[0m00:52:59.407736 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:59.408429 [debug] [MainThread]: On master: BEGIN
[0m00:52:59.411085 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:52:59.411723 [debug] [MainThread]: On master: COMMIT
[0m00:52:59.412275 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:59.412755 [debug] [MainThread]: On master: COMMIT
[0m00:52:59.414210 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:52:59.414815 [debug] [MainThread]: On master: Close
[0m00:52:59.418313 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m00:52:59.419295 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m00:52:59.420102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m00:52:59.420667 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m00:52:59.428998 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m00:52:59.434642 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m00:52:59.473604 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m00:52:59.479955 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:52:59.480625 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m00:52:59.481190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:59.492374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:52:59.493324 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:52:59.494042 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m00:52:59.523509 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.029 seconds
[0m00:52:59.533301 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:52:59.534037 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m00:52:59.536242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:52:59.540035 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:52:59.540776 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m00:52:59.543777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:52:59.546727 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:52:59.547392 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m00:52:59.576993 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.029 seconds
[0m00:52:59.592879 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:52:59.593703 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:52:59.594250 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:52:59.605762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m00:52:59.612860 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m00:52:59.618668 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:52:59.619284 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m00:52:59.624261 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:52:59.627772 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m00:52:59.630037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9cb55d4-099a-493c-aa9c-b742f669a935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6daa7ba70>]}
[0m00:52:59.630934 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.21s]
[0m00:52:59.632017 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m00:52:59.633056 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m00:52:59.633767 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m00:52:59.634464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m00:52:59.635006 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m00:52:59.638211 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m00:52:59.645617 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m00:52:59.649630 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m00:52:59.655749 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:52:59.656742 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m00:52:59.657292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:59.668423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:52:59.669267 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:52:59.669819 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m00:52:59.707045 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.037 seconds
[0m00:52:59.711269 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:52:59.712076 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m00:52:59.714205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:52:59.717594 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:52:59.718098 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m00:52:59.719983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:52:59.722068 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:52:59.722831 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:52:59.723404 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:52:59.733920 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m00:52:59.736853 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m00:52:59.737746 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:52:59.738296 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m00:52:59.744413 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:52:59.746386 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m00:52:59.747227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9cb55d4-099a-493c-aa9c-b742f669a935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d63cc3e0>]}
[0m00:52:59.748027 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.11s]
[0m00:52:59.748908 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m00:52:59.749930 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m00:52:59.750575 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m00:52:59.751192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m00:52:59.751707 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m00:52:59.754882 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m00:52:59.761875 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m00:52:59.767008 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m00:52:59.773708 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:52:59.774483 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m00:52:59.775063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:59.785965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:52:59.786738 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:52:59.787352 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m00:52:59.815535 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m00:52:59.819352 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:52:59.820014 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m00:52:59.822277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:52:59.826388 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:52:59.827066 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m00:52:59.829411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:52:59.831582 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:52:59.832209 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:52:59.832706 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:52:59.845258 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m00:52:59.848279 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m00:52:59.849195 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:52:59.849693 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m00:52:59.854648 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:52:59.856834 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m00:52:59.857921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9cb55d4-099a-493c-aa9c-b742f669a935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d63f89e0>]}
[0m00:52:59.859008 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.11s]
[0m00:52:59.860184 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m00:52:59.861552 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m00:52:59.862314 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m00:52:59.863172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m00:52:59.863735 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m00:52:59.867196 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m00:52:59.873889 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m00:52:59.878124 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m00:52:59.884678 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:52:59.885361 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m00:52:59.885951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:59.897702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m00:52:59.898584 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:52:59.899184 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m00:52:59.902227 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:52:59.903201 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m00:52:59.905207 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m00:52:59.909926 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:52:59.910978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9cb55d4-099a-493c-aa9c-b742f669a935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d7c42360>]}
[0m00:52:59.911993 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.05s]
[0m00:52:59.912971 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m00:52:59.913767 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m00:52:59.916253 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:59.916854 [debug] [MainThread]: On master: BEGIN
[0m00:52:59.917331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:52:59.928522 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m00:52:59.929193 [debug] [MainThread]: On master: COMMIT
[0m00:52:59.929678 [debug] [MainThread]: Using postgres connection "master"
[0m00:52:59.930075 [debug] [MainThread]: On master: COMMIT
[0m00:52:59.931444 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:52:59.931959 [debug] [MainThread]: On master: Close
[0m00:52:59.932649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:52:59.933043 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m00:52:59.933547 [info ] [MainThread]: 
[0m00:52:59.934211 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m00:52:59.935435 [debug] [MainThread]: Command end result
[0m00:52:59.963021 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:52:59.967392 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:52:59.976939 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m00:52:59.977574 [info ] [MainThread]: 
[0m00:52:59.978368 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:52:59.979011 [info ] [MainThread]: 
[0m00:52:59.979662 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m00:52:59.980266 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:52:59.981011 [info ] [MainThread]: 
[0m00:52:59.981591 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m00:52:59.982175 [info ] [MainThread]: 
[0m00:52:59.982688 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m00:52:59.983859 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5370677, "process_in_blocks": "0", "process_kernel_time": 0.460639, "process_mem_max_rss": "125020", "process_out_blocks": "0", "process_user_time": 2.867081}
[0m00:52:59.984399 [debug] [MainThread]: Command `dbt run` failed at 00:52:59.984298 after 1.54 seconds
[0m00:52:59.984909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d8da0800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d93ecdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf6d5f2ee70>]}
[0m00:52:59.985399 [debug] [MainThread]: Flushing usage events
[0m00:53:00.824715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:53:20.885504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9cdb1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9c981e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9ca5e4b0>]}


============================== 00:53:20.930297 | cc95d4ae-4626-48ec-b091-49ee410f2ba1 ==============================
[0m00:53:20.930297 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:53:20.930977 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'empty': 'False', 'version_check': 'True', 'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'quiet': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'introspect': 'True'}
[0m00:53:20.936540 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:53:21.097422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc95d4ae-4626-48ec-b091-49ee410f2ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9bd0d3a0>]}
[0m00:53:21.154109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc95d4ae-4626-48ec-b091-49ee410f2ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9c98f3e0>]}
[0m00:53:21.155408 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:53:21.241628 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:53:21.390292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:53:21.390903 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:53:21.420431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc95d4ae-4626-48ec-b091-49ee410f2ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9bb03860>]}
[0m00:53:21.491500 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:53:21.496410 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:53:21.531169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc95d4ae-4626-48ec-b091-49ee410f2ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9b93d7c0>]}
[0m00:53:21.531958 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m00:53:21.532505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc95d4ae-4626-48ec-b091-49ee410f2ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9bd8ef90>]}
[0m00:53:21.534405 [info ] [MainThread]: 
[0m00:53:21.534916 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m00:53:21.535379 [info ] [MainThread]: 
[0m00:53:21.536095 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:53:21.539952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:53:21.591407 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:53:21.592082 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:53:21.592665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:21.604026 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m00:53:21.605629 [debug] [ThreadPool]: On list_postgres: Close
[0m00:53:21.607439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m00:53:21.613065 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:53:21.613629 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m00:53:21.614056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:53:21.623801 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m00:53:21.624504 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:53:21.625109 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m00:53:21.629785 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m00:53:21.631481 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m00:53:21.632967 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m00:53:21.637808 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:21.638352 [debug] [MainThread]: On master: BEGIN
[0m00:53:21.638837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:53:21.648992 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:53:21.649647 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:21.650133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:53:21.654829 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m00:53:21.656192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc95d4ae-4626-48ec-b091-49ee410f2ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9bb03d40>]}
[0m00:53:21.656855 [debug] [MainThread]: On master: ROLLBACK
[0m00:53:21.658122 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:21.658556 [debug] [MainThread]: On master: BEGIN
[0m00:53:21.660789 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:53:21.661283 [debug] [MainThread]: On master: COMMIT
[0m00:53:21.661724 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:21.662118 [debug] [MainThread]: On master: COMMIT
[0m00:53:21.663455 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:53:21.663988 [debug] [MainThread]: On master: Close
[0m00:53:21.667034 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m00:53:21.667701 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m00:53:21.668386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m00:53:21.668890 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m00:53:21.676176 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m00:53:21.681100 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m00:53:21.717775 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m00:53:21.723131 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:53:21.723752 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m00:53:21.724304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:21.734232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:53:21.734936 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:53:21.735457 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m00:53:21.764542 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m00:53:21.774223 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:53:21.774869 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m00:53:21.776871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:53:21.779813 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:53:21.780331 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m00:53:21.781990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:53:21.784127 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:53:21.784668 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m00:53:21.852368 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.067 seconds
[0m00:53:21.867083 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:53:21.867879 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:53:21.868370 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:53:21.889769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m00:53:21.895907 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m00:53:21.901127 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:53:21.901642 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m00:53:21.905816 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:53:21.908318 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m00:53:21.910027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc95d4ae-4626-48ec-b091-49ee410f2ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9e7a3830>]}
[0m00:53:21.910825 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.24s]
[0m00:53:21.911606 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m00:53:21.912887 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m00:53:21.913686 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m00:53:21.914389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m00:53:21.914870 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m00:53:21.917759 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m00:53:21.923625 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m00:53:21.927333 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m00:53:21.933685 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:53:21.934236 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m00:53:21.934680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:21.946735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m00:53:21.947454 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:53:21.948000 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m00:53:21.986654 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.038 seconds
[0m00:53:21.990367 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:53:21.990960 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m00:53:21.992786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:53:21.995818 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:53:21.996388 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m00:53:21.998090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:53:21.999676 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:53:22.000150 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:53:22.000547 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:53:22.010843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m00:53:22.013774 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m00:53:22.014786 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:53:22.015291 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m00:53:22.019684 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:53:22.021472 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m00:53:22.022381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc95d4ae-4626-48ec-b091-49ee410f2ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9e7a3830>]}
[0m00:53:22.023248 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.11s]
[0m00:53:22.024150 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m00:53:22.025209 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m00:53:22.025855 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m00:53:22.026478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m00:53:22.027016 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m00:53:22.030200 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m00:53:22.036321 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m00:53:22.041279 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m00:53:22.048203 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:53:22.048789 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m00:53:22.049213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:22.059612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:53:22.060403 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:53:22.061108 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m00:53:22.088270 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.026 seconds
[0m00:53:22.091968 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:53:22.092511 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m00:53:22.094095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:53:22.096870 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:53:22.097362 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m00:53:22.098994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:53:22.100554 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:53:22.101024 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:53:22.101439 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:53:22.112671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m00:53:22.115478 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m00:53:22.116284 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:53:22.116745 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m00:53:22.121138 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:53:22.122594 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m00:53:22.123354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc95d4ae-4626-48ec-b091-49ee410f2ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9993d700>]}
[0m00:53:22.124202 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.10s]
[0m00:53:22.124919 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m00:53:22.125762 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m00:53:22.126346 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m00:53:22.126977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m00:53:22.127443 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m00:53:22.130390 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m00:53:22.135884 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m00:53:22.139131 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m00:53:22.144908 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:53:22.145454 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m00:53:22.145893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:22.155600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:53:22.156278 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:53:22.156736 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m00:53:22.158860 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:53:22.159385 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m00:53:22.160729 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m00:53:22.164300 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:53:22.165079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc95d4ae-4626-48ec-b091-49ee410f2ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9bb01730>]}
[0m00:53:22.165842 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m00:53:22.166566 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m00:53:22.167313 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m00:53:22.169389 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:22.169874 [debug] [MainThread]: On master: BEGIN
[0m00:53:22.170254 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:53:22.179611 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m00:53:22.180393 [debug] [MainThread]: On master: COMMIT
[0m00:53:22.180901 [debug] [MainThread]: Using postgres connection "master"
[0m00:53:22.181308 [debug] [MainThread]: On master: COMMIT
[0m00:53:22.182584 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:53:22.183052 [debug] [MainThread]: On master: Close
[0m00:53:22.183642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:53:22.184095 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m00:53:22.184588 [info ] [MainThread]: 
[0m00:53:22.185059 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m00:53:22.186233 [debug] [MainThread]: Command end result
[0m00:53:22.210951 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:53:22.215277 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:53:22.223928 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m00:53:22.224500 [info ] [MainThread]: 
[0m00:53:22.225036 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:53:22.225540 [info ] [MainThread]: 
[0m00:53:22.226046 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m00:53:22.226531 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:53:22.226948 [info ] [MainThread]: 
[0m00:53:22.227548 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m00:53:22.227978 [info ] [MainThread]: 
[0m00:53:22.228442 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m00:53:22.229523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4027909, "process_in_blocks": "0", "process_kernel_time": 0.452594, "process_mem_max_rss": "125400", "process_out_blocks": "0", "process_user_time": 2.671897}
[0m00:53:22.230016 [debug] [MainThread]: Command `dbt run` failed at 00:53:22.229927 after 1.40 seconds
[0m00:53:22.230525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9d1df920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b9cdb07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4b99956e10>]}
[0m00:53:22.230968 [debug] [MainThread]: Flushing usage events
[0m00:53:22.891286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:54:28.773081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdf0514e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdf1f23200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdefd81130>]}


============================== 00:54:28.811604 | 521e81c3-51ca-4795-9133-4f2120ea4fe5 ==============================
[0m00:54:28.811604 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:54:28.812327 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'version_check': 'True', 'static_parser': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'quiet': 'False', 'write_json': 'True', 'fail_fast': 'False', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m00:54:28.819114 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:54:28.987468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '521e81c3-51ca-4795-9133-4f2120ea4fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdf01bbbc0>]}
[0m00:54:29.051438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '521e81c3-51ca-4795-9133-4f2120ea4fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdef8e2180>]}
[0m00:54:29.052885 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:54:29.137208 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:54:29.296728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:54:29.297603 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/fires_raw.sql
[0m00:54:29.535455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '521e81c3-51ca-4795-9133-4f2120ea4fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdeddf5b50>]}
[0m00:54:29.601775 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:54:29.606232 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:54:29.642005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '521e81c3-51ca-4795-9133-4f2120ea4fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdef08f680>]}
[0m00:54:29.642603 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m00:54:29.643080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '521e81c3-51ca-4795-9133-4f2120ea4fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdeecd9fa0>]}
[0m00:54:29.644966 [info ] [MainThread]: 
[0m00:54:29.645481 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m00:54:29.645976 [info ] [MainThread]: 
[0m00:54:29.646705 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:54:29.650838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:54:29.699436 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:54:29.700559 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:54:29.701061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:29.712462 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m00:54:29.714096 [debug] [ThreadPool]: On list_postgres: Close
[0m00:54:29.715919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m00:54:29.721711 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:54:29.722254 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m00:54:29.722789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:54:29.732734 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m00:54:29.733708 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:54:29.734251 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m00:54:29.738652 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m00:54:29.740189 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m00:54:29.741618 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m00:54:29.746300 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:29.746810 [debug] [MainThread]: On master: BEGIN
[0m00:54:29.747195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:54:29.757266 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:54:29.757943 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:29.758480 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:54:29.762719 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m00:54:29.764355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '521e81c3-51ca-4795-9133-4f2120ea4fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdeed849b0>]}
[0m00:54:29.764946 [debug] [MainThread]: On master: ROLLBACK
[0m00:54:29.766838 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:29.767465 [debug] [MainThread]: On master: BEGIN
[0m00:54:29.770079 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:54:29.770668 [debug] [MainThread]: On master: COMMIT
[0m00:54:29.771096 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:29.771467 [debug] [MainThread]: On master: COMMIT
[0m00:54:29.772648 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:54:29.773081 [debug] [MainThread]: On master: Close
[0m00:54:29.776069 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m00:54:29.776811 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m00:54:29.777380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m00:54:29.777813 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m00:54:29.785030 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m00:54:29.789567 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m00:54:29.822870 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m00:54:29.827689 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:54:29.828350 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m00:54:29.828826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:29.839220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:54:29.839941 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:54:29.840535 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM public.fires_raw

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m00:54:29.869037 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m00:54:29.878278 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:54:29.878881 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m00:54:29.880583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:54:29.883832 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:54:29.884605 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m00:54:29.886523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:54:29.887919 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:54:29.888537 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM public.fires_raw
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m00:54:29.974276 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.085 seconds
[0m00:54:29.990576 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:54:29.991309 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:54:29.991900 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:54:29.996020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m00:54:30.002325 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m00:54:30.007972 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:54:30.008542 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m00:54:30.012922 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:54:30.015773 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m00:54:30.018134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521e81c3-51ca-4795-9133-4f2120ea4fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdf1ba7b30>]}
[0m00:54:30.019160 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.24s]
[0m00:54:30.019980 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m00:54:30.021162 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m00:54:30.021703 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m00:54:30.022252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m00:54:30.022669 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m00:54:30.025635 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m00:54:30.030740 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m00:54:30.034796 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m00:54:30.040144 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:54:30.040690 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m00:54:30.041107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:30.051031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:54:30.051714 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:54:30.052188 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m00:54:30.088504 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.036 seconds
[0m00:54:30.092152 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:54:30.092702 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m00:54:30.094358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:54:30.097065 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:54:30.097587 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m00:54:30.099090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:54:30.100841 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:54:30.101514 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:54:30.101971 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:54:30.112634 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m00:54:30.115367 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m00:54:30.116406 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:54:30.117019 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m00:54:30.121750 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:54:30.123406 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m00:54:30.124210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521e81c3-51ca-4795-9133-4f2120ea4fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdecdcb3e0>]}
[0m00:54:30.124943 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.10s]
[0m00:54:30.125625 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m00:54:30.126508 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m00:54:30.127064 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m00:54:30.127619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m00:54:30.128051 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m00:54:30.131091 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m00:54:30.136810 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m00:54:30.140644 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m00:54:30.146437 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:54:30.147039 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m00:54:30.147460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:30.157845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:54:30.158536 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:54:30.159128 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m00:54:30.185200 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.025 seconds
[0m00:54:30.188834 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:54:30.189392 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m00:54:30.191093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:54:30.193695 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:54:30.194153 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m00:54:30.195579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:54:30.197230 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:54:30.197693 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:54:30.198070 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:54:30.209883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m00:54:30.214261 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m00:54:30.215123 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:54:30.215576 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m00:54:30.220519 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:54:30.222321 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m00:54:30.223085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521e81c3-51ca-4795-9133-4f2120ea4fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdec1d8110>]}
[0m00:54:30.224020 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.10s]
[0m00:54:30.224774 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m00:54:30.225687 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m00:54:30.226362 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m00:54:30.227215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m00:54:30.227716 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m00:54:30.231036 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m00:54:30.237023 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m00:54:30.240669 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m00:54:30.245970 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:54:30.246548 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m00:54:30.246973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:30.257262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:54:30.257971 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:54:30.258473 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m00:54:30.260623 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:54:30.261219 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m00:54:30.262571 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m00:54:30.266049 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:54:30.266892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521e81c3-51ca-4795-9133-4f2120ea4fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdec1c4d40>]}
[0m00:54:30.267750 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m00:54:30.268568 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m00:54:30.269327 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m00:54:30.271314 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:30.271757 [debug] [MainThread]: On master: BEGIN
[0m00:54:30.272130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:54:30.281682 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m00:54:30.282326 [debug] [MainThread]: On master: COMMIT
[0m00:54:30.282768 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:30.283233 [debug] [MainThread]: On master: COMMIT
[0m00:54:30.284933 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:54:30.285491 [debug] [MainThread]: On master: Close
[0m00:54:30.286180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:54:30.286622 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m00:54:30.287100 [info ] [MainThread]: 
[0m00:54:30.287570 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m00:54:30.288887 [debug] [MainThread]: Command end result
[0m00:54:30.312602 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:54:30.316808 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:54:30.325249 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m00:54:30.325836 [info ] [MainThread]: 
[0m00:54:30.326431 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:54:30.326968 [info ] [MainThread]: 
[0m00:54:30.327554 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m00:54:30.328060 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:54:30.328526 [info ] [MainThread]: 
[0m00:54:30.329018 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m00:54:30.329457 [info ] [MainThread]: 
[0m00:54:30.329895 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m00:54:30.330960 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.618974, "process_in_blocks": "0", "process_kernel_time": 0.354291, "process_mem_max_rss": "129100", "process_out_blocks": "0", "process_user_time": 3.007447}
[0m00:54:30.331441 [debug] [MainThread]: Command `dbt run` failed at 00:54:30.331339 after 1.62 seconds
[0m00:54:30.331880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdf025a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdf18f0ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cdec185a00>]}
[0m00:54:30.332344 [debug] [MainThread]: Flushing usage events
[0m00:54:34.338166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:56:04.971555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713586b64b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71358554cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713585458bf0>]}


============================== 00:56:05.020535 | e0abc0a0-b6ab-467f-8036-1079fdb45d37 ==============================
[0m00:56:05.020535 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:56:05.021296 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'use_colors': 'True', 'log_cache_events': 'False', 'empty': 'False', 'version_check': 'True', 'debug': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False'}
[0m00:56:05.027075 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:56:05.197818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0abc0a0-b6ab-467f-8036-1079fdb45d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135846206e0>]}
[0m00:56:05.257268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0abc0a0-b6ab-467f-8036-1079fdb45d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713584a187a0>]}
[0m00:56:05.258886 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:56:05.345488 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:56:05.499059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:56:05.500011 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/fires_raw.sql
[0m00:56:05.735380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0abc0a0-b6ab-467f-8036-1079fdb45d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135844de8d0>]}
[0m00:56:05.806407 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:56:05.810775 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:56:05.848235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0abc0a0-b6ab-467f-8036-1079fdb45d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135843f8c80>]}
[0m00:56:05.848920 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m00:56:05.849394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0abc0a0-b6ab-467f-8036-1079fdb45d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713583913d40>]}
[0m00:56:05.851786 [info ] [MainThread]: 
[0m00:56:05.852633 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m00:56:05.853217 [info ] [MainThread]: 
[0m00:56:05.853909 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:56:05.857726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:56:05.908035 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:56:05.908737 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:56:05.909248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:05.920901 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m00:56:05.922521 [debug] [ThreadPool]: On list_postgres: Close
[0m00:56:05.924414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m00:56:05.930025 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:56:05.930596 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m00:56:05.931127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:56:05.942036 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m00:56:05.942737 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:56:05.943265 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m00:56:05.947640 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m00:56:05.949296 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m00:56:05.951143 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m00:56:05.956577 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:05.957118 [debug] [MainThread]: On master: BEGIN
[0m00:56:05.957515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:56:05.966802 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m00:56:05.967781 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:05.968486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:56:05.973499 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m00:56:05.974931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0abc0a0-b6ab-467f-8036-1079fdb45d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713584550d70>]}
[0m00:56:05.975542 [debug] [MainThread]: On master: ROLLBACK
[0m00:56:05.976897 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:05.977312 [debug] [MainThread]: On master: BEGIN
[0m00:56:05.979333 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:56:05.979764 [debug] [MainThread]: On master: COMMIT
[0m00:56:05.980179 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:05.980587 [debug] [MainThread]: On master: COMMIT
[0m00:56:05.981744 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:56:05.982230 [debug] [MainThread]: On master: Close
[0m00:56:05.985709 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m00:56:05.986543 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m00:56:05.987199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m00:56:05.987688 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m00:56:05.994274 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m00:56:05.999358 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m00:56:06.032585 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m00:56:06.038325 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:56:06.039036 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m00:56:06.039569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:06.050021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:56:06.051001 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:56:06.051800 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM public.fires_raw

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m00:56:06.089684 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.037 seconds
[0m00:56:06.099275 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:56:06.099947 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m00:56:06.102264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:56:06.107024 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:56:06.107961 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m00:56:06.110289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:56:06.131734 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:56:06.132674 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:56:06.133307 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:56:06.264158 [debug] [Thread-1 (]: SQL status: COMMIT in 0.130 seconds
[0m00:56:06.273467 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m00:56:06.280759 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:56:06.281754 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m00:56:06.287874 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:56:06.291578 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m00:56:06.294118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0abc0a0-b6ab-467f-8036-1079fdb45d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713585af4ef0>]}
[0m00:56:06.295189 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.31s]
[0m00:56:06.296083 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m00:56:06.297146 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m00:56:06.297968 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m00:56:06.298630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m00:56:06.299140 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m00:56:06.304029 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m00:56:06.311178 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m00:56:06.315184 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m00:56:06.322118 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:56:06.322922 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m00:56:06.323444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:06.335099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:56:06.335870 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:56:06.337444 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m00:56:06.391798 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.053 seconds
[0m00:56:06.396522 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:56:06.397266 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m00:56:06.399674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:56:06.403789 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:56:06.404584 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m00:56:06.406591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:56:06.408483 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:56:06.409168 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:56:06.409825 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:56:06.686325 [debug] [Thread-1 (]: SQL status: COMMIT in 0.276 seconds
[0m00:56:06.689308 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m00:56:06.690221 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:56:06.690720 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m00:56:06.881515 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.190 seconds
[0m00:56:06.883275 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m00:56:06.884122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0abc0a0-b6ab-467f-8036-1079fdb45d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713582d002c0>]}
[0m00:56:06.885064 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.59s]
[0m00:56:06.886057 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m00:56:06.887099 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m00:56:06.887845 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m00:56:06.888612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m00:56:06.889193 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m00:56:06.892623 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m00:56:06.898237 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m00:56:06.901984 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m00:56:06.907989 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:56:06.908657 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m00:56:06.909263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:06.919563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:56:06.920450 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:56:06.921155 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m00:56:07.165778 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.244 seconds
[0m00:56:07.169899 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:56:07.170720 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m00:56:07.172849 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:56:07.175996 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:56:07.176485 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m00:56:07.178045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:56:07.179600 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:56:07.180065 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:56:07.180463 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:56:07.361823 [debug] [Thread-1 (]: SQL status: COMMIT in 0.181 seconds
[0m00:56:07.365811 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m00:56:07.366569 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:56:07.367028 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m00:56:07.372575 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:56:07.374352 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m00:56:07.375128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0abc0a0-b6ab-467f-8036-1079fdb45d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713582507770>]}
[0m00:56:07.375980 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.49s]
[0m00:56:07.376858 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m00:56:07.377744 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m00:56:07.378339 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m00:56:07.378897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m00:56:07.379352 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m00:56:07.382616 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m00:56:07.390177 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m00:56:07.394109 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m00:56:07.400410 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:56:07.401020 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m00:56:07.401510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:07.411964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:56:07.412665 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:56:07.413218 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m00:56:07.415469 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:56:07.416128 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m00:56:07.417657 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m00:56:07.421638 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:56:07.422479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0abc0a0-b6ab-467f-8036-1079fdb45d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135829e9040>]}
[0m00:56:07.423308 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m00:56:07.424072 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m00:56:07.424751 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m00:56:07.426726 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:07.427257 [debug] [MainThread]: On master: BEGIN
[0m00:56:07.427653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:56:07.437761 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:56:07.438610 [debug] [MainThread]: On master: COMMIT
[0m00:56:07.439094 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:07.439472 [debug] [MainThread]: On master: COMMIT
[0m00:56:07.440770 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:56:07.441225 [debug] [MainThread]: On master: Close
[0m00:56:07.441780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:07.442152 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m00:56:07.442584 [info ] [MainThread]: 
[0m00:56:07.443121 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m00:56:07.444328 [debug] [MainThread]: Command end result
[0m00:56:07.469346 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:56:07.474246 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:56:07.482995 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m00:56:07.483631 [info ] [MainThread]: 
[0m00:56:07.484257 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:56:07.484780 [info ] [MainThread]: 
[0m00:56:07.485407 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m00:56:07.486090 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:56:07.486817 [info ] [MainThread]: 
[0m00:56:07.487385 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m00:56:07.487825 [info ] [MainThread]: 
[0m00:56:07.488329 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m00:56:07.489645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5962121, "process_in_blocks": "0", "process_kernel_time": 0.450527, "process_mem_max_rss": "128836", "process_out_blocks": "0", "process_user_time": 3.12151}
[0m00:56:07.490159 [debug] [MainThread]: Command `dbt run` failed at 00:56:07.490061 after 2.60 seconds
[0m00:56:07.490695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135883d2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713585af78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713582d01760>]}
[0m00:56:07.491263 [debug] [MainThread]: Flushing usage events
[0m00:56:08.365334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:56:19.971361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71870a6da870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71870a0ca3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71870c8846b0>]}


============================== 00:56:20.018082 | 00119746-42d7-41cb-938a-1bc22e5c9b3f ==============================
[0m00:56:20.018082 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:56:20.018884 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'introspect': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'printer_width': '80', 'partial_parse': 'True', 'debug': 'False', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m00:56:20.024839 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:56:20.209008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00119746-42d7-41cb-938a-1bc22e5c9b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718709a7a390>]}
[0m00:56:20.270591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00119746-42d7-41cb-938a-1bc22e5c9b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718709aba090>]}
[0m00:56:20.271772 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:56:20.362088 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:56:20.512791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:56:20.513446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:56:20.544899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00119746-42d7-41cb-938a-1bc22e5c9b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718709925310>]}
[0m00:56:20.611198 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:56:20.615436 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:56:20.651236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00119746-42d7-41cb-938a-1bc22e5c9b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71870972e360>]}
[0m00:56:20.651947 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m00:56:20.652565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00119746-42d7-41cb-938a-1bc22e5c9b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718708b6e060>]}
[0m00:56:20.654498 [info ] [MainThread]: 
[0m00:56:20.655029 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m00:56:20.655552 [info ] [MainThread]: 
[0m00:56:20.656306 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:56:20.660135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:56:20.710216 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:56:20.711059 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:56:20.711684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:20.723964 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m00:56:20.725550 [debug] [ThreadPool]: On list_postgres: Close
[0m00:56:20.727259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m00:56:20.732745 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:56:20.733450 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m00:56:20.734179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:56:20.744057 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m00:56:20.744737 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:56:20.745202 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m00:56:20.749234 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m00:56:20.750927 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m00:56:20.752839 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m00:56:20.757792 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:20.758301 [debug] [MainThread]: On master: BEGIN
[0m00:56:20.758697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:56:20.770480 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m00:56:20.771213 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:20.771798 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:56:20.776335 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m00:56:20.777875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00119746-42d7-41cb-938a-1bc22e5c9b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718709c89fa0>]}
[0m00:56:20.778476 [debug] [MainThread]: On master: ROLLBACK
[0m00:56:20.779772 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:20.780187 [debug] [MainThread]: On master: BEGIN
[0m00:56:20.782201 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:56:20.782643 [debug] [MainThread]: On master: COMMIT
[0m00:56:20.783104 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:20.783594 [debug] [MainThread]: On master: COMMIT
[0m00:56:20.785347 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:56:20.785814 [debug] [MainThread]: On master: Close
[0m00:56:20.788846 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m00:56:20.789634 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m00:56:20.790415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m00:56:20.790896 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m00:56:20.797328 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m00:56:20.802661 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m00:56:20.835808 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m00:56:20.841166 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:56:20.841700 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m00:56:20.842157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:20.852570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:56:20.853266 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:56:20.853752 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM public.fires_raw

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m00:56:20.881906 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m00:56:20.890969 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:56:20.891652 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m00:56:20.893926 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:56:20.896997 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:56:20.897468 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m00:56:20.899076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:56:20.913844 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:56:20.914571 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:56:20.915035 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:56:21.039095 [debug] [Thread-1 (]: SQL status: COMMIT in 0.124 seconds
[0m00:56:21.045064 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m00:56:21.050849 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:56:21.051806 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m00:56:21.056819 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:56:21.059553 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m00:56:21.061385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00119746-42d7-41cb-938a-1bc22e5c9b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718707b85f70>]}
[0m00:56:21.062147 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.27s]
[0m00:56:21.062909 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m00:56:21.064200 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m00:56:21.064824 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m00:56:21.065387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m00:56:21.065843 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m00:56:21.069178 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m00:56:21.075847 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m00:56:21.079402 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m00:56:21.086045 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:56:21.086643 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m00:56:21.087052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:21.097123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:56:21.097918 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:56:21.098440 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m00:56:21.138188 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.039 seconds
[0m00:56:21.141835 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:56:21.142395 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m00:56:21.144093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:56:21.147657 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:56:21.148200 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m00:56:21.150163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:56:21.152312 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:56:21.153031 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:56:21.153594 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:56:21.275555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.121 seconds
[0m00:56:21.278444 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m00:56:21.279419 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:56:21.279948 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m00:56:21.285431 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m00:56:21.287115 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m00:56:21.287879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00119746-42d7-41cb-938a-1bc22e5c9b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718709a36030>]}
[0m00:56:21.291206 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.22s]
[0m00:56:21.291969 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m00:56:21.293059 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m00:56:21.293644 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m00:56:21.294341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m00:56:21.294865 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m00:56:21.298112 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m00:56:21.304322 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m00:56:21.309629 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m00:56:21.315910 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:56:21.316670 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m00:56:21.317416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:21.327724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:56:21.328563 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:56:21.329181 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m00:56:21.355984 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.026 seconds
[0m00:56:21.359662 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:56:21.360266 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m00:56:21.362172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:56:21.365192 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:56:21.365741 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m00:56:21.367528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:56:21.369682 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:56:21.370299 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:56:21.370878 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:56:21.660977 [debug] [Thread-1 (]: SQL status: COMMIT in 0.289 seconds
[0m00:56:21.663714 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m00:56:21.664601 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:56:21.665048 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m00:56:21.843956 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.178 seconds
[0m00:56:21.845599 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m00:56:21.846295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00119746-42d7-41cb-938a-1bc22e5c9b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71870771ecf0>]}
[0m00:56:21.847024 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.55s]
[0m00:56:21.847691 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m00:56:21.848564 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m00:56:21.849250 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m00:56:21.849856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m00:56:21.850312 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m00:56:21.853602 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m00:56:21.859409 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m00:56:21.862672 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m00:56:21.868489 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:56:21.869080 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m00:56:21.869506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:21.878902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m00:56:21.879675 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:56:21.880155 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m00:56:21.882206 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:56:21.882810 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m00:56:21.884610 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m00:56:21.888108 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:56:21.888885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00119746-42d7-41cb-938a-1bc22e5c9b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718709a35250>]}
[0m00:56:21.889560 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m00:56:21.890300 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m00:56:21.891001 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m00:56:21.893130 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:21.893663 [debug] [MainThread]: On master: BEGIN
[0m00:56:21.894085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:56:21.904270 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:56:21.904985 [debug] [MainThread]: On master: COMMIT
[0m00:56:21.905408 [debug] [MainThread]: Using postgres connection "master"
[0m00:56:21.905838 [debug] [MainThread]: On master: COMMIT
[0m00:56:21.907066 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:56:21.907462 [debug] [MainThread]: On master: Close
[0m00:56:21.908092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:21.908478 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m00:56:21.909011 [info ] [MainThread]: 
[0m00:56:21.909523 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m00:56:21.910732 [debug] [MainThread]: Command end result
[0m00:56:21.936131 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:56:21.940104 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:56:21.948195 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m00:56:21.948793 [info ] [MainThread]: 
[0m00:56:21.949298 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:56:21.949767 [info ] [MainThread]: 
[0m00:56:21.950303 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m00:56:21.950897 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:56:21.951583 [info ] [MainThread]: 
[0m00:56:21.952179 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m00:56:21.952764 [info ] [MainThread]: 
[0m00:56:21.953266 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m00:56:21.954384 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0447812, "process_in_blocks": "0", "process_kernel_time": 0.413133, "process_mem_max_rss": "125272", "process_out_blocks": "0", "process_user_time": 2.800565}
[0m00:56:21.954887 [debug] [MainThread]: Command `dbt run` failed at 00:56:21.954792 after 2.05 seconds
[0m00:56:21.955347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71870ab8ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71870aed7c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71870772b050>]}
[0m00:56:21.955767 [debug] [MainThread]: Flushing usage events
[0m00:56:22.600056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:04.342675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c4330b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c4331d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c42229130>]}


============================== 00:58:04.380927 | ccba3152-fab9-4941-a3e9-2bbd7dad0845 ==============================
[0m00:58:04.380927 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:58:04.381638 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'empty': 'False', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'debug': 'False', 'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error': 'None'}
[0m00:58:04.387224 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:58:04.549534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccba3152-fab9-4941-a3e9-2bbd7dad0845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c4209a360>]}
[0m00:58:04.604349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccba3152-fab9-4941-a3e9-2bbd7dad0845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c42867aa0>]}
[0m00:58:04.605571 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:58:04.689394 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:58:04.834358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:58:04.835200 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/fires_raw.sql
[0m00:58:05.066485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccba3152-fab9-4941-a3e9-2bbd7dad0845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c40fed880>]}
[0m00:58:05.129848 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:58:05.134334 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:58:05.169031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccba3152-fab9-4941-a3e9-2bbd7dad0845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c413c1ac0>]}
[0m00:58:05.169684 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m00:58:05.170212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccba3152-fab9-4941-a3e9-2bbd7dad0845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c40fed3a0>]}
[0m00:58:05.172085 [info ] [MainThread]: 
[0m00:58:05.172615 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m00:58:05.173090 [info ] [MainThread]: 
[0m00:58:05.173825 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:58:05.178015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:58:05.225397 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:58:05.226156 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:58:05.226833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:05.238076 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m00:58:05.239690 [debug] [ThreadPool]: On list_postgres: Close
[0m00:58:05.241350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m00:58:05.246927 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:58:05.247434 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m00:58:05.247889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:58:05.257222 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m00:58:05.257871 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:58:05.258339 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m00:58:05.262163 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m00:58:05.263852 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m00:58:05.265179 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m00:58:05.269945 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:05.270447 [debug] [MainThread]: On master: BEGIN
[0m00:58:05.270855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:58:05.280297 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m00:58:05.280929 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:05.281433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:58:05.286011 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m00:58:05.287439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccba3152-fab9-4941-a3e9-2bbd7dad0845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c4135bc50>]}
[0m00:58:05.288030 [debug] [MainThread]: On master: ROLLBACK
[0m00:58:05.289298 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:05.289745 [debug] [MainThread]: On master: BEGIN
[0m00:58:05.291796 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:58:05.292241 [debug] [MainThread]: On master: COMMIT
[0m00:58:05.292667 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:05.293120 [debug] [MainThread]: On master: COMMIT
[0m00:58:05.294420 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:58:05.294857 [debug] [MainThread]: On master: Close
[0m00:58:05.297720 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m00:58:05.298602 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m00:58:05.299275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m00:58:05.299839 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m00:58:05.306883 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m00:58:05.311895 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m00:58:05.343416 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m00:58:05.348857 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:05.349433 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m00:58:05.349840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:05.359684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:58:05.360402 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:05.361002 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m00:58:05.388943 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.027 seconds
[0m00:58:05.398322 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:05.399004 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m00:58:05.401004 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:58:05.405039 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:05.405592 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m00:58:05.407654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:58:05.410089 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:05.410776 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m00:58:05.440351 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.029 seconds
[0m00:58:05.454496 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:58:05.455167 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:05.455619 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:58:05.473836 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m00:58:05.480067 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m00:58:05.485769 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:05.486350 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m00:58:05.490836 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:58:05.493443 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m00:58:05.495242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccba3152-fab9-4941-a3e9-2bbd7dad0845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c449c7aa0>]}
[0m00:58:05.496153 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.19s]
[0m00:58:05.497127 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m00:58:05.498284 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m00:58:05.498868 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m00:58:05.499454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m00:58:05.499953 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m00:58:05.502951 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m00:58:05.508389 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m00:58:05.511850 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m00:58:05.517321 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:58:05.517890 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m00:58:05.518299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:05.528739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:58:05.529657 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:58:05.530445 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m00:58:05.568815 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.037 seconds
[0m00:58:05.572448 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:58:05.572972 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m00:58:05.574735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:58:05.577674 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:58:05.578180 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m00:58:05.579783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:58:05.581453 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:58:05.581902 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:58:05.582306 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:58:05.592415 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m00:58:05.595112 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m00:58:05.596038 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:58:05.596604 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m00:58:05.601589 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:58:05.603150 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m00:58:05.603879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccba3152-fab9-4941-a3e9-2bbd7dad0845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c3fb6b770>]}
[0m00:58:05.604795 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.10s]
[0m00:58:05.605529 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m00:58:05.606532 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m00:58:05.607161 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m00:58:05.607737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m00:58:05.608165 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m00:58:05.611230 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m00:58:05.616439 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m00:58:05.619987 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m00:58:05.625152 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:58:05.625670 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m00:58:05.626090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:05.635844 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:58:05.636566 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:58:05.637130 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m00:58:05.662251 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.024 seconds
[0m00:58:05.665870 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:58:05.666432 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m00:58:05.668136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:58:05.672281 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:58:05.672805 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m00:58:05.674447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:58:05.676283 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:58:05.676877 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:58:05.677389 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:58:05.689200 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m00:58:05.691971 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m00:58:05.692844 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:58:05.693303 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m00:58:05.697736 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:58:05.699810 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m00:58:05.700593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccba3152-fab9-4941-a3e9-2bbd7dad0845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c3fbc37a0>]}
[0m00:58:05.701368 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.09s]
[0m00:58:05.702167 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m00:58:05.703119 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m00:58:05.703760 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m00:58:05.704388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m00:58:05.704882 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m00:58:05.707905 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m00:58:05.715886 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m00:58:05.720100 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m00:58:05.725674 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:58:05.726238 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m00:58:05.726675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:05.736243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m00:58:05.737037 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:58:05.737616 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m00:58:05.739910 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:58:05.740623 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m00:58:05.742103 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m00:58:05.746073 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:58:05.746768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccba3152-fab9-4941-a3e9-2bbd7dad0845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c3fb7c470>]}
[0m00:58:05.747551 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m00:58:05.748221 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m00:58:05.748819 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m00:58:05.750775 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:05.751199 [debug] [MainThread]: On master: BEGIN
[0m00:58:05.751602 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:58:05.761687 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m00:58:05.762358 [debug] [MainThread]: On master: COMMIT
[0m00:58:05.762848 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:05.763238 [debug] [MainThread]: On master: COMMIT
[0m00:58:05.764398 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:58:05.764886 [debug] [MainThread]: On master: Close
[0m00:58:05.765443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:05.765871 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m00:58:05.766334 [info ] [MainThread]: 
[0m00:58:05.766789 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m00:58:05.768028 [debug] [MainThread]: Command end result
[0m00:58:05.791832 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:58:05.795900 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:58:05.804035 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m00:58:05.804615 [info ] [MainThread]: 
[0m00:58:05.805144 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:58:05.805645 [info ] [MainThread]: 
[0m00:58:05.806181 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m00:58:05.806742 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:58:05.807166 [info ] [MainThread]: 
[0m00:58:05.807680 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m00:58:05.808093 [info ] [MainThread]: 
[0m00:58:05.808573 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m00:58:05.809760 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5260657, "process_in_blocks": "0", "process_kernel_time": 0.466211, "process_mem_max_rss": "128788", "process_out_blocks": "0", "process_user_time": 2.813484}
[0m00:58:05.810358 [debug] [MainThread]: Command `dbt run` failed at 00:58:05.810251 after 1.53 seconds
[0m00:58:05.810810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c422cf020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c4212cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733c3fbcbd40>]}
[0m00:58:05.811235 [debug] [MainThread]: Flushing usage events
[0m00:58:06.642214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:58:26.595072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864f788d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864ee87bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864f7b7800>]}


============================== 00:58:26.640044 | d356a749-644c-40d9-a7b0-44cfc98c7b51 ==============================
[0m00:58:26.640044 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:58:26.640698 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'invocation_command': 'dbt run', 'debug': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False'}
[0m00:58:26.646858 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:58:26.804959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd356a749-644c-40d9-a7b0-44cfc98c7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864e447950>]}
[0m00:58:26.858421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd356a749-644c-40d9-a7b0-44cfc98c7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798650ce69c0>]}
[0m00:58:26.859497 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:58:26.941051 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:58:27.083449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:58:27.084068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:58:27.112295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd356a749-644c-40d9-a7b0-44cfc98c7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864e2b7c80>]}
[0m00:58:27.178445 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:58:27.182661 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:58:27.215136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd356a749-644c-40d9-a7b0-44cfc98c7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864dff0bf0>]}
[0m00:58:27.215857 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m00:58:27.216339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd356a749-644c-40d9-a7b0-44cfc98c7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864d7721b0>]}
[0m00:58:27.218118 [info ] [MainThread]: 
[0m00:58:27.218674 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m00:58:27.219105 [info ] [MainThread]: 
[0m00:58:27.219780 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:58:27.223587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:58:27.271091 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:58:27.271692 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:58:27.272127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:27.283621 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m00:58:27.285193 [debug] [ThreadPool]: On list_postgres: Close
[0m00:58:27.286847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m00:58:27.292076 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:58:27.292550 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m00:58:27.292968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:58:27.302216 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m00:58:27.302829 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:58:27.303236 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m00:58:27.307361 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m00:58:27.308709 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m00:58:27.309927 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m00:58:27.314616 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:27.315291 [debug] [MainThread]: On master: BEGIN
[0m00:58:27.315658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:58:27.325217 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m00:58:27.325770 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:27.326245 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:58:27.330986 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m00:58:27.332346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd356a749-644c-40d9-a7b0-44cfc98c7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864ec51f70>]}
[0m00:58:27.332885 [debug] [MainThread]: On master: ROLLBACK
[0m00:58:27.334323 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:27.334763 [debug] [MainThread]: On master: BEGIN
[0m00:58:27.336727 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:58:27.337136 [debug] [MainThread]: On master: COMMIT
[0m00:58:27.337578 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:27.337980 [debug] [MainThread]: On master: COMMIT
[0m00:58:27.339242 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:58:27.339646 [debug] [MainThread]: On master: Close
[0m00:58:27.342238 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m00:58:27.342952 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m00:58:27.343563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m00:58:27.344010 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m00:58:27.351247 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m00:58:27.356168 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m00:58:27.388413 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m00:58:27.394097 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:27.394675 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m00:58:27.395095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:27.406440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m00:58:27.407123 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:27.407628 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m00:58:27.439694 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.031 seconds
[0m00:58:27.448525 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:27.449166 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m00:58:27.451056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:58:27.453918 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:27.454489 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m00:58:27.455929 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:58:27.458028 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:27.458576 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m00:58:27.536832 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.078 seconds
[0m00:58:27.551259 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:58:27.551940 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:27.552504 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:58:27.571335 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m00:58:27.577710 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m00:58:27.582854 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:58:27.583413 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m00:58:27.588028 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:58:27.590448 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m00:58:27.592234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd356a749-644c-40d9-a7b0-44cfc98c7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798650dd39e0>]}
[0m00:58:27.592998 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.25s]
[0m00:58:27.593706 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m00:58:27.594671 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m00:58:27.595283 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m00:58:27.595841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m00:58:27.596283 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m00:58:27.599186 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m00:58:27.604043 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m00:58:27.607342 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m00:58:27.611915 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:58:27.612354 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m00:58:27.612726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:27.622624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:58:27.623246 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:58:27.623660 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m00:58:27.661705 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.037 seconds
[0m00:58:27.665113 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:58:27.665628 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m00:58:27.667439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:58:27.670116 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:58:27.670569 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m00:58:27.671936 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:58:27.673337 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:58:27.673759 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:58:27.674152 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:58:27.684875 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m00:58:27.687414 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m00:58:27.688186 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:58:27.688599 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m00:58:27.693014 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:58:27.694414 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m00:58:27.695105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd356a749-644c-40d9-a7b0-44cfc98c7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864c7c5dc0>]}
[0m00:58:27.695751 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.10s]
[0m00:58:27.696378 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m00:58:27.697111 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m00:58:27.697908 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m00:58:27.698831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m00:58:27.699352 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m00:58:27.702932 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m00:58:27.708354 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m00:58:27.713300 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m00:58:27.718820 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:58:27.719425 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m00:58:27.719841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:27.729376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m00:58:27.730054 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:58:27.730655 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m00:58:27.758295 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.027 seconds
[0m00:58:27.761726 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:58:27.762204 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m00:58:27.763799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:58:27.766368 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:58:27.766835 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m00:58:27.768355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:58:27.769765 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:58:27.770173 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:58:27.770577 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:58:27.781553 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m00:58:27.784155 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m00:58:27.784975 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:58:27.785405 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m00:58:27.790277 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:58:27.791708 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m00:58:27.792386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd356a749-644c-40d9-a7b0-44cfc98c7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864c34ca40>]}
[0m00:58:27.793020 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.09s]
[0m00:58:27.793660 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m00:58:27.794485 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m00:58:27.795020 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m00:58:27.795535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m00:58:27.795974 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m00:58:27.798825 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m00:58:27.803818 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m00:58:27.807443 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m00:58:27.812173 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:58:27.812673 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m00:58:27.813061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:27.823149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:58:27.823860 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:58:27.824381 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m00:58:27.826430 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:58:27.827033 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m00:58:27.828360 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m00:58:27.831743 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:58:27.832386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd356a749-644c-40d9-a7b0-44cfc98c7b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864e21c230>]}
[0m00:58:27.833079 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m00:58:27.833767 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m00:58:27.834416 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m00:58:27.836354 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:27.836796 [debug] [MainThread]: On master: BEGIN
[0m00:58:27.837187 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:58:27.846438 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m00:58:27.847023 [debug] [MainThread]: On master: COMMIT
[0m00:58:27.847490 [debug] [MainThread]: Using postgres connection "master"
[0m00:58:27.847872 [debug] [MainThread]: On master: COMMIT
[0m00:58:27.849082 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:58:27.849546 [debug] [MainThread]: On master: Close
[0m00:58:27.850131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:27.850616 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m00:58:27.851196 [info ] [MainThread]: 
[0m00:58:27.851680 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m00:58:27.852830 [debug] [MainThread]: Command end result
[0m00:58:27.877020 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:58:27.881174 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:58:27.889317 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m00:58:27.889945 [info ] [MainThread]: 
[0m00:58:27.890536 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:58:27.891036 [info ] [MainThread]: 
[0m00:58:27.891559 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m00:58:27.892072 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:58:27.892480 [info ] [MainThread]: 
[0m00:58:27.892917 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m00:58:27.893344 [info ] [MainThread]: 
[0m00:58:27.893782 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m00:58:27.894916 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3581542, "process_in_blocks": "0", "process_kernel_time": 0.36711, "process_mem_max_rss": "125424", "process_out_blocks": "0", "process_user_time": 2.617659}
[0m00:58:27.895430 [debug] [MainThread]: Command `dbt run` failed at 00:58:27.895328 after 1.36 seconds
[0m00:58:27.895976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864e54a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864e1e09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79864c7c7e30>]}
[0m00:58:27.896455 [debug] [MainThread]: Flushing usage events
[0m00:58:28.554351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:59:37.592057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be32276360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be341c8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be3354a0c0>]}


============================== 00:59:37.638903 | ec58400b-1809-423f-a70c-c010db500813 ==============================
[0m00:59:37.638903 [info ] [MainThread]: Running with dbt=1.10.11
[0m00:59:37.639683 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'indirect_selection': 'eager', 'no_print': 'None', 'invocation_command': 'dbt run'}
[0m00:59:37.645635 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m00:59:37.805410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec58400b-1809-423f-a70c-c010db500813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be313f9a60>]}
[0m00:59:37.859810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec58400b-1809-423f-a70c-c010db500813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be320b0bf0>]}
[0m00:59:37.860978 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:59:37.941848 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m00:59:38.089117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:59:38.089789 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:59:38.119083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec58400b-1809-423f-a70c-c010db500813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be31428f80>]}
[0m00:59:38.185869 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:59:38.190591 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:59:38.225929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec58400b-1809-423f-a70c-c010db500813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be3104c950>]}
[0m00:59:38.226657 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m00:59:38.227248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec58400b-1809-423f-a70c-c010db500813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be30b13aa0>]}
[0m00:59:38.229280 [info ] [MainThread]: 
[0m00:59:38.229827 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m00:59:38.230349 [info ] [MainThread]: 
[0m00:59:38.231139 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:59:38.235067 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:59:38.283750 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:59:38.284417 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:59:38.284901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:59:38.298485 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m00:59:38.300183 [debug] [ThreadPool]: On list_postgres: Close
[0m00:59:38.302267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m00:59:38.308044 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:59:38.308611 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m00:59:38.309044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:59:38.318543 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m00:59:38.319197 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m00:59:38.319698 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m00:59:38.324402 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m00:59:38.325895 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m00:59:38.327207 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m00:59:38.332077 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:38.332606 [debug] [MainThread]: On master: BEGIN
[0m00:59:38.333009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:59:38.342505 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m00:59:38.343137 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:38.343669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m00:59:38.348376 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m00:59:38.349707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec58400b-1809-423f-a70c-c010db500813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be3104c110>]}
[0m00:59:38.350294 [debug] [MainThread]: On master: ROLLBACK
[0m00:59:38.351516 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:38.351935 [debug] [MainThread]: On master: BEGIN
[0m00:59:38.353769 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:59:38.354275 [debug] [MainThread]: On master: COMMIT
[0m00:59:38.354722 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:38.355122 [debug] [MainThread]: On master: COMMIT
[0m00:59:38.356345 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:59:38.356822 [debug] [MainThread]: On master: Close
[0m00:59:38.359762 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m00:59:38.360470 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m00:59:38.361170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m00:59:38.361674 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m00:59:38.369078 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m00:59:38.374289 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m00:59:38.407387 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m00:59:38.412759 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:59:38.413290 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m00:59:38.413726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:38.423588 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:59:38.424456 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:59:38.425102 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m00:59:38.453827 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m00:59:38.463369 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:59:38.464059 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m00:59:38.466022 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:59:38.468828 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:59:38.469319 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m00:59:38.471029 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:59:38.473273 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:59:38.473878 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m00:59:38.504313 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.030 seconds
[0m00:59:38.519972 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:59:38.520709 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:59:38.521340 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m00:59:38.540961 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m00:59:38.547937 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m00:59:38.553762 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m00:59:38.554317 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m00:59:38.558566 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:59:38.561415 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m00:59:38.563237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec58400b-1809-423f-a70c-c010db500813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be33ec3d70>]}
[0m00:59:38.564066 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.20s]
[0m00:59:38.564852 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m00:59:38.565771 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m00:59:38.566420 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m00:59:38.567045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m00:59:38.567571 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m00:59:38.570489 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m00:59:38.577036 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m00:59:38.580797 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m00:59:38.586439 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:59:38.587033 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m00:59:38.587569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:38.599584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m00:59:38.600420 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:59:38.601005 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m00:59:38.638288 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.037 seconds
[0m00:59:38.642285 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:59:38.642946 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m00:59:38.644874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:59:38.647766 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:59:38.648293 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m00:59:38.649855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:59:38.651363 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:59:38.651867 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:59:38.652318 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m00:59:38.663164 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m00:59:38.666019 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m00:59:38.666881 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m00:59:38.667326 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m00:59:38.671733 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:59:38.673259 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m00:59:38.673990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec58400b-1809-423f-a70c-c010db500813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be2fb46510>]}
[0m00:59:38.674729 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.11s]
[0m00:59:38.675406 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m00:59:38.676336 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m00:59:38.676884 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m00:59:38.677501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m00:59:38.677952 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m00:59:38.680967 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m00:59:38.686623 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m00:59:38.691393 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m00:59:38.697546 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:59:38.698113 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m00:59:38.698600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:38.708548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:59:38.709287 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:59:38.709901 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m00:59:38.735853 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.025 seconds
[0m00:59:38.739393 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:59:38.740032 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m00:59:38.741624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:59:38.744590 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:59:38.745090 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m00:59:38.746596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:59:38.748143 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:59:38.748665 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:59:38.749168 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m00:59:38.762082 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m00:59:38.764862 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m00:59:38.765794 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m00:59:38.766320 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m00:59:38.770709 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m00:59:38.772383 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m00:59:38.773188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec58400b-1809-423f-a70c-c010db500813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be2f726870>]}
[0m00:59:38.773974 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.10s]
[0m00:59:38.774704 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m00:59:38.775668 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m00:59:38.776340 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m00:59:38.776932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m00:59:38.777382 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m00:59:38.780310 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m00:59:38.786029 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m00:59:38.789514 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m00:59:38.794984 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:59:38.795576 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m00:59:38.796027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:38.805977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m00:59:38.806909 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m00:59:38.807543 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m00:59:38.809868 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m00:59:38.810485 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m00:59:38.811853 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m00:59:38.815125 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:59:38.815765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec58400b-1809-423f-a70c-c010db500813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be2ff16630>]}
[0m00:59:38.816519 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m00:59:38.817189 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m00:59:38.817900 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m00:59:38.819869 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:38.820303 [debug] [MainThread]: On master: BEGIN
[0m00:59:38.820689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:59:38.830184 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m00:59:38.830832 [debug] [MainThread]: On master: COMMIT
[0m00:59:38.831323 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:38.831786 [debug] [MainThread]: On master: COMMIT
[0m00:59:38.832929 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m00:59:38.833338 [debug] [MainThread]: On master: Close
[0m00:59:38.833869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:59:38.834271 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m00:59:38.834848 [info ] [MainThread]: 
[0m00:59:38.835309 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m00:59:38.836530 [debug] [MainThread]: Command end result
[0m00:59:38.860171 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m00:59:38.864666 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m00:59:38.872524 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m00:59:38.873047 [info ] [MainThread]: 
[0m00:59:38.873606 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:59:38.874131 [info ] [MainThread]: 
[0m00:59:38.874677 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m00:59:38.875183 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m00:59:38.875639 [info ] [MainThread]: 
[0m00:59:38.876080 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m00:59:38.876485 [info ] [MainThread]: 
[0m00:59:38.876935 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m00:59:38.878069 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3458054, "process_in_blocks": "0", "process_kernel_time": 0.426475, "process_mem_max_rss": "125532", "process_out_blocks": "0", "process_user_time": 2.650524}
[0m00:59:38.878567 [debug] [MainThread]: Command `dbt run` failed at 00:59:38.878472 after 1.35 seconds
[0m00:59:38.879025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be31e439b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be2fb46510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73be2f75ad50>]}
[0m00:59:38.879513 [debug] [MainThread]: Flushing usage events
[0m00:59:39.698862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:01:12.231498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999aa19100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999b54c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999b048a40>]}


============================== 01:01:12.280350 | 43195ccf-854b-4bc3-81d7-d94913c0d712 ==============================
[0m01:01:12.280350 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:01:12.280988 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'use_colors': 'True', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'warn_error': 'None', 'static_parser': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'no_print': 'None', 'printer_width': '80'}
[0m01:01:12.287628 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:01:12.455349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43195ccf-854b-4bc3-81d7-d94913c0d712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999b7b7350>]}
[0m01:01:12.510220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43195ccf-854b-4bc3-81d7-d94913c0d712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999b192ea0>]}
[0m01:01:12.511498 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:01:12.595209 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:01:12.740567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:01:12.741174 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:01:12.770435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43195ccf-854b-4bc3-81d7-d94913c0d712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999a677bf0>]}
[0m01:01:12.835648 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:01:12.840447 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:01:12.875521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43195ccf-854b-4bc3-81d7-d94913c0d712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999a384f50>]}
[0m01:01:12.876228 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m01:01:12.876725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43195ccf-854b-4bc3-81d7-d94913c0d712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789999b39d30>]}
[0m01:01:12.878517 [info ] [MainThread]: 
[0m01:01:12.879071 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:01:12.879547 [info ] [MainThread]: 
[0m01:01:12.880238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:01:12.884073 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:01:12.934821 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:01:12.935522 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:01:12.936101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:12.950972 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.015 seconds
[0m01:01:12.952562 [debug] [ThreadPool]: On list_postgres: Close
[0m01:01:12.954735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:01:12.961753 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:01:12.962489 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:01:12.963041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:01:12.973920 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m01:01:12.974642 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:01:12.975140 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:01:12.979667 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m01:01:12.981555 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:01:12.983236 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:01:12.988461 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:12.989165 [debug] [MainThread]: On master: BEGIN
[0m01:01:12.989672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:01:13.000433 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m01:01:13.001113 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:13.001693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:01:13.007515 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:01:13.009212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43195ccf-854b-4bc3-81d7-d94913c0d712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999a8ae900>]}
[0m01:01:13.009948 [debug] [MainThread]: On master: ROLLBACK
[0m01:01:13.011897 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:13.012592 [debug] [MainThread]: On master: BEGIN
[0m01:01:13.015337 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:01:13.015979 [debug] [MainThread]: On master: COMMIT
[0m01:01:13.016476 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:13.016892 [debug] [MainThread]: On master: COMMIT
[0m01:01:13.018242 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:01:13.018728 [debug] [MainThread]: On master: Close
[0m01:01:13.021575 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:01:13.022743 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:01:13.023666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m01:01:13.024199 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:01:13.032128 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:01:13.037411 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:01:13.073354 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:01:13.078752 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:13.079351 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:01:13.079818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:13.090132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:01:13.090881 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:13.091540 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:01:13.121413 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.029 seconds
[0m01:01:13.131769 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:13.132486 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:01:13.134404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:13.137616 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:13.138250 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:01:13.140167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:13.142761 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:13.143496 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:01:13.173887 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.030 seconds
[0m01:01:13.189405 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:01:13.190148 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:13.190676 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:01:13.307472 [debug] [Thread-1 (]: SQL status: COMMIT in 0.116 seconds
[0m01:01:13.314063 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:01:13.320539 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:13.321699 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:01:13.326412 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:01:13.328988 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:01:13.330940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43195ccf-854b-4bc3-81d7-d94913c0d712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999d1b3ad0>]}
[0m01:01:13.331627 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.31s]
[0m01:01:13.332558 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:01:13.333643 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:01:13.334172 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:01:13.334746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m01:01:13.335248 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:01:13.338323 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:01:13.344119 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:01:13.347785 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:01:13.353187 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:13.353663 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:01:13.354122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:13.363903 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:01:13.364604 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:13.365143 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:01:13.402262 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.037 seconds
[0m01:01:13.405769 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:13.406366 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:01:13.408270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:13.411190 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:13.411668 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:01:13.413196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:13.414772 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:01:13.415238 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:13.415659 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:01:13.426446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m01:01:13.429531 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:01:13.430478 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:13.430983 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:01:13.435491 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:01:13.436974 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:01:13.437684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43195ccf-854b-4bc3-81d7-d94913c0d712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999a6b8b90>]}
[0m01:01:13.438697 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.10s]
[0m01:01:13.439491 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:01:13.440440 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:01:13.441095 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:01:13.441732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m01:01:13.442191 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:01:13.445247 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:01:13.450660 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:01:13.455057 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:01:13.460662 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:13.461169 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:01:13.461588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:13.471320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:01:13.472286 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:13.472846 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m01:01:13.498328 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.025 seconds
[0m01:01:13.501915 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:13.502464 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:01:13.504570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:13.507934 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:13.508524 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:01:13.510407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:13.512174 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:01:13.512638 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:13.513107 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:01:13.525688 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m01:01:13.528492 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:01:13.529563 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:13.530085 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:01:13.534889 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:01:13.536589 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:01:13.537406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43195ccf-854b-4bc3-81d7-d94913c0d712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789998bc34a0>]}
[0m01:01:13.538272 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.10s]
[0m01:01:13.539093 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:01:13.540199 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:01:13.540867 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:01:13.541550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m01:01:13.542074 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:01:13.545422 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:01:13.551788 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:01:13.555974 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:01:13.561309 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:01:13.561813 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:01:13.562281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:13.572123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:01:13.572781 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:01:13.573245 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:01:13.575592 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m01:01:13.576238 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:01:13.577695 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:01:13.581085 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:01:13.581717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43195ccf-854b-4bc3-81d7-d94913c0d712', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999a6762d0>]}
[0m01:01:13.582371 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m01:01:13.583025 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:01:13.583727 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:01:13.585791 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:13.586274 [debug] [MainThread]: On master: BEGIN
[0m01:01:13.586686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:01:13.598576 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m01:01:13.599295 [debug] [MainThread]: On master: COMMIT
[0m01:01:13.599772 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:13.600170 [debug] [MainThread]: On master: COMMIT
[0m01:01:13.601283 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:01:13.601689 [debug] [MainThread]: On master: Close
[0m01:01:13.602265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:13.602686 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:01:13.603145 [info ] [MainThread]: 
[0m01:01:13.603665 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m01:01:13.604855 [debug] [MainThread]: Command end result
[0m01:01:13.628908 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:01:13.633009 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:01:13.640811 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:01:13.641367 [info ] [MainThread]: 
[0m01:01:13.641875 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:01:13.642432 [info ] [MainThread]: 
[0m01:01:13.643049 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:01:13.643645 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:01:13.644118 [info ] [MainThread]: 
[0m01:01:13.644631 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:01:13.645091 [info ] [MainThread]: 
[0m01:01:13.645600 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:01:13.646717 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4783618, "process_in_blocks": "0", "process_kernel_time": 0.475881, "process_mem_max_rss": "125268", "process_out_blocks": "0", "process_user_time": 2.702038}
[0m01:01:13.647210 [debug] [MainThread]: Command `dbt run` failed at 01:01:13.647110 after 1.48 seconds
[0m01:01:13.647685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999d4c5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999a786f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78999b7b0530>]}
[0m01:01:13.648185 [debug] [MainThread]: Flushing usage events
[0m01:01:14.451826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:01:26.891588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae401c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae1f8d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae149a270>]}


============================== 01:01:26.940806 | 5cc286a1-3c84-4fbc-acdc-da76f418bc49 ==============================
[0m01:01:26.940806 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:01:26.941669 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'write_json': 'True', 'log_format': 'default', 'partial_parse': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt'}
[0m01:01:26.949515 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:01:27.124954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cc286a1-3c84-4fbc-acdc-da76f418bc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae3d79d90>]}
[0m01:01:27.181517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cc286a1-3c84-4fbc-acdc-da76f418bc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae3c26b40>]}
[0m01:01:27.182777 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:01:27.273432 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:01:27.466344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:01:27.467008 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:01:27.498205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cc286a1-3c84-4fbc-acdc-da76f418bc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae1163aa0>]}
[0m01:01:27.563911 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:01:27.568309 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:01:27.601438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cc286a1-3c84-4fbc-acdc-da76f418bc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae1064590>]}
[0m01:01:27.602067 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m01:01:27.602532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cc286a1-3c84-4fbc-acdc-da76f418bc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae23c7590>]}
[0m01:01:27.604746 [info ] [MainThread]: 
[0m01:01:27.605463 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:01:27.605943 [info ] [MainThread]: 
[0m01:01:27.606625 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:01:27.610616 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:01:27.659548 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:01:27.660223 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:01:27.660719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:27.672505 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m01:01:27.674119 [debug] [ThreadPool]: On list_postgres: Close
[0m01:01:27.675791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:01:27.681197 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:01:27.681721 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:01:27.682103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:01:27.692419 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:01:27.693098 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:01:27.693573 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:01:27.697503 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m01:01:27.698931 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:01:27.700238 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:01:27.705166 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:27.705883 [debug] [MainThread]: On master: BEGIN
[0m01:01:27.706353 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:01:27.715904 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:01:27.716601 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:27.717214 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:01:27.722040 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:01:27.723537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cc286a1-3c84-4fbc-acdc-da76f418bc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae0ea2450>]}
[0m01:01:27.724145 [debug] [MainThread]: On master: ROLLBACK
[0m01:01:27.725603 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:27.726009 [debug] [MainThread]: On master: BEGIN
[0m01:01:27.728019 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:01:27.728487 [debug] [MainThread]: On master: COMMIT
[0m01:01:27.728927 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:27.729323 [debug] [MainThread]: On master: COMMIT
[0m01:01:27.730498 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:01:27.730917 [debug] [MainThread]: On master: Close
[0m01:01:27.733460 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:01:27.734171 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:01:27.734812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m01:01:27.735330 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:01:27.742815 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:01:27.748171 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:01:27.781926 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:01:27.788392 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:27.789071 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:01:27.789585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:27.800755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:01:27.801523 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:27.802118 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:01:27.831433 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.029 seconds
[0m01:01:27.840910 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:27.841607 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:01:27.843454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:27.846704 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:27.847266 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:01:27.848980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:27.851203 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:27.851744 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:01:27.883087 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.031 seconds
[0m01:01:27.898776 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:01:27.899453 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:27.899875 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:01:28.033215 [debug] [Thread-1 (]: SQL status: COMMIT in 0.133 seconds
[0m01:01:28.039930 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:01:28.045761 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:28.046467 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:01:28.051496 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:01:28.055024 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:01:28.057326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cc286a1-3c84-4fbc-acdc-da76f418bc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae3d137a0>]}
[0m01:01:28.058203 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.32s]
[0m01:01:28.059041 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:01:28.060108 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:01:28.060755 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:01:28.061406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m01:01:28.061916 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:01:28.065145 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:01:28.071978 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:01:28.075797 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:01:28.082316 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:28.082916 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:01:28.083372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:28.094781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:01:28.095496 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:28.095987 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:01:28.134663 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.038 seconds
[0m01:01:28.138393 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:28.139156 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:01:28.141262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:01:28.144402 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:28.144932 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:01:28.146784 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:28.148469 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:01:28.148941 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:28.149345 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:01:28.175749 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m01:01:28.178429 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:01:28.179217 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:28.179657 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:01:28.184061 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:01:28.185794 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:01:28.186680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cc286a1-3c84-4fbc-acdc-da76f418bc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3adfd52480>]}
[0m01:01:28.187994 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.13s]
[0m01:01:28.189127 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:01:28.190245 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:01:28.190876 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:01:28.191559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m01:01:28.192034 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:01:28.195278 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:01:28.201090 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:01:28.206174 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:01:28.211849 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:28.212377 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:01:28.212811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:28.224674 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:01:28.225570 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:28.226365 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m01:01:28.255979 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.029 seconds
[0m01:01:28.260076 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:28.261020 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:01:28.263292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:01:28.266679 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:28.267254 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:01:28.269020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:28.270678 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:01:28.271325 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:28.271846 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:01:28.283864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m01:01:28.286916 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:01:28.288151 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:28.288798 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:01:28.294503 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:01:28.296380 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:01:28.297294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cc286a1-3c84-4fbc-acdc-da76f418bc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3adf93db80>]}
[0m01:01:28.298128 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.11s]
[0m01:01:28.298857 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:01:28.299757 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:01:28.300335 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:01:28.300931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m01:01:28.301486 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:01:28.305156 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:01:28.313168 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:01:28.317149 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:01:28.324284 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:01:28.324898 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:01:28.325430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:28.335096 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:01:28.335880 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:01:28.336414 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:01:28.339701 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m01:01:28.340960 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:01:28.342975 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:01:28.346756 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:01:28.347637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cc286a1-3c84-4fbc-acdc-da76f418bc49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae0f040e0>]}
[0m01:01:28.348764 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.05s]
[0m01:01:28.350228 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:01:28.350984 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:01:28.353220 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:28.353815 [debug] [MainThread]: On master: BEGIN
[0m01:01:28.354348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:01:28.365240 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m01:01:28.365922 [debug] [MainThread]: On master: COMMIT
[0m01:01:28.366373 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:28.366874 [debug] [MainThread]: On master: COMMIT
[0m01:01:28.368251 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:01:28.368746 [debug] [MainThread]: On master: Close
[0m01:01:28.369408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:28.369845 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:01:28.370465 [info ] [MainThread]: 
[0m01:01:28.371324 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m01:01:28.373099 [debug] [MainThread]: Command end result
[0m01:01:28.401142 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:01:28.406284 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:01:28.415126 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:01:28.415751 [info ] [MainThread]: 
[0m01:01:28.416459 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:01:28.417081 [info ] [MainThread]: 
[0m01:01:28.417738 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:01:28.418299 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:01:28.419105 [info ] [MainThread]: 
[0m01:01:28.419590 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:01:28.420012 [info ] [MainThread]: 
[0m01:01:28.420635 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:01:28.422124 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5987911, "process_in_blocks": "0", "process_kernel_time": 0.553422, "process_mem_max_rss": "125616", "process_out_blocks": "0", "process_user_time": 3.304606}
[0m01:01:28.423132 [debug] [MainThread]: Command `dbt run` failed at 01:01:28.422924 after 1.60 seconds
[0m01:01:28.423906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae149a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ae1319580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3adf972f90>]}
[0m01:01:28.424606 [debug] [MainThread]: Flushing usage events
[0m01:01:29.058750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:01:41.016893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d363a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d37bc2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d363a120>]}


============================== 01:01:41.060313 | 38ebc4d7-0e63-4de8-9697-c5c524defcbd ==============================
[0m01:01:41.060313 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:01:41.061009 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'static_parser': 'True', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'indirect_selection': 'eager', 'printer_width': '80', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'target_path': 'None', 'empty': 'False'}
[0m01:01:41.067332 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:01:41.236180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38ebc4d7-0e63-4de8-9697-c5c524defcbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d2ce7740>]}
[0m01:01:41.298087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38ebc4d7-0e63-4de8-9697-c5c524defcbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d3fb0fb0>]}
[0m01:01:41.299247 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:01:41.383280 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:01:41.529050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:01:41.529709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:01:41.559105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38ebc4d7-0e63-4de8-9697-c5c524defcbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d22f1040>]}
[0m01:01:41.629826 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:01:41.634437 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:01:41.672184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38ebc4d7-0e63-4de8-9697-c5c524defcbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d230b350>]}
[0m01:01:41.672903 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m01:01:41.673453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38ebc4d7-0e63-4de8-9697-c5c524defcbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d22f1be0>]}
[0m01:01:41.675486 [info ] [MainThread]: 
[0m01:01:41.676054 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:01:41.676519 [info ] [MainThread]: 
[0m01:01:41.677228 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:01:41.681381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:01:41.730506 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:01:41.731191 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:01:41.731629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:01:41.744505 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m01:01:41.746535 [debug] [ThreadPool]: On list_postgres: Close
[0m01:01:41.748435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:01:41.754805 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:01:41.755599 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:01:41.756171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:01:41.766306 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:01:41.766985 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:01:41.767558 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:01:41.771939 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m01:01:41.773615 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:01:41.775130 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:01:41.779948 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:41.780445 [debug] [MainThread]: On master: BEGIN
[0m01:01:41.780817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:01:41.790970 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:01:41.791698 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:41.792253 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:01:41.796952 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:01:41.798661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38ebc4d7-0e63-4de8-9697-c5c524defcbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d1bc1fd0>]}
[0m01:01:41.799314 [debug] [MainThread]: On master: ROLLBACK
[0m01:01:41.800926 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:41.801453 [debug] [MainThread]: On master: BEGIN
[0m01:01:41.803952 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:01:41.804658 [debug] [MainThread]: On master: COMMIT
[0m01:01:41.805185 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:41.805679 [debug] [MainThread]: On master: COMMIT
[0m01:01:41.806957 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:01:41.807384 [debug] [MainThread]: On master: Close
[0m01:01:41.810294 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:01:41.811095 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:01:41.811725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m01:01:41.812197 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:01:41.819463 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:01:41.824752 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:01:41.858981 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:01:41.863735 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:41.864236 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:01:41.864702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:41.874777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:01:41.875564 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:41.876111 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:01:41.904266 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m01:01:41.913456 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:41.914111 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:01:41.916107 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:41.919140 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:41.920093 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:01:41.922385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:41.924710 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:41.925288 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:01:41.953886 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.028 seconds
[0m01:01:41.968417 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:01:41.969212 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:41.969836 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:01:41.987737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m01:01:41.993762 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:01:41.999257 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:01:41.999882 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:01:42.004459 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:01:42.007392 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:01:42.009182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ebc4d7-0e63-4de8-9697-c5c524defcbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d56f77d0>]}
[0m01:01:42.010027 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.20s]
[0m01:01:42.010756 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:01:42.011946 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:01:42.012631 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:01:42.013266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m01:01:42.013844 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:01:42.017057 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:01:42.023920 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:01:42.027867 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:01:42.034421 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:42.035066 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:01:42.035638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:42.045497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:01:42.046668 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:42.047320 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:01:42.082994 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.035 seconds
[0m01:01:42.086919 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:42.087731 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:01:42.089880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:42.093337 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:42.094027 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:01:42.095852 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:42.097533 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:01:42.098036 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:42.098466 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:01:42.111639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m01:01:42.114762 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:01:42.115699 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:01:42.116199 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:01:42.120985 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:01:42.122886 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:01:42.123702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ebc4d7-0e63-4de8-9697-c5c524defcbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d13cd700>]}
[0m01:01:42.126850 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.11s]
[0m01:01:42.127701 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:01:42.128759 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:01:42.129310 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:01:42.129938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m01:01:42.130457 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:01:42.133454 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:01:42.139329 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:01:42.143926 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:01:42.149405 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:42.150043 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:01:42.150521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:42.160269 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:01:42.160978 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:42.161565 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m01:01:42.187327 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.025 seconds
[0m01:01:42.191010 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:42.191641 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:01:42.193489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:42.196343 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:42.196840 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:01:42.198352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:01:42.199896 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:01:42.200363 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:42.200781 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:01:42.234036 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m01:01:42.236897 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:01:42.237942 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:01:42.238451 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:01:42.243204 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:01:42.244749 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:01:42.245516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ebc4d7-0e63-4de8-9697-c5c524defcbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d0f263f0>]}
[0m01:01:42.246349 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.12s]
[0m01:01:42.247036 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:01:42.248000 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:01:42.248658 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:01:42.249342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m01:01:42.249960 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:01:42.253004 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:01:42.258882 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:01:42.262253 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:01:42.267629 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:01:42.268203 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:01:42.268670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:42.278306 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m01:01:42.278938 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:01:42.279392 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:01:42.281438 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m01:01:42.281986 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:01:42.283621 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:01:42.287148 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:01:42.287940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ebc4d7-0e63-4de8-9697-c5c524defcbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d232bce0>]}
[0m01:01:42.288923 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m01:01:42.289735 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:01:42.290438 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:01:42.292495 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:42.292920 [debug] [MainThread]: On master: BEGIN
[0m01:01:42.293292 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:01:42.302904 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:01:42.303600 [debug] [MainThread]: On master: COMMIT
[0m01:01:42.304121 [debug] [MainThread]: Using postgres connection "master"
[0m01:01:42.304533 [debug] [MainThread]: On master: COMMIT
[0m01:01:42.306115 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:01:42.306605 [debug] [MainThread]: On master: Close
[0m01:01:42.307227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:42.307705 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:01:42.308316 [info ] [MainThread]: 
[0m01:01:42.308880 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m01:01:42.310130 [debug] [MainThread]: Command end result
[0m01:01:42.335470 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:01:42.339703 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:01:42.347330 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:01:42.347928 [info ] [MainThread]: 
[0m01:01:42.348443 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:01:42.348899 [info ] [MainThread]: 
[0m01:01:42.349450 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:01:42.350131 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:01:42.350735 [info ] [MainThread]: 
[0m01:01:42.351239 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:01:42.351661 [info ] [MainThread]: 
[0m01:01:42.352092 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:01:42.353520 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3973854, "process_in_blocks": "0", "process_kernel_time": 0.383632, "process_mem_max_rss": "125368", "process_out_blocks": "0", "process_user_time": 2.71773}
[0m01:01:42.354208 [debug] [MainThread]: Command `dbt run` failed at 01:01:42.354102 after 1.40 seconds
[0m01:01:42.354739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d39989b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d4067650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01d0f33d40>]}
[0m01:01:42.355234 [debug] [MainThread]: Flushing usage events
[0m01:01:43.007705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:01.150722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7120984c25a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712097359f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71209772da60>]}


============================== 01:02:01.203841 | 3043f626-ffbe-4ae7-9511-d9a5fe211821 ==============================
[0m01:02:01.203841 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:02:01.205058 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'debug': 'True', 'invocation_command': 'dbt run --debug', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80'}
[0m01:02:01.212677 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:02:01.437604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3043f626-ffbe-4ae7-9511-d9a5fe211821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71209729dfa0>]}
[0m01:02:01.499806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3043f626-ffbe-4ae7-9511-d9a5fe211821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712099aaad20>]}
[0m01:02:01.501316 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:02:01.598865 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:02:01.774516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:01.775425 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:01.809530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3043f626-ffbe-4ae7-9511-d9a5fe211821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712096f19d00>]}
[0m01:02:01.917387 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:02:01.935627 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:02:02.059119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3043f626-ffbe-4ae7-9511-d9a5fe211821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712096d9d0a0>]}
[0m01:02:02.063973 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m01:02:02.067385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3043f626-ffbe-4ae7-9511-d9a5fe211821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71209702a180>]}
[0m01:02:02.073430 [info ] [MainThread]: 
[0m01:02:02.079394 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:02:02.083953 [info ] [MainThread]: 
[0m01:02:02.086571 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:02.094736 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:02:02.252721 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:02:02.260989 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:02:02.262715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:02.304546 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.042 seconds
[0m01:02:02.309093 [debug] [ThreadPool]: On list_postgres: Close
[0m01:02:02.313286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:02:02.329287 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:02:02.331448 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:02:02.333417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:02.363900 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m01:02:02.366609 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:02:02.368067 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:02:02.378495 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m01:02:02.382166 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:02:02.386166 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:02:02.397296 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:02.403454 [debug] [MainThread]: On master: BEGIN
[0m01:02:02.405239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:02.443468 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m01:02:02.445175 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:02.446547 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:02:02.461844 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m01:02:02.464953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3043f626-ffbe-4ae7-9511-d9a5fe211821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712095de66f0>]}
[0m01:02:02.466688 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:02.471589 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:02.473771 [debug] [MainThread]: On master: BEGIN
[0m01:02:02.481567 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m01:02:02.484405 [debug] [MainThread]: On master: COMMIT
[0m01:02:02.486702 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:02.490019 [debug] [MainThread]: On master: COMMIT
[0m01:02:02.494359 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:02:02.497143 [debug] [MainThread]: On master: Close
[0m01:02:02.505041 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:02:02.507066 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:02:02.508930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m01:02:02.511729 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:02:02.529081 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:02:02.541738 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:02:02.606683 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:02:02.614469 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:02.615406 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:02:02.616265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:02.628864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:02:02.629714 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:02.630535 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:02:02.663632 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.032 seconds
[0m01:02:02.675542 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:02.676436 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:02:02.678721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:02.682535 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:02.683410 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:02:02.685514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:02.688289 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:02.689007 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:02:02.734511 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.044 seconds
[0m01:02:02.750707 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:02:02.751581 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:02.752325 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:02:02.761212 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m01:02:02.768864 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:02:02.774911 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:02.775975 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:02:02.786809 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m01:02:02.791550 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:02:02.796010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3043f626-ffbe-4ae7-9511-d9a5fe211821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712099bb7c50>]}
[0m01:02:02.799097 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.29s]
[0m01:02:02.800869 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:02:02.803582 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:02:02.805138 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:02:02.806606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m01:02:02.808253 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:02:02.814638 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:02:02.825174 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:02:02.832056 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:02:02.841128 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:02:02.842366 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:02:02.843296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:02.856325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:02:02.857590 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:02:02.858594 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:02:02.914324 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.055 seconds
[0m01:02:02.920717 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:02:02.921841 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:02:02.924848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:02:02.930523 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:02:02.931589 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:02:02.933790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:02.936444 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:02:02.937345 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:02:02.938033 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:02:02.943346 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m01:02:02.947623 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:02:02.948863 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:02:02.949568 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:02:02.954675 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:02:02.956970 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:02:02.958629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3043f626-ffbe-4ae7-9511-d9a5fe211821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71209553eea0>]}
[0m01:02:02.962942 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.15s]
[0m01:02:02.964558 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:02:02.966217 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:02:02.967569 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:02:02.968480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m01:02:02.969213 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:02:02.974683 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:02:02.983533 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:02:02.990729 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:02:02.999073 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:02:03.000004 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:02:03.000830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:03.014222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:02:03.015343 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:02:03.016375 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m01:02:03.050297 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.033 seconds
[0m01:02:03.054418 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:02:03.055206 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:02:03.058052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:02:03.062668 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:02:03.063417 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:02:03.065602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:03.068169 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:02:03.069184 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:02:03.070228 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:02:03.162481 [debug] [Thread-1 (]: SQL status: COMMIT in 0.091 seconds
[0m01:02:03.168283 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:02:03.170472 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:02:03.172078 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:02:03.185628 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m01:02:03.191113 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:02:03.194462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3043f626-ffbe-4ae7-9511-d9a5fe211821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712095146630>]}
[0m01:02:03.197433 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.23s]
[0m01:02:03.199624 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:02:03.202355 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:02:03.206651 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:02:03.209739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m01:02:03.213525 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:02:03.220099 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:02:03.243119 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:02:03.251631 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:02:03.278396 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:02:03.280358 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:02:03.282930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:03.322790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m01:02:03.324863 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:02:03.328464 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:02:03.339791 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m01:02:03.341518 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:02:03.348000 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:02:03.356182 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:02:03.358692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3043f626-ffbe-4ae7-9511-d9a5fe211821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71209510d970>]}
[0m01:02:03.376700 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.15s]
[0m01:02:03.378831 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:02:03.381323 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:02:03.387353 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:03.393342 [debug] [MainThread]: On master: BEGIN
[0m01:02:03.395323 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:03.434170 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m01:02:03.436107 [debug] [MainThread]: On master: COMMIT
[0m01:02:03.438675 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:03.440254 [debug] [MainThread]: On master: COMMIT
[0m01:02:03.452548 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m01:02:03.454754 [debug] [MainThread]: On master: Close
[0m01:02:03.456670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:03.461515 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:02:03.464725 [info ] [MainThread]: 
[0m01:02:03.467028 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m01:02:03.470186 [debug] [MainThread]: Command end result
[0m01:02:03.559268 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:02:03.572286 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:02:03.598671 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:02:03.600367 [info ] [MainThread]: 
[0m01:02:03.601495 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:02:03.602570 [info ] [MainThread]: 
[0m01:02:03.603740 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:02:03.604993 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:02:03.606182 [info ] [MainThread]: 
[0m01:02:03.607316 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:02:03.611771 [info ] [MainThread]: 
[0m01:02:03.613806 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:02:03.616388 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.533848, "process_in_blocks": "0", "process_kernel_time": 0.455834, "process_mem_max_rss": "125412", "process_out_blocks": "0", "process_user_time": 3.174707}
[0m01:02:03.617715 [debug] [MainThread]: Command `dbt run` failed at 01:02:03.617486 after 2.54 seconds
[0m01:02:03.618841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71209729e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712098504350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712095151d90>]}
[0m01:02:03.619869 [debug] [MainThread]: Flushing usage events
[0m01:02:04.299473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:32.463736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f000ffe300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f0032a0530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f0007b6810>]}


============================== 01:02:32.508736 | cb3247fb-cbb7-4321-b750-c29e71a8f534 ==============================
[0m01:02:32.508736 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:02:32.509619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'invocation_command': 'dbt run --debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'version_check': 'True', 'write_json': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'log_format': 'default', 'no_print': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'debug': 'True', 'empty': 'False'}
[0m01:02:32.515386 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:02:32.680252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb3247fb-cbb7-4321-b750-c29e71a8f534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f000467350>]}
[0m01:02:32.736287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb3247fb-cbb7-4321-b750-c29e71a8f534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f000fa8bc0>]}
[0m01:02:32.737867 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:02:32.821863 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:02:32.973102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:32.973821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:33.004155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb3247fb-cbb7-4321-b750-c29e71a8f534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f000376210>]}
[0m01:02:33.072953 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:02:33.077504 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:02:33.112266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb3247fb-cbb7-4321-b750-c29e71a8f534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f0001a4500>]}
[0m01:02:33.113056 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m01:02:33.113638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb3247fb-cbb7-4321-b750-c29e71a8f534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79efff96e1e0>]}
[0m01:02:33.115853 [info ] [MainThread]: 
[0m01:02:33.116469 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:02:33.116976 [info ] [MainThread]: 
[0m01:02:33.117692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:33.121812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:02:33.172161 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:02:33.173008 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:02:33.173659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:33.184062 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.010 seconds
[0m01:02:33.185840 [debug] [ThreadPool]: On list_postgres: Close
[0m01:02:33.187794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:02:33.194013 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:02:33.194720 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:02:33.195366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:33.205011 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:02:33.205828 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:02:33.206556 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:02:33.211225 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m01:02:33.212932 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:02:33.214454 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:02:33.219334 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:33.219951 [debug] [MainThread]: On master: BEGIN
[0m01:02:33.220440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:33.230834 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:02:33.231686 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:33.232484 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:02:33.237903 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:02:33.239765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb3247fb-cbb7-4321-b750-c29e71a8f534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f0003776b0>]}
[0m01:02:33.240768 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:33.242466 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:33.243155 [debug] [MainThread]: On master: BEGIN
[0m01:02:33.245354 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:02:33.245930 [debug] [MainThread]: On master: COMMIT
[0m01:02:33.246499 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:33.247162 [debug] [MainThread]: On master: COMMIT
[0m01:02:33.248713 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:02:33.249317 [debug] [MainThread]: On master: Close
[0m01:02:33.252381 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:02:33.253264 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:02:33.253906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m01:02:33.254490 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:02:33.262973 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:02:33.268354 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:02:33.303092 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:02:33.309447 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:33.310215 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:02:33.310788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:33.320616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:02:33.321349 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:33.322011 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:02:33.351650 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.029 seconds
[0m01:02:33.361735 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:33.362555 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:02:33.364491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:33.367931 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:33.368753 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:02:33.370920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:33.374085 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:33.374956 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:02:33.406199 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.030 seconds
[0m01:02:33.421970 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:02:33.423019 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:33.423737 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:02:33.469209 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:02:33.471056 [debug] [MainThread]: Postgres adapter: Cancelling query 'model.fires_dbt.fires_raw' (1304)
[0m01:02:33.471902 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:33.472588 [debug] [MainThread]: On master: BEGIN
[0m01:02:33.473132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:33.477216 [debug] [Thread-1 (]: SQL status: COMMIT in 0.052 seconds
[0m01:02:33.484431 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:02:33.490794 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m01:02:33.491624 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:33.492429 [debug] [MainThread]: On master: select pg_terminate_backend(1304)
[0m01:02:33.494969 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m01:02:33.495587 [debug] [MainThread]: Postgres adapter: Cancel query 'model.fires_dbt.fires_raw': (True,)
[0m01:02:33.496124 [error] [MainThread]: CANCEL query model.fires_dbt.fires_raw ......................................... [[31mCANCEL[0m]
[0m01:02:33.496543 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:33.497214 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:33.497802 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:02:33.498825 [debug] [Thread-1 (]: Postgres adapter: Postgres error: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m01:02:33.499328 [debug] [MainThread]: On master: Close
[0m01:02:33.499782 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro drop_relation
[0m01:02:33.500634 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m01:02:33.501274 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:02:33.505937 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m01:02:33.508753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb3247fb-cbb7-4321-b750-c29e71a8f534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79effe9c1d30>]}
[0m01:02:33.510025 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.25s]
[0m01:02:33.511038 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:02:33.511648 [info ] [MainThread]: 
[0m01:02:33.512247 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m01:02:33.512751 [info ] [MainThread]: 
[0m01:02:33.513270 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m01:02:33.513796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:33.514271 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m01:02:33.514743 [info ] [MainThread]: 
[0m01:02:33.515216 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m01:02:33.515802 [error] [MainThread]: Encountered an error:

[0m01:02:33.519029 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/main.py", line 586, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 599, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 536, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 416, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 333, in run_queue
    self.handle_job_queue(pool, callback)
  File "/usr/local/lib/python3.12/site-packages/dbt/task/run.py", line 853, in handle_job_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/graph/queue.py", line 133, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/queue.py", line 171, in get
    self.not_empty.wait()
  File "/usr/local/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m01:02:33.520333 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1162819, "process_in_blocks": "144", "process_kernel_time": 0.400779, "process_mem_max_rss": "125004", "process_out_blocks": "0", "process_user_time": 2.516893}
[0m01:02:33.521081 [debug] [MainThread]: Command `dbt run` failed at 01:02:33.520969 after 1.12 seconds
[0m01:02:33.521674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f000f89c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79effed8cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79effed8cce0>]}
[0m01:02:33.522267 [debug] [MainThread]: Flushing usage events
[0m01:02:34.291804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:38.946045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a0be730b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a0c2d4440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a0b85b860>]}


============================== 01:02:38.993235 | 71c7e8a7-fd3e-44c6-bff9-014c7f3a2263 ==============================
[0m01:02:38.993235 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:02:38.994064 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'False', 'use_colors': 'True', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'debug': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'target_path': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False'}
[0m01:02:39.000617 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:02:39.179438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71c7e8a7-fd3e-44c6-bff9-014c7f3a2263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a0b6cf170>]}
[0m01:02:39.243557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71c7e8a7-fd3e-44c6-bff9-014c7f3a2263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a0b882b10>]}
[0m01:02:39.245052 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:02:39.341118 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:02:39.495714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:39.496542 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:39.531258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71c7e8a7-fd3e-44c6-bff9-014c7f3a2263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a0b470d70>]}
[0m01:02:39.620182 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:02:39.625031 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:02:39.664367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71c7e8a7-fd3e-44c6-bff9-014c7f3a2263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a0b2accb0>]}
[0m01:02:39.665253 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m01:02:39.665879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71c7e8a7-fd3e-44c6-bff9-014c7f3a2263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a0b26ffe0>]}
[0m01:02:39.668147 [info ] [MainThread]: 
[0m01:02:39.668910 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:02:39.669688 [info ] [MainThread]: 
[0m01:02:39.670759 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:39.675774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:02:39.728430 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:02:39.729279 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:02:39.730103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:39.743415 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m01:02:39.745269 [debug] [ThreadPool]: On list_postgres: Close
[0m01:02:39.747643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:02:39.755142 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:02:39.756034 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:02:39.756690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:39.767829 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m01:02:39.769133 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:02:39.774296 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:02:39.781499 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m01:02:39.783869 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:02:39.786077 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:02:39.794037 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:39.795030 [debug] [MainThread]: On master: BEGIN
[0m01:02:39.795934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:39.810149 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m01:02:39.811415 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:39.812439 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:02:39.820902 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m01:02:39.823111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71c7e8a7-fd3e-44c6-bff9-014c7f3a2263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a0ad219a0>]}
[0m01:02:39.824066 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:39.825882 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:39.826721 [debug] [MainThread]: On master: BEGIN
[0m01:02:39.829868 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:02:39.830815 [debug] [MainThread]: On master: COMMIT
[0m01:02:39.831563 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:39.832171 [debug] [MainThread]: On master: COMMIT
[0m01:02:39.833722 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:02:39.834328 [debug] [MainThread]: On master: Close
[0m01:02:39.838034 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:02:39.838996 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:02:39.839886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m01:02:39.840738 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:02:39.852949 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:02:39.859377 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:02:39.898761 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:02:39.905224 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:39.906260 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:02:39.907005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:39.918231 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m01:02:39.932414 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:02:39.938361 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:39.939065 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:02:39.940824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m01:02:39.941463 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:39.942201 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:02:39.971661 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m01:02:39.981804 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:39.982648 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:02:39.984778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:39.988156 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:39.988801 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:02:39.990668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:39.993264 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:39.993930 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:02:40.028469 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.034 seconds
[0m01:02:40.044382 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:02:40.045521 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:40.046544 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:02:40.168486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.121 seconds
[0m01:02:40.171587 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:02:40.172501 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:02:40.173067 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:02:40.177549 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:02:40.180388 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:02:40.182576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c7e8a7-fd3e-44c6-bff9-014c7f3a2263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a0b49c5c0>]}
[0m01:02:40.183514 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.34s]
[0m01:02:40.184397 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:02:40.185661 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:02:40.186308 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:02:40.186974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m01:02:40.187523 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:02:40.190777 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:02:40.196642 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:02:40.201129 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:02:40.207103 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:02:40.207778 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:02:40.208358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:40.219206 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:02:40.220063 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:02:40.220883 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:02:40.259279 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.038 seconds
[0m01:02:40.263442 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:02:40.264290 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:02:40.266231 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:40.269899 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:02:40.270687 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:02:40.272730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:40.275010 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:02:40.275726 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:02:40.276267 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:02:40.284881 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m01:02:40.288148 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:02:40.289325 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:02:40.290094 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:02:40.295031 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:02:40.297419 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:02:40.298827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c7e8a7-fd3e-44c6-bff9-014c7f3a2263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a09dedb50>]}
[0m01:02:40.300061 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.11s]
[0m01:02:40.300951 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:02:40.302203 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:02:40.303237 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:02:40.303904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m01:02:40.304492 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:02:40.309944 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:02:40.317413 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:02:40.321943 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:02:40.328154 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:02:40.329064 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:02:40.329882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:40.340432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:02:40.341280 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:02:40.341972 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m01:02:40.369662 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.027 seconds
[0m01:02:40.373753 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:02:40.374495 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:02:40.376384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:40.379700 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:02:40.380502 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:02:40.382424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:40.384623 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:02:40.385344 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:02:40.386090 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:02:40.391685 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m01:02:40.394702 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:02:40.396000 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:02:40.396795 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:02:40.402506 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:02:40.404513 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:02:40.405411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c7e8a7-fd3e-44c6-bff9-014c7f3a2263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a09df4c80>]}
[0m01:02:40.406300 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.10s]
[0m01:02:40.407142 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:02:40.408135 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:02:40.408898 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:02:40.409566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m01:02:40.410294 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:02:40.414558 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:02:40.421559 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:02:40.425578 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:02:40.432100 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:02:40.433030 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:02:40.433673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:40.444239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:02:40.445144 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:02:40.445859 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:02:40.449011 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m01:02:40.450076 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:02:40.452202 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:02:40.456119 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:02:40.456931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71c7e8a7-fd3e-44c6-bff9-014c7f3a2263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a09df4500>]}
[0m01:02:40.457950 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.05s]
[0m01:02:40.459194 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:02:40.460127 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:02:40.462357 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:40.462927 [debug] [MainThread]: On master: BEGIN
[0m01:02:40.463524 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:40.474043 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:02:40.475050 [debug] [MainThread]: On master: COMMIT
[0m01:02:40.475654 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:40.476207 [debug] [MainThread]: On master: COMMIT
[0m01:02:40.477562 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:02:40.478060 [debug] [MainThread]: On master: Close
[0m01:02:40.478762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:40.479427 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:02:40.480303 [info ] [MainThread]: 
[0m01:02:40.480943 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m01:02:40.482578 [debug] [MainThread]: Command end result
[0m01:02:40.509136 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:02:40.514527 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:02:40.524517 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:02:40.525294 [info ] [MainThread]: 
[0m01:02:40.526051 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:02:40.526795 [info ] [MainThread]: 
[0m01:02:40.527448 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:02:40.528075 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:02:40.528565 [info ] [MainThread]: 
[0m01:02:40.529214 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:02:40.529749 [info ] [MainThread]: 
[0m01:02:40.530436 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:02:40.532147 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6512816, "process_in_blocks": "0", "process_kernel_time": 0.455466, "process_mem_max_rss": "125500", "process_out_blocks": "0", "process_user_time": 2.9942}
[0m01:02:40.533133 [debug] [MainThread]: Command `dbt run` failed at 01:02:40.532919 after 1.65 seconds
[0m01:02:40.534106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a0c148830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a0c718800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700a0b49c5c0>]}
[0m01:02:40.534845 [debug] [MainThread]: Flushing usage events
[0m01:02:41.164672 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:03:10.542988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784462908230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784462baa8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78446324a000>]}


============================== 01:03:10.588745 | 4ba89e23-aeb3-4a38-ab87-5e7324ab7937 ==============================
[0m01:03:10.588745 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:03:10.589574 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'invocation_command': 'dbt run', 'static_parser': 'True', 'no_print': 'None', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'cache_selected_only': 'False', 'empty': 'False'}
[0m01:03:10.595996 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:03:10.759500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ba89e23-aeb3-4a38-ab87-5e7324ab7937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844627a59a0>]}
[0m01:03:10.815670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ba89e23-aeb3-4a38-ab87-5e7324ab7937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844627346e0>]}
[0m01:03:10.816934 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:03:10.901096 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:03:11.047197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:03:11.047813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:03:11.076724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ba89e23-aeb3-4a38-ab87-5e7324ab7937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78446251bf20>]}
[0m01:03:11.143398 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:03:11.148080 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:03:11.185935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ba89e23-aeb3-4a38-ab87-5e7324ab7937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784462074ef0>]}
[0m01:03:11.186885 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m01:03:11.187508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ba89e23-aeb3-4a38-ab87-5e7324ab7937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844623d80e0>]}
[0m01:03:11.189696 [info ] [MainThread]: 
[0m01:03:11.190317 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:03:11.190885 [info ] [MainThread]: 
[0m01:03:11.191563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:03:11.195550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:03:11.247232 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:03:11.247945 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:03:11.248448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:11.259938 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m01:03:11.261488 [debug] [ThreadPool]: On list_postgres: Close
[0m01:03:11.263300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:03:11.268664 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:03:11.269129 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:03:11.269525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:03:11.279802 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:03:11.280484 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:03:11.280981 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:03:11.285198 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m01:03:11.286752 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:03:11.287960 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:03:11.292714 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:11.293272 [debug] [MainThread]: On master: BEGIN
[0m01:03:11.293652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:03:11.303350 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:03:11.304002 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:11.304531 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:03:11.309184 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:03:11.310641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ba89e23-aeb3-4a38-ab87-5e7324ab7937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784461b49c40>]}
[0m01:03:11.311217 [debug] [MainThread]: On master: ROLLBACK
[0m01:03:11.312784 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:11.313332 [debug] [MainThread]: On master: BEGIN
[0m01:03:11.315425 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:03:11.315951 [debug] [MainThread]: On master: COMMIT
[0m01:03:11.316399 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:11.316790 [debug] [MainThread]: On master: COMMIT
[0m01:03:11.317992 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:03:11.318408 [debug] [MainThread]: On master: Close
[0m01:03:11.321342 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:03:11.322224 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:03:11.322902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m01:03:11.323394 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:03:11.330526 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:03:11.335464 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:03:11.368176 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:03:11.373507 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:03:11.374107 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:03:11.374553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:11.384989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:03:11.385681 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:03:11.386370 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:03:11.414986 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m01:03:11.424099 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:03:11.424760 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:03:11.426618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:03:11.429736 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:03:11.430427 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:03:11.432350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:03:11.434731 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:03:11.435246 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:03:11.465109 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.029 seconds
[0m01:03:11.480657 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:03:11.481502 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:03:11.482200 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:03:12.200364 [debug] [Thread-1 (]: SQL status: COMMIT in 0.717 seconds
[0m01:03:12.206469 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:03:12.211464 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:03:12.211995 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:03:12.338193 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.125 seconds
[0m01:03:12.340795 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:03:12.342455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ba89e23-aeb3-4a38-ab87-5e7324ab7937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784464f4fad0>]}
[0m01:03:12.343256 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 1.02s]
[0m01:03:12.343953 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:03:12.344824 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:03:12.345420 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:03:12.346181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m01:03:12.346687 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:03:12.349710 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:03:12.355443 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:03:12.358959 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:03:12.364032 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:03:12.364564 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:03:12.364969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:12.374494 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m01:03:12.375195 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:03:12.375724 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:03:12.544419 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.168 seconds
[0m01:03:12.547870 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:03:12.548392 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:03:12.550179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:03:12.552919 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:03:12.553417 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:03:12.555032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:03:12.556540 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:03:12.556972 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:03:12.557377 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:03:12.834971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.277 seconds
[0m01:03:12.837527 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:03:12.838293 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:03:12.838746 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:03:12.843394 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:03:12.845066 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:03:12.845790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ba89e23-aeb3-4a38-ab87-5e7324ab7937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784460be74d0>]}
[0m01:03:12.846471 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.50s]
[0m01:03:12.847119 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:03:12.847924 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:03:12.848513 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:03:12.849098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m01:03:12.849561 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:03:12.852656 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:03:12.858300 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:03:12.862670 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:03:12.868065 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:03:12.868543 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:03:12.868919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:12.878593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:03:12.879240 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:03:12.879781 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m01:03:12.905886 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.025 seconds
[0m01:03:12.909254 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:03:12.909778 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:03:12.911458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:03:12.914341 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:03:12.914903 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:03:12.916701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:03:12.918302 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:03:12.918780 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:03:12.919219 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:03:13.335521 [debug] [Thread-1 (]: SQL status: COMMIT in 0.416 seconds
[0m01:03:13.338034 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:03:13.338771 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:03:13.339264 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:03:13.482632 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.143 seconds
[0m01:03:13.484406 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:03:13.485143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ba89e23-aeb3-4a38-ab87-5e7324ab7937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784460735670>]}
[0m01:03:13.488600 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.64s]
[0m01:03:13.489397 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:03:13.490237 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:03:13.490959 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:03:13.491759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m01:03:13.492310 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:03:13.495323 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:03:13.501837 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:03:13.505308 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:03:13.510705 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:03:13.511202 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:03:13.511610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:13.521007 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m01:03:13.521691 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:03:13.522197 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:03:13.524411 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m01:03:13.525018 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:03:13.526534 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:03:13.529843 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:03:13.530533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ba89e23-aeb3-4a38-ab87-5e7324ab7937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784462076f30>]}
[0m01:03:13.531198 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m01:03:13.532139 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:03:13.532861 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:03:13.534970 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:13.535389 [debug] [MainThread]: On master: BEGIN
[0m01:03:13.535773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:03:13.545181 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:03:13.545813 [debug] [MainThread]: On master: COMMIT
[0m01:03:13.546280 [debug] [MainThread]: Using postgres connection "master"
[0m01:03:13.546661 [debug] [MainThread]: On master: COMMIT
[0m01:03:13.547794 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:03:13.548197 [debug] [MainThread]: On master: Close
[0m01:03:13.548787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:13.549203 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:03:13.549674 [info ] [MainThread]: 
[0m01:03:13.550195 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m01:03:13.551552 [debug] [MainThread]: Command end result
[0m01:03:13.575256 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:03:13.579114 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:03:13.587402 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:03:13.587886 [info ] [MainThread]: 
[0m01:03:13.588408 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:03:13.588866 [info ] [MainThread]: 
[0m01:03:13.589377 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:03:13.589889 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:03:13.590389 [info ] [MainThread]: 
[0m01:03:13.590932 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:03:13.591397 [info ] [MainThread]: 
[0m01:03:13.591819 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:03:13.592924 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1098917, "process_in_blocks": "0", "process_kernel_time": 0.460375, "process_mem_max_rss": "125112", "process_out_blocks": "0", "process_user_time": 2.662169}
[0m01:03:13.593544 [debug] [MainThread]: Command `dbt run` failed at 01:03:13.593443 after 3.11 seconds
[0m01:03:13.594077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7844620d9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784460742db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784460743e90>]}
[0m01:03:13.594580 [debug] [MainThread]: Flushing usage events
[0m01:03:14.216650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:04:43.598349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd3838f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd37ecda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd37cb8a40>]}


============================== 01:04:43.647870 | a40723a7-d2a2-4635-a3cb-edaab3b72cc8 ==============================
[0m01:04:43.647870 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:04:43.648652 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'empty': 'False', 'quiet': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'cache_selected_only': 'False', 'warn_error': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'write_json': 'True', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'fail_fast': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'version_check': 'True', 'log_format': 'default', 'no_print': 'None', 'target_path': 'None'}
[0m01:04:43.654671 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:04:43.827338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a40723a7-d2a2-4635-a3cb-edaab3b72cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd384da150>]}
[0m01:04:43.885383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a40723a7-d2a2-4635-a3cb-edaab3b72cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd37b55730>]}
[0m01:04:43.886517 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:04:43.978174 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:04:44.166864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:04:44.167758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:04:44.199768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a40723a7-d2a2-4635-a3cb-edaab3b72cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd373c58e0>]}
[0m01:04:44.275961 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:04:44.281715 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:04:44.322479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a40723a7-d2a2-4635-a3cb-edaab3b72cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd370dbdd0>]}
[0m01:04:44.323269 [info ] [MainThread]: Found 4 models, 2 sources, 434 macros
[0m01:04:44.323878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a40723a7-d2a2-4635-a3cb-edaab3b72cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd36afb140>]}
[0m01:04:44.326040 [info ] [MainThread]: 
[0m01:04:44.327325 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:04:44.328088 [info ] [MainThread]: 
[0m01:04:44.328938 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:04:44.333120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:04:44.390219 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:04:44.390918 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:04:44.391445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:44.404906 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m01:04:44.406651 [debug] [ThreadPool]: On list_postgres: Close
[0m01:04:44.408300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:04:44.415112 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:04:44.415754 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:04:44.416210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:44.425803 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:04:44.426813 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:04:44.427467 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:04:44.432640 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m01:04:44.434316 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:04:44.435624 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:04:44.440571 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.441144 [debug] [MainThread]: On master: BEGIN
[0m01:04:44.441541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:04:44.454853 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:04:44.455616 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.456176 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:04:44.462490 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m01:04:44.464611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a40723a7-d2a2-4635-a3cb-edaab3b72cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd373e1dc0>]}
[0m01:04:44.465358 [debug] [MainThread]: On master: ROLLBACK
[0m01:04:44.467307 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.467893 [debug] [MainThread]: On master: BEGIN
[0m01:04:44.470267 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:04:44.471028 [debug] [MainThread]: On master: COMMIT
[0m01:04:44.471567 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.472037 [debug] [MainThread]: On master: COMMIT
[0m01:04:44.473631 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:04:44.474202 [debug] [MainThread]: On master: Close
[0m01:04:44.477977 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:04:44.479144 [info ] [Thread-1 (]: 1 of 4 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:04:44.480127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m01:04:44.480781 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:04:44.491105 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:04:44.498387 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:04:44.537238 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:04:44.543619 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:04:44.544541 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:04:44.545238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:44.557302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:04:44.558091 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:04:44.558627 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:04:44.591554 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.032 seconds
[0m01:04:44.604036 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:04:44.604814 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:04:44.607058 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:04:44.612602 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:04:44.613374 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:04:44.615968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:04:44.619360 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:04:44.620263 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:04:45.058698 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.438 seconds
[0m01:04:45.076451 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:04:45.077449 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:04:45.078207 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:04:45.715323 [debug] [Thread-1 (]: SQL status: COMMIT in 0.636 seconds
[0m01:04:45.723258 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:04:45.730937 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:04:45.732028 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:04:45.737549 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:04:45.740374 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:04:45.742361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a40723a7-d2a2-4635-a3cb-edaab3b72cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd35f24ad0>]}
[0m01:04:45.743251 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 1.26s]
[0m01:04:45.744633 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:04:45.746491 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:04:45.747901 [info ] [Thread-1 (]: 2 of 4 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:04:45.749286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_cleaned)
[0m01:04:45.750207 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:04:45.754021 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:04:45.760882 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:04:45.766524 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:04:45.772608 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:04:45.773180 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:04:45.773649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:45.787411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:04:45.788125 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:04:45.788645 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:04:45.956545 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.167 seconds
[0m01:04:45.960182 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:04:45.960837 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:04:45.963499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:04:45.967296 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:04:45.967972 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:04:45.969830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:04:45.971877 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:04:45.972443 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:04:45.972954 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:04:46.243402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.270 seconds
[0m01:04:46.248420 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:04:46.249970 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:04:46.250617 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:04:46.255467 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:04:46.258408 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:04:46.259430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a40723a7-d2a2-4635-a3cb-edaab3b72cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd35bce7b0>]}
[0m01:04:46.260288 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.51s]
[0m01:04:46.261179 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:04:46.263099 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:04:46.264381 [info ] [Thread-1 (]: 3 of 4 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:04:46.265354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_enriched)
[0m01:04:46.266027 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:04:46.269567 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:04:46.276609 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:04:46.284291 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:04:46.291310 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:04:46.292040 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:04:46.292603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:46.306492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:04:46.307255 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:04:46.307931 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    'Argentina' as country,

    CASE
        WHEN latitude BETWEEN -41.0 AND -33.5 AND longitude BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN latitude BETWEEN -35.0 AND -29.5 AND longitude BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN latitude BETWEEN -34.5 AND -28.0 AND longitude BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN latitude BETWEEN -34.0 AND -30.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN latitude BETWEEN -30.5 AND -27.0 AND longitude BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN latitude BETWEEN -28.0 AND -25.5 AND longitude BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN latitude BETWEEN -28.0 AND -24.0 AND longitude BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN latitude BETWEEN -26.5 AND -24.0 AND longitude BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN latitude BETWEEN -26.0 AND -22.0 AND longitude BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN latitude BETWEEN -24.5 AND -21.5 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN latitude BETWEEN -28.5 AND -26.0 AND longitude BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN latitude BETWEEN -30.0 AND -24.0 AND longitude BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN latitude BETWEEN -29.0 AND -24.0 AND longitude BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN latitude BETWEEN -32.0 AND -28.0 AND longitude BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN latitude BETWEEN -37.0 AND -32.0 AND longitude BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN latitude BETWEEN -35.0 AND -32.0 AND longitude BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN latitude BETWEEN -39.0 AND -35.0 AND longitude BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN latitude BETWEEN -40.0 AND -36.0 AND longitude BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN latitude BETWEEN -42.0 AND -38.0 AND longitude BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN latitude BETWEEN -46.0 AND -42.0 AND longitude BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN latitude BETWEEN -52.0 AND -46.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN latitude BETWEEN -55.0 AND -52.0 AND longitude BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END as province,

    CASE
        WHEN latitude <= -35.0 THEN 'Patagonia'
        WHEN latitude <= -28.0 THEN 'Pampa'
        ELSE 'Norte'
    END as region

FROM "postgres"."public_public"."fires_cleaned" fc
  );
  
[0m01:04:46.405269 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.097 seconds
[0m01:04:46.409020 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:04:46.409641 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:04:46.412190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:04:46.416423 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:04:46.417216 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:04:46.419353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:04:46.421257 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:04:46.421850 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:04:46.422376 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:04:46.816509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.393 seconds
[0m01:04:46.821320 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:04:46.822718 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:04:46.823609 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:04:46.832101 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m01:04:46.834901 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:04:46.836105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a40723a7-d2a2-4635-a3cb-edaab3b72cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd3571aae0>]}
[0m01:04:46.840861 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.57s]
[0m01:04:46.842154 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:04:46.843200 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:04:46.843938 [info ] [Thread-1 (]: 4 of 4 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:04:46.844789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_daily)
[0m01:04:46.845613 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:04:46.851236 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:04:46.859155 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:04:46.866230 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:04:46.874381 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:04:46.875042 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:04:46.875590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:46.889394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:04:46.890270 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:04:46.890905 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp), 2) as avg_frp,
    ROUND(MAX(frp), 2) as max_frp,
    ROUND(SUM(frp), 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence), 1) as avg_confidence,
    ROUND(AVG(data_quality_score), 1) as avg_quality_score,

    ROUND(AVG(brightness), 2) as avg_brightness,
    ROUND(AVG(bright_t31), 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:04:46.894538 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m01:04:46.897764 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:04:46.902245 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:04:46.908033 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:04:46.909457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a40723a7-d2a2-4635-a3cb-edaab3b72cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd35fb3e90>]}
[0m01:04:46.910835 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.06s]
[0m01:04:46.913633 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:04:46.915741 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:04:46.920502 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:46.921560 [debug] [MainThread]: On master: BEGIN
[0m01:04:46.922202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:04:46.936099 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m01:04:46.937013 [debug] [MainThread]: On master: COMMIT
[0m01:04:46.937600 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:46.938197 [debug] [MainThread]: On master: COMMIT
[0m01:04:46.940083 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:04:46.940688 [debug] [MainThread]: On master: Close
[0m01:04:46.941433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:46.942011 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:04:46.942694 [info ] [MainThread]: 
[0m01:04:46.943245 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m01:04:46.944538 [debug] [MainThread]: Command end result
[0m01:04:46.976498 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:04:46.983117 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:04:46.994385 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:04:46.995350 [info ] [MainThread]: 
[0m01:04:46.996670 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:04:46.997781 [info ] [MainThread]: 
[0m01:04:46.998747 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:04:46.999551 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  function round(double precision, integer) does not exist
  LINE 23:     ROUND(AVG(frp), 2) as avg_frp,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:04:47.000243 [info ] [MainThread]: 
[0m01:04:47.001182 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:04:47.001891 [info ] [MainThread]: 
[0m01:04:47.002668 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m01:04:47.003912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4689188, "process_in_blocks": "0", "process_kernel_time": 0.556578, "process_mem_max_rss": "125444", "process_out_blocks": "0", "process_user_time": 3.027148}
[0m01:04:47.004581 [debug] [MainThread]: Command `dbt run` failed at 01:04:47.004412 after 3.47 seconds
[0m01:04:47.005147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd37a42690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd37cb8a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70dd387bb200>]}
[0m01:04:47.005696 [debug] [MainThread]: Flushing usage events
[0m01:04:47.904573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:14.701751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72475c3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72471b63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72475c3230>]}


============================== 01:06:14.746738 | ed70f65c-021d-435d-8aa4-5588c0c4eaad ==============================
[0m01:06:14.746738 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:06:14.747600 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'write_json': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --debug', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'empty': 'False', 'fail_fast': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'True', 'no_print': 'None'}
[0m01:06:14.753886 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:06:14.915344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed70f65c-021d-435d-8aa4-5588c0c4eaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7246bfde50>]}
[0m01:06:14.971297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed70f65c-021d-435d-8aa4-5588c0c4eaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7247432a50>]}
[0m01:06:14.972564 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:06:15.057326 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:06:15.227701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m01:06:15.228645 [debug] [MainThread]: Partial parsing: added file: fires_dbt://models/silver/fires_data_silver.sql
[0m01:06:15.229406 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/silver/fires_enriched.sql
[0m01:06:15.230149 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/silver/fires_daily.sql
[0m01:06:15.479835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed70f65c-021d-435d-8aa4-5588c0c4eaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7246f182c0>]}
[0m01:06:15.596757 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:06:15.604094 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:06:15.651835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed70f65c-021d-435d-8aa4-5588c0c4eaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7246bfeb70>]}
[0m01:06:15.652685 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:06:15.653365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed70f65c-021d-435d-8aa4-5588c0c4eaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b724682eb70>]}
[0m01:06:15.656402 [info ] [MainThread]: 
[0m01:06:15.657243 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:06:15.658067 [info ] [MainThread]: 
[0m01:06:15.659239 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:06:15.664503 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:06:15.718245 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:06:15.718981 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:06:15.719633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:15.734188 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.015 seconds
[0m01:06:15.736112 [debug] [ThreadPool]: On list_postgres: Close
[0m01:06:15.739292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:06:15.746108 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:06:15.746878 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:06:15.747572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:15.758709 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m01:06:15.759575 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:06:15.760335 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:06:15.765584 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m01:06:15.767560 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:06:15.768943 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:06:15.774601 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:15.775416 [debug] [MainThread]: On master: BEGIN
[0m01:06:15.776057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:06:15.787554 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m01:06:15.788833 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:15.789833 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:06:15.796311 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:06:15.798622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed70f65c-021d-435d-8aa4-5588c0c4eaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b724953b020>]}
[0m01:06:15.799392 [debug] [MainThread]: On master: ROLLBACK
[0m01:06:15.801130 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:15.801838 [debug] [MainThread]: On master: BEGIN
[0m01:06:15.804693 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:06:15.805756 [debug] [MainThread]: On master: COMMIT
[0m01:06:15.806450 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:15.807029 [debug] [MainThread]: On master: COMMIT
[0m01:06:15.808590 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:06:15.809235 [debug] [MainThread]: On master: Close
[0m01:06:15.813355 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:06:15.814456 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:06:15.815320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:06:15.816080 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:06:15.824150 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:06:15.830627 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:06:15.867905 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:06:15.875373 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:15.876270 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:06:15.876959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:15.887954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:06:15.889495 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:15.890568 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:06:16.221132 [debug] [Thread-1 (]: SQL status: SELECT 92001 in 0.330 seconds
[0m01:06:16.230159 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:16.230841 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:06:16.232590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:16.246142 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:06:16.246983 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:16.247764 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:06:16.256705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m01:06:16.264271 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:06:16.269746 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:16.270406 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:06:16.272251 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m01:06:16.275116 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:06:16.277221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed70f65c-021d-435d-8aa4-5588c0c4eaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72495f3650>]}
[0m01:06:16.278162 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 92001[0m in 0.46s]
[0m01:06:16.278903 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:06:16.279499 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:06:16.280378 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:06:16.281129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:06:16.281715 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:06:16.285259 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:06:16.291725 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:06:16.296134 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:06:16.301992 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:16.302911 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:06:16.303572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:16.313893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:06:16.314673 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:16.315340 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:06:16.350092 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.034 seconds
[0m01:06:16.353820 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:16.354574 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:06:16.357016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:16.360674 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:16.361437 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:06:16.363398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:16.366553 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:16.367353 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:06:16.401252 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.033 seconds
[0m01:06:16.405093 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:06:16.405923 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:16.406548 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:06:16.418294 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m01:06:16.421398 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:06:16.422764 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:16.423417 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:06:16.428170 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:06:16.430085 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:06:16.431114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed70f65c-021d-435d-8aa4-5588c0c4eaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7244ff22d0>]}
[0m01:06:16.432127 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.15s]
[0m01:06:16.432938 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:06:16.433602 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:06:16.434493 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:06:16.435192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:06:16.435817 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:06:16.439189 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:06:16.446274 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:06:16.450159 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:06:16.456860 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:16.457952 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:06:16.458711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:16.469179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:06:16.470121 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:16.471168 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:06:16.758321 [debug] [Thread-1 (]: SQL status: SELECT 92001 in 0.286 seconds
[0m01:06:16.762651 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:16.763647 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:06:16.766018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:16.770056 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:16.770962 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:06:16.773347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:16.776104 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:06:16.777206 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:16.778221 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:06:16.821127 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m01:06:16.826830 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:06:16.828286 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:16.829000 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:06:16.833735 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:06:16.835542 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:06:16.836423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed70f65c-021d-435d-8aa4-5588c0c4eaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72447ffd10>]}
[0m01:06:16.837282 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 92001[0m in 0.40s]
[0m01:06:16.838120 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:06:16.838878 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:06:16.839911 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:06:16.840979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:06:16.841839 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:06:16.845591 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:06:16.851889 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:06:16.856097 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:06:16.863163 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:16.863966 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:06:16.864564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:16.875131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:06:16.876156 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:16.877061 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:06:16.917731 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.040 seconds
[0m01:06:16.923014 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:16.923928 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:06:16.925807 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:16.929124 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:16.929776 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:06:16.931685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:16.933913 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:06:16.934604 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:16.935201 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:06:16.938353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:06:16.942099 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:06:16.943406 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:16.944199 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:06:16.948994 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:06:16.951023 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:06:16.951930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed70f65c-021d-435d-8aa4-5588c0c4eaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72447b70b0>]}
[0m01:06:16.952911 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.11s]
[0m01:06:16.953771 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:06:16.954386 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:06:16.955248 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:06:16.956129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:06:16.956782 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:06:16.960748 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:06:16.967173 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:06:16.971515 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:06:16.979972 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:06:16.980857 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:06:16.981549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:16.992401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:06:16.993782 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:06:16.994763 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:06:16.997571 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fire_id" does not exist
LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                            ^

[0m01:06:16.998412 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:06:17.000654 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:06:17.004875 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:06:17.005876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed70f65c-021d-435d-8aa4-5588c0c4eaad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72447aff80>]}
[0m01:06:17.007010 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.05s]
[0m01:06:17.008061 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:06:17.009022 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:06:17.011681 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:17.012379 [debug] [MainThread]: On master: BEGIN
[0m01:06:17.012996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:06:17.023398 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:06:17.024522 [debug] [MainThread]: On master: COMMIT
[0m01:06:17.025337 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:17.026290 [debug] [MainThread]: On master: COMMIT
[0m01:06:17.028240 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:06:17.028933 [debug] [MainThread]: On master: Close
[0m01:06:17.029929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:17.032283 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:06:17.033194 [info ] [MainThread]: 
[0m01:06:17.033808 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m01:06:17.035245 [debug] [MainThread]: Command end result
[0m01:06:17.136154 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:06:17.141984 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:06:17.151447 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:06:17.152128 [info ] [MainThread]: 
[0m01:06:17.152741 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:06:17.153321 [info ] [MainThread]: 
[0m01:06:17.153931 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:06:17.154491 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:06:17.154989 [info ] [MainThread]: 
[0m01:06:17.155738 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:06:17.156309 [info ] [MainThread]: 
[0m01:06:17.156844 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:06:17.158342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.519351, "process_in_blocks": "0", "process_kernel_time": 0.408895, "process_mem_max_rss": "128828", "process_out_blocks": "0", "process_user_time": 3.098785}
[0m01:06:17.159210 [debug] [MainThread]: Command `dbt run` failed at 01:06:17.159071 after 2.52 seconds
[0m01:06:17.159947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7249a6e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7246c93860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b72478daf00>]}
[0m01:06:17.160691 [debug] [MainThread]: Flushing usage events
[0m01:06:18.208495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:28.058239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4555a22fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e455567dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4555d0f140>]}


============================== 01:06:28.106422 | ec6a0fea-0307-4585-948c-4620281bb9ab ==============================
[0m01:06:28.106422 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:06:28.107355 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'log_cache_events': 'False', 'debug': 'True', 'partial_parse': 'True', 'version_check': 'True', 'static_parser': 'True', 'introspect': 'True', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --debug', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m01:06:28.113548 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:06:28.278216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec6a0fea-0307-4585-948c-4620281bb9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e455768a4b0>]}
[0m01:06:28.334834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec6a0fea-0307-4585-948c-4620281bb9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45575132c0>]}
[0m01:06:28.336232 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:06:28.418662 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:06:28.575623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:06:28.576336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:06:28.608097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec6a0fea-0307-4585-948c-4620281bb9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4554a778c0>]}
[0m01:06:28.676731 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:06:28.681558 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:06:28.718711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec6a0fea-0307-4585-948c-4620281bb9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4554749550>]}
[0m01:06:28.719676 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:06:28.720564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec6a0fea-0307-4585-948c-4620281bb9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4553f900b0>]}
[0m01:06:28.723025 [info ] [MainThread]: 
[0m01:06:28.723705 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:06:28.724249 [info ] [MainThread]: 
[0m01:06:28.725232 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:06:28.730575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:06:28.783692 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:06:28.784612 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:06:28.785362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:28.797378 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m01:06:28.799155 [debug] [ThreadPool]: On list_postgres: Close
[0m01:06:28.801400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:06:28.808045 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:06:28.808947 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:06:28.809583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:28.819819 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:06:28.821152 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:06:28.822163 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:06:28.827378 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m01:06:28.829260 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:06:28.830781 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:06:28.836600 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:28.838110 [debug] [MainThread]: On master: BEGIN
[0m01:06:28.838998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:06:28.849444 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:06:28.850254 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:28.850980 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:06:28.857819 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m01:06:28.859518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec6a0fea-0307-4585-948c-4620281bb9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45537daf90>]}
[0m01:06:28.860555 [debug] [MainThread]: On master: ROLLBACK
[0m01:06:28.862147 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:28.862692 [debug] [MainThread]: On master: BEGIN
[0m01:06:28.864990 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:06:28.865626 [debug] [MainThread]: On master: COMMIT
[0m01:06:28.866226 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:28.866844 [debug] [MainThread]: On master: COMMIT
[0m01:06:28.868742 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:06:28.869558 [debug] [MainThread]: On master: Close
[0m01:06:28.873517 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:06:28.874530 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:06:28.875265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:06:28.875889 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:06:28.884231 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:06:28.891181 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:06:28.927936 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:06:28.934475 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:28.935270 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:06:28.935906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:28.945593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:06:28.946377 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:28.947170 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:06:29.302825 [debug] [Thread-1 (]: SQL status: SELECT 105144 in 0.355 seconds
[0m01:06:29.312360 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:29.313092 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:06:29.314958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:29.318638 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:29.319479 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:06:29.321964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:29.337428 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:06:29.338358 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:29.339107 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:06:29.370303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m01:06:29.377102 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:06:29.383120 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:29.383961 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:06:29.395678 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m01:06:29.398669 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:06:29.400969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6a0fea-0307-4585-948c-4620281bb9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4557623ec0>]}
[0m01:06:29.402532 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 105144[0m in 0.52s]
[0m01:06:29.403615 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:06:29.404358 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:06:29.405675 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:06:29.406573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:06:29.407334 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:06:29.411580 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:06:29.416990 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:06:29.421640 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:06:29.427847 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:29.428554 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:06:29.429354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:29.440553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:06:29.441646 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:29.442307 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:06:29.470804 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m01:06:29.475115 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:29.475770 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:06:29.477686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:29.481266 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:29.481973 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:06:29.483829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:29.486764 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:29.487690 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:06:29.550868 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.062 seconds
[0m01:06:29.553270 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:06:29.554035 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:29.554642 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:06:29.572423 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m01:06:29.575696 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:06:29.576750 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:29.577331 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:06:29.581843 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:06:29.583830 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:06:29.584928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6a0fea-0307-4585-948c-4620281bb9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4552f3c8c0>]}
[0m01:06:29.586018 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.18s]
[0m01:06:29.586863 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:06:29.587566 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:06:29.588759 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:06:29.589488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:06:29.590138 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:06:29.594878 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:06:29.601454 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:06:29.605717 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:06:29.611929 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:29.612837 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:06:29.613488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:29.623862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:06:29.624773 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:29.625526 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:06:29.884503 [debug] [Thread-1 (]: SQL status: SELECT 105144 in 0.258 seconds
[0m01:06:29.888200 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:29.888854 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:06:29.890630 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:29.893443 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:29.894036 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:06:29.895769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:29.897407 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:06:29.897966 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:29.898474 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:06:29.962500 [debug] [Thread-1 (]: SQL status: COMMIT in 0.063 seconds
[0m01:06:29.965328 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:06:29.966298 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:29.966913 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:06:29.978216 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m01:06:29.980358 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:06:29.981267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6a0fea-0307-4585-948c-4620281bb9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4552b10800>]}
[0m01:06:29.982127 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 105144[0m in 0.39s]
[0m01:06:29.982861 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:06:29.983427 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:06:29.984393 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:06:29.985039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:06:29.985577 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:06:29.988863 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:06:29.995077 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:06:29.998723 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:06:30.005021 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:30.005781 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:06:30.006395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:30.016281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:06:30.017111 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:30.017779 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:06:30.061216 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.042 seconds
[0m01:06:30.066801 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:30.067985 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:06:30.071320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:06:30.076695 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:30.077776 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:06:30.080114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:30.082361 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:06:30.083268 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:30.084132 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:06:30.134400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m01:06:30.139395 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:06:30.141337 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:30.142342 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:06:30.147817 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:06:30.149994 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:06:30.151207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6a0fea-0307-4585-948c-4620281bb9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4553f90110>]}
[0m01:06:30.152241 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.17s]
[0m01:06:30.153221 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:06:30.154095 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:06:30.156855 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:06:30.160118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:06:30.161602 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:06:30.165206 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:06:30.172944 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:06:30.181385 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:06:30.190311 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:06:30.191438 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:06:30.192160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:30.202737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:06:30.203693 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:06:30.204552 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:06:30.207317 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fire_id" does not exist
LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                            ^

[0m01:06:30.208401 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:06:30.210310 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:06:30.214369 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:06:30.215265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6a0fea-0307-4585-948c-4620281bb9ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4552b43d40>]}
[0m01:06:30.216199 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.06s]
[0m01:06:30.217070 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:06:30.217895 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:06:30.220778 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:30.221608 [debug] [MainThread]: On master: BEGIN
[0m01:06:30.222383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:06:30.232714 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:06:30.233463 [debug] [MainThread]: On master: COMMIT
[0m01:06:30.234055 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:30.234682 [debug] [MainThread]: On master: COMMIT
[0m01:06:30.236206 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:06:30.236983 [debug] [MainThread]: On master: Close
[0m01:06:30.237854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:30.238424 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:06:30.239197 [info ] [MainThread]: 
[0m01:06:30.239900 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m01:06:30.241500 [debug] [MainThread]: Command end result
[0m01:06:30.267917 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:06:30.273892 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:06:30.285765 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:06:30.286640 [info ] [MainThread]: 
[0m01:06:30.287711 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:06:30.288688 [info ] [MainThread]: 
[0m01:06:30.289574 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:06:30.290374 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:06:30.290959 [info ] [MainThread]: 
[0m01:06:30.291667 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:06:30.292181 [info ] [MainThread]: 
[0m01:06:30.292722 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:06:30.294065 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2997832, "process_in_blocks": "0", "process_kernel_time": 0.459532, "process_mem_max_rss": "125764", "process_out_blocks": "0", "process_user_time": 2.813139}
[0m01:06:30.294820 [debug] [MainThread]: Command `dbt run` failed at 01:06:30.294643 after 2.30 seconds
[0m01:06:30.295699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45592f3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4554ea1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4556b01580>]}
[0m01:06:30.296517 [debug] [MainThread]: Flushing usage events
[0m01:06:31.115824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:33.725875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c94c36bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c966ac530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c953ee480>]}


============================== 01:06:33.775058 | 7c8249cd-f5cb-4326-b8e2-ae1976a95b66 ==============================
[0m01:06:33.775058 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:06:33.776056 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'empty': 'False', 'printer_width': '80', 'fail_fast': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'no_print': 'None', 'introspect': 'True', 'write_json': 'True', 'quiet': 'False', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False'}
[0m01:06:33.786270 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:06:33.981688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c8249cd-f5cb-4326-b8e2-ae1976a95b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c96e7b620>]}
[0m01:06:34.044807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c8249cd-f5cb-4326-b8e2-ae1976a95b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c95ad1f10>]}
[0m01:06:34.046059 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:06:34.150590 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:06:34.368217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:06:34.369199 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:06:34.452598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c8249cd-f5cb-4326-b8e2-ae1976a95b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c94a7b4d0>]}
[0m01:06:34.676309 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:06:34.688512 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:06:34.816886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c8249cd-f5cb-4326-b8e2-ae1976a95b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c94778320>]}
[0m01:06:34.818181 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:06:34.819192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c8249cd-f5cb-4326-b8e2-ae1976a95b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c94a932c0>]}
[0m01:06:34.823607 [info ] [MainThread]: 
[0m01:06:34.824802 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:06:34.825913 [info ] [MainThread]: 
[0m01:06:34.827220 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:06:34.835691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:06:34.988550 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:06:34.991237 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:06:34.993220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:35.024810 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.031 seconds
[0m01:06:35.027948 [debug] [ThreadPool]: On list_postgres: Close
[0m01:06:35.031755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:06:35.043456 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:06:35.044812 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:06:35.046442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:35.069470 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m01:06:35.070594 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:06:35.071473 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:06:35.079227 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m01:06:35.082437 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:06:35.085419 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:06:35.094718 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:35.095580 [debug] [MainThread]: On master: BEGIN
[0m01:06:35.096230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:06:35.116007 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m01:06:35.117179 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:35.118448 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:06:35.127690 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m01:06:35.130685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c8249cd-f5cb-4326-b8e2-ae1976a95b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c9464f830>]}
[0m01:06:35.132030 [debug] [MainThread]: On master: ROLLBACK
[0m01:06:35.137734 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:35.139077 [debug] [MainThread]: On master: BEGIN
[0m01:06:35.145277 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m01:06:35.146635 [debug] [MainThread]: On master: COMMIT
[0m01:06:35.147560 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:35.148414 [debug] [MainThread]: On master: COMMIT
[0m01:06:35.151020 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:06:35.151807 [debug] [MainThread]: On master: Close
[0m01:06:35.155597 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:06:35.156738 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:06:35.157986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:06:35.158736 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:06:35.169740 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:06:35.176929 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:06:35.230370 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:06:35.240351 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:35.241609 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:06:35.242435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:35.258845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m01:06:35.259902 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:35.260925 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:06:35.574367 [debug] [Thread-1 (]: SQL status: SELECT 118287 in 0.312 seconds
[0m01:06:35.585136 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:35.585977 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:06:35.588087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:35.591997 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:35.592956 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:06:35.594998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:35.611136 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:06:35.611873 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:35.612403 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:06:35.629088 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m01:06:35.635561 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:06:35.641212 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:35.642009 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:06:35.654986 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m01:06:35.657925 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:06:35.660185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c8249cd-f5cb-4326-b8e2-ae1976a95b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c974a3ad0>]}
[0m01:06:35.661316 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 118287[0m in 0.50s]
[0m01:06:35.662197 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:06:35.662864 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:06:35.663601 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:06:35.664238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:06:35.664801 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:06:35.669397 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:06:35.678771 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:06:35.683263 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:06:35.690150 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:35.690889 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:06:35.691629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:35.704975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:06:35.705837 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:35.706468 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:06:35.739483 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.032 seconds
[0m01:06:35.744176 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:35.744925 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:06:35.747084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:06:35.750658 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:35.751268 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:06:35.753365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:35.756058 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:35.756748 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:06:35.787688 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.030 seconds
[0m01:06:35.789882 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:06:35.790681 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:35.791320 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:06:35.843074 [debug] [Thread-1 (]: SQL status: COMMIT in 0.051 seconds
[0m01:06:35.846049 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:06:35.846942 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:35.847445 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:06:35.852776 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:06:35.854675 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:06:35.855499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c8249cd-f5cb-4326-b8e2-ae1976a95b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c931097c0>]}
[0m01:06:35.856319 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.19s]
[0m01:06:35.857108 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:06:35.857782 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:06:35.858639 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:06:35.859393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:06:35.859920 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:06:35.864640 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:06:35.871483 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:06:35.875847 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:06:35.885696 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:35.886772 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:06:35.887837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:35.905671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m01:06:35.906979 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:35.908259 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:06:36.763325 [debug] [Thread-1 (]: SQL status: SELECT 118287 in 0.854 seconds
[0m01:06:36.770147 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:36.771260 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:06:36.775170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m01:06:36.782792 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:36.784084 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:06:36.787736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:06:36.791754 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:06:36.793955 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:36.796958 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:06:36.805570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m01:06:36.812305 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:06:36.814333 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:36.815173 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:06:36.833577 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m01:06:36.836747 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:06:36.838100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c8249cd-f5cb-4326-b8e2-ae1976a95b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c931097c0>]}
[0m01:06:36.839656 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 118287[0m in 0.98s]
[0m01:06:36.841112 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:06:36.842328 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:06:36.844031 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:06:36.845870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:06:36.847752 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:06:36.852191 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:06:36.861493 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:06:36.868263 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:06:36.876813 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:36.878108 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:06:36.879165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:36.892372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:06:36.893915 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:36.895077 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:06:36.938811 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.043 seconds
[0m01:06:36.943170 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:36.943894 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:06:36.946442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:06:36.950892 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:36.951600 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:06:36.953737 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:36.955730 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:06:36.956381 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:36.956991 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:06:36.998032 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m01:06:37.000996 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:06:37.001943 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:37.002462 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:06:37.006977 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:06:37.009387 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:06:37.010600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c8249cd-f5cb-4326-b8e2-ae1976a95b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c931175c0>]}
[0m01:06:37.011696 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.16s]
[0m01:06:37.012762 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:06:37.013473 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:06:37.014233 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:06:37.014908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:06:37.015436 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:06:37.018807 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:06:37.025637 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:06:37.032618 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:06:37.040624 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:06:37.041627 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:06:37.042335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:37.053884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:06:37.054730 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:06:37.055411 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:06:37.058518 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fire_id" does not exist
LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                            ^

[0m01:06:37.059806 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:06:37.063491 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:06:37.069132 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:06:37.070352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c8249cd-f5cb-4326-b8e2-ae1976a95b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c92d67140>]}
[0m01:06:37.071583 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.06s]
[0m01:06:37.072713 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:06:37.073682 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:06:37.076884 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:37.077785 [debug] [MainThread]: On master: BEGIN
[0m01:06:37.078530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:06:37.091005 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m01:06:37.091900 [debug] [MainThread]: On master: COMMIT
[0m01:06:37.092655 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:37.093193 [debug] [MainThread]: On master: COMMIT
[0m01:06:37.095556 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:06:37.096296 [debug] [MainThread]: On master: Close
[0m01:06:37.097202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:37.100815 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:06:37.102038 [info ] [MainThread]: 
[0m01:06:37.102941 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m01:06:37.104932 [debug] [MainThread]: Command end result
[0m01:06:37.139784 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:06:37.145730 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:06:37.156101 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:06:37.156981 [info ] [MainThread]: 
[0m01:06:37.157801 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:06:37.158556 [info ] [MainThread]: 
[0m01:06:37.159349 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:06:37.160203 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:06:37.161129 [info ] [MainThread]: 
[0m01:06:37.162034 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:06:37.162739 [info ] [MainThread]: 
[0m01:06:37.163449 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:06:37.164992 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5249975, "process_in_blocks": "0", "process_kernel_time": 0.542272, "process_mem_max_rss": "125276", "process_out_blocks": "0", "process_user_time": 3.896326}
[0m01:06:37.165803 [debug] [MainThread]: Command `dbt run` failed at 01:06:37.165631 after 3.53 seconds
[0m01:06:37.166703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c94ba1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c950fa000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749c92d39130>]}
[0m01:06:37.167440 [debug] [MainThread]: Flushing usage events
[0m01:06:37.990777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:06:46.669190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a95fa5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a98b6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a9ef0b30>]}


============================== 01:06:46.717852 | 3c26c8db-08a0-4a95-8e2a-51ec0595d828 ==============================
[0m01:06:46.717852 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:06:46.718581 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'version_check': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'invocation_command': 'dbt run', 'empty': 'False', 'fail_fast': 'False'}
[0m01:06:46.726179 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:06:46.895644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c26c8db-08a0-4a95-8e2a-51ec0595d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a8dde5d0>]}
[0m01:06:46.954196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c26c8db-08a0-4a95-8e2a-51ec0595d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663aa0ecda0>]}
[0m01:06:46.955565 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:06:47.043445 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:06:47.205305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:06:47.206047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:06:47.236189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c26c8db-08a0-4a95-8e2a-51ec0595d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a8c62780>]}
[0m01:06:47.303776 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:06:47.308968 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:06:47.345307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c26c8db-08a0-4a95-8e2a-51ec0595d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a8ae5ee0>]}
[0m01:06:47.345985 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:06:47.346493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c26c8db-08a0-4a95-8e2a-51ec0595d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a8501ee0>]}
[0m01:06:47.348373 [info ] [MainThread]: 
[0m01:06:47.348917 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:06:47.349480 [info ] [MainThread]: 
[0m01:06:47.350160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:06:47.354036 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:06:47.406573 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:06:47.407358 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:06:47.407856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:47.421876 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.014 seconds
[0m01:06:47.423854 [debug] [ThreadPool]: On list_postgres: Close
[0m01:06:47.426496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:06:47.432294 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:06:47.432981 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:06:47.433433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:06:47.445766 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m01:06:47.446393 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:06:47.446839 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:06:47.451125 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m01:06:47.452911 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:06:47.455200 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:06:47.462032 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:47.462682 [debug] [MainThread]: On master: BEGIN
[0m01:06:47.463130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:06:47.475861 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:06:47.476626 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:47.477160 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:06:47.482935 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:06:47.485030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c26c8db-08a0-4a95-8e2a-51ec0595d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a8c883b0>]}
[0m01:06:47.485696 [debug] [MainThread]: On master: ROLLBACK
[0m01:06:47.487445 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:47.488580 [debug] [MainThread]: On master: BEGIN
[0m01:06:47.492294 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:06:47.493104 [debug] [MainThread]: On master: COMMIT
[0m01:06:47.493593 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:47.494052 [debug] [MainThread]: On master: COMMIT
[0m01:06:47.495554 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:06:47.496034 [debug] [MainThread]: On master: Close
[0m01:06:47.499600 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:06:47.500501 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:06:47.501144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:06:47.501621 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:06:47.510141 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:06:47.517260 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:06:47.552383 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:06:47.559626 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:47.560262 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:06:47.560788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:47.571393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:06:47.572544 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:47.573444 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:06:47.793863 [debug] [Thread-1 (]: SQL status: SELECT 131430 in 0.219 seconds
[0m01:06:47.804138 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:47.805157 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:06:47.808250 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:06:47.812408 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:47.813048 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:06:47.815003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:47.830461 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:06:47.831291 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:47.831908 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:06:47.922908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.090 seconds
[0m01:06:47.930335 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:06:47.936765 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:06:47.937781 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:06:47.952662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m01:06:47.955841 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:06:47.958527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c26c8db-08a0-4a95-8e2a-51ec0595d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a75b9460>]}
[0m01:06:47.959679 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 131430[0m in 0.46s]
[0m01:06:47.960628 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:06:47.961245 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:06:47.962004 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:06:47.962772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:06:47.963259 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:06:47.966966 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:06:47.973266 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:06:47.977193 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:06:47.982279 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:47.982953 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:06:47.983480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:47.997294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:06:47.998741 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:48.000057 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:06:48.056743 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.055 seconds
[0m01:06:48.063055 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:48.064127 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:06:48.067509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:06:48.075420 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:48.076544 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:06:48.080092 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m01:06:48.083853 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:48.084926 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:06:48.132015 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.046 seconds
[0m01:06:48.134301 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:06:48.135115 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:48.135752 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:06:48.141490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m01:06:48.146309 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:06:48.147617 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:06:48.148287 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:06:48.153594 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:06:48.156924 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:06:48.158503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c26c8db-08a0-4a95-8e2a-51ec0595d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a791a7e0>]}
[0m01:06:48.160347 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.20s]
[0m01:06:48.161907 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:06:48.162877 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:06:48.163835 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:06:48.164634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:06:48.165223 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:06:48.172711 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:06:48.180753 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:06:48.184904 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:06:48.192525 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:48.193317 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:06:48.193798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:48.207616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:06:48.208518 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:48.209373 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:06:48.713164 [debug] [Thread-1 (]: SQL status: SELECT 131430 in 0.503 seconds
[0m01:06:48.717255 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:48.717928 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:06:48.720006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:06:48.724838 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:48.725764 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:06:48.728355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:06:48.730405 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:06:48.731039 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:48.731568 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:06:48.747559 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m01:06:48.751575 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:06:48.752975 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:06:48.753836 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:06:48.774576 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m01:06:48.777902 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:06:48.779723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c26c8db-08a0-4a95-8e2a-51ec0595d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a75f3830>]}
[0m01:06:48.780927 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 131430[0m in 0.61s]
[0m01:06:48.781857 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:06:48.782460 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:06:48.783235 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:06:48.784032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:06:48.784709 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:06:48.787886 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:06:48.796424 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:06:48.800262 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:06:48.808603 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:48.809602 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:06:48.810202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:48.821544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:06:48.822658 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:48.823749 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:06:48.866936 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.042 seconds
[0m01:06:48.870756 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:48.871403 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:06:48.874647 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:06:48.879659 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:48.880714 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:06:48.883145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:06:48.885246 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:06:48.885877 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:48.886353 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:06:48.897971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m01:06:48.900844 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:06:48.901758 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:06:48.902288 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:06:48.908500 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:06:48.910995 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:06:48.912172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c26c8db-08a0-4a95-8e2a-51ec0595d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a7945c10>]}
[0m01:06:48.912997 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.13s]
[0m01:06:48.913770 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:06:48.914310 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:06:48.914891 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:06:48.915530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:06:48.916046 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:06:48.919306 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:06:48.929021 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:06:48.934265 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:06:48.942417 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:06:48.943232 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:06:48.943793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:48.953541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:06:48.954211 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:06:48.954707 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:06:48.958504 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fire_id" does not exist
LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                            ^

[0m01:06:48.959509 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:06:48.961680 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:06:48.965341 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:06:48.965993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c26c8db-08a0-4a95-8e2a-51ec0595d828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a7129d00>]}
[0m01:06:48.966727 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.05s]
[0m01:06:48.967478 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:06:48.968349 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:06:48.970487 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:48.970959 [debug] [MainThread]: On master: BEGIN
[0m01:06:48.971438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:06:48.983235 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m01:06:48.983859 [debug] [MainThread]: On master: COMMIT
[0m01:06:48.984412 [debug] [MainThread]: Using postgres connection "master"
[0m01:06:48.984852 [debug] [MainThread]: On master: COMMIT
[0m01:06:48.986148 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:06:48.986581 [debug] [MainThread]: On master: Close
[0m01:06:48.987177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:48.987581 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:06:48.988082 [info ] [MainThread]: 
[0m01:06:48.988663 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m01:06:48.991549 [debug] [MainThread]: Command end result
[0m01:06:49.019339 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:06:49.024970 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:06:49.034266 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:06:49.034828 [info ] [MainThread]: 
[0m01:06:49.035370 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:06:49.035869 [info ] [MainThread]: 
[0m01:06:49.036405 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:06:49.037045 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:06:49.037524 [info ] [MainThread]: 
[0m01:06:49.038071 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:06:49.038642 [info ] [MainThread]: 
[0m01:06:49.039455 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:06:49.041623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4339523, "process_in_blocks": "0", "process_kernel_time": 0.50799, "process_mem_max_rss": "124852", "process_out_blocks": "0", "process_user_time": 2.847945}
[0m01:06:49.042756 [debug] [MainThread]: Command `dbt run` failed at 01:06:49.042585 after 2.44 seconds
[0m01:06:49.043400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663ad58afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a90312e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7663a9033410>]}
[0m01:06:49.044011 [debug] [MainThread]: Flushing usage events
[0m01:06:49.877948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:07:24.368213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f3437800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f4de0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f4491010>]}


============================== 01:07:24.411035 | 9a14a9b2-cfe6-472d-8def-7000c9aa2a1f ==============================
[0m01:07:24.411035 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:07:24.411782 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --debug', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'target_path': 'None', 'version_check': 'True', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'log_format': 'default', 'debug': 'True', 'log_cache_events': 'False'}
[0m01:07:24.418508 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:07:24.631176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a14a9b2-cfe6-472d-8def-7000c9aa2a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f20adf70>]}
[0m01:07:24.691465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a14a9b2-cfe6-472d-8def-7000c9aa2a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f2ac6ab0>]}
[0m01:07:24.693490 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:07:24.780534 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:07:24.935972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:07:24.936695 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:07:24.967604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a14a9b2-cfe6-472d-8def-7000c9aa2a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f1f5f260>]}
[0m01:07:25.057875 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:07:25.065832 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:07:25.109599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a14a9b2-cfe6-472d-8def-7000c9aa2a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f1cdda60>]}
[0m01:07:25.110617 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:07:25.111260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a14a9b2-cfe6-472d-8def-7000c9aa2a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f16edd00>]}
[0m01:07:25.113989 [info ] [MainThread]: 
[0m01:07:25.115038 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:07:25.115695 [info ] [MainThread]: 
[0m01:07:25.116486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:07:25.120970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:07:25.174870 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:07:25.175573 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:07:25.176199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:25.188390 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m01:07:25.190111 [debug] [ThreadPool]: On list_postgres: Close
[0m01:07:25.192144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:07:25.199370 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:07:25.200377 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:07:25.201108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:07:25.211480 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:07:25.212932 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:07:25.213686 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:07:25.218360 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m01:07:25.220144 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:07:25.221801 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:07:25.227824 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:25.228693 [debug] [MainThread]: On master: BEGIN
[0m01:07:25.229402 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:07:25.240402 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m01:07:25.241136 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:25.241748 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:07:25.247521 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:07:25.249882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a14a9b2-cfe6-472d-8def-7000c9aa2a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f17119a0>]}
[0m01:07:25.250844 [debug] [MainThread]: On master: ROLLBACK
[0m01:07:25.252432 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:25.252964 [debug] [MainThread]: On master: BEGIN
[0m01:07:25.255111 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:07:25.255704 [debug] [MainThread]: On master: COMMIT
[0m01:07:25.256292 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:25.256754 [debug] [MainThread]: On master: COMMIT
[0m01:07:25.257961 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:07:25.258464 [debug] [MainThread]: On master: Close
[0m01:07:25.261585 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:07:25.262698 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:07:25.263635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:07:25.264597 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:07:25.272099 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:07:25.278555 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:07:25.313707 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:07:25.320255 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:07:25.320900 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:07:25.321478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:25.331066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:07:25.332021 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:07:25.332898 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:07:25.625117 [debug] [Thread-1 (]: SQL status: SELECT 144573 in 0.291 seconds
[0m01:07:25.635192 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:07:25.636081 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:07:25.637930 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:07:25.641033 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:07:25.641695 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:07:25.643376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:07:25.658602 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:07:25.659582 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:07:25.660341 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:07:25.683997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m01:07:25.690414 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:07:25.696381 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:07:25.697212 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:07:25.709800 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m01:07:25.713365 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:07:25.716095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a14a9b2-cfe6-472d-8def-7000c9aa2a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f1f5f1d0>]}
[0m01:07:25.717261 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 144573[0m in 0.45s]
[0m01:07:25.718136 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:07:25.718846 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:07:25.719787 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:07:25.720575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:07:25.721169 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:07:25.725167 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:07:25.731488 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:07:25.736096 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:07:25.741767 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:07:25.742544 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:07:25.743169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:25.753839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:07:25.754666 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:07:25.755307 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:07:25.784520 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m01:07:25.788609 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:07:25.789267 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:07:25.791071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:07:25.794584 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:07:25.795443 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:07:25.797602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:07:25.801143 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:07:25.802144 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:07:25.832572 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.029 seconds
[0m01:07:25.834976 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:07:25.835679 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:07:25.836232 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:07:25.854628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m01:07:25.857775 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:07:25.858806 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:07:25.859453 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:07:25.864587 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:07:25.867072 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:07:25.868143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a14a9b2-cfe6-472d-8def-7000c9aa2a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f0b51e50>]}
[0m01:07:25.869140 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.15s]
[0m01:07:25.869957 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:07:25.870613 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:07:25.871519 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:07:25.872139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:07:25.872682 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:07:25.877408 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:07:25.884777 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:07:25.888890 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:07:25.896044 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:07:25.896959 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:07:25.897698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:25.908505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:07:25.909535 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:07:25.910491 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:07:26.326311 [debug] [Thread-1 (]: SQL status: SELECT 144573 in 0.415 seconds
[0m01:07:26.330118 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:07:26.330788 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:07:26.332624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:07:26.336342 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:07:26.337040 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:07:26.338844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:07:26.340510 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:07:26.341059 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:07:26.341685 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:07:26.348403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:07:26.351903 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:07:26.352986 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:07:26.353745 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:07:26.366994 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m01:07:26.369457 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:07:26.370393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a14a9b2-cfe6-472d-8def-7000c9aa2a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f1711e20>]}
[0m01:07:26.371445 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 144573[0m in 0.50s]
[0m01:07:26.372550 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:07:26.373222 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:07:26.374153 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:07:26.374806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:07:26.375395 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:07:26.378675 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:07:26.385547 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:07:26.389635 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:07:26.395905 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:07:26.396742 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:07:26.397432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:26.407857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:07:26.408660 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:07:26.409357 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:07:26.447882 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.038 seconds
[0m01:07:26.452136 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:07:26.452916 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:07:26.454858 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:07:26.458018 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:07:26.458609 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:07:26.460449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:07:26.462455 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:07:26.463252 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:07:26.464098 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:07:26.530351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.065 seconds
[0m01:07:26.533506 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:07:26.534490 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:07:26.535115 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:07:26.539751 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:07:26.541866 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:07:26.542904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a14a9b2-cfe6-472d-8def-7000c9aa2a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f07003e0>]}
[0m01:07:26.543847 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.17s]
[0m01:07:26.544830 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:07:26.545502 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:07:26.546316 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:07:26.547063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:07:26.547663 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:07:26.551124 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:07:26.557635 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:07:26.563631 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:07:26.570675 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:07:26.571585 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:07:26.572284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:07:26.582230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:07:26.583186 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:07:26.584002 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:07:26.586394 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fire_id" does not exist
LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                            ^

[0m01:07:26.587260 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:07:26.589096 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:07:26.593259 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:07:26.594118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a14a9b2-cfe6-472d-8def-7000c9aa2a1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f0333830>]}
[0m01:07:26.595303 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.05s]
[0m01:07:26.596242 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:07:26.597224 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:07:26.600116 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:26.600789 [debug] [MainThread]: On master: BEGIN
[0m01:07:26.601410 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:07:26.611546 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:07:26.612515 [debug] [MainThread]: On master: COMMIT
[0m01:07:26.613570 [debug] [MainThread]: Using postgres connection "master"
[0m01:07:26.614236 [debug] [MainThread]: On master: COMMIT
[0m01:07:26.615854 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:07:26.616487 [debug] [MainThread]: On master: Close
[0m01:07:26.617324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:26.617827 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:07:26.618465 [info ] [MainThread]: 
[0m01:07:26.618984 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m01:07:26.620387 [debug] [MainThread]: Command end result
[0m01:07:26.645330 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:07:26.650707 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:07:26.659855 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:07:26.660491 [info ] [MainThread]: 
[0m01:07:26.661106 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:07:26.661780 [info ] [MainThread]: 
[0m01:07:26.662592 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:07:26.663230 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:07:26.663837 [info ] [MainThread]: 
[0m01:07:26.664626 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:07:26.665229 [info ] [MainThread]: 
[0m01:07:26.665761 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:07:26.667153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3611045, "process_in_blocks": "0", "process_kernel_time": 0.414169, "process_mem_max_rss": "125564", "process_out_blocks": "0", "process_user_time": 2.810724}
[0m01:07:26.667886 [debug] [MainThread]: Command `dbt run` failed at 01:07:26.667750 after 2.36 seconds
[0m01:07:26.668475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f2b2dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f3487920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f2aecf80>]}
[0m01:07:26.669018 [debug] [MainThread]: Flushing usage events
[0m01:07:27.658870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:09:52.173641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeaed45d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aead43e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeafbf8410>]}


============================== 01:09:52.218868 | 1dfc6573-5b0d-4b54-bfdd-9f033e50192e ==============================
[0m01:09:52.218868 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:09:52.219581 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'fail_fast': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'empty': 'False', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'indirect_selection': 'eager'}
[0m01:09:52.225516 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:09:52.386728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dfc6573-5b0d-4b54-bfdd-9f033e50192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeacff7320>]}
[0m01:09:52.442071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dfc6573-5b0d-4b54-bfdd-9f033e50192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aead43cfb0>]}
[0m01:09:52.443388 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:09:52.529336 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:09:52.683818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:09:52.684482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:09:52.713490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dfc6573-5b0d-4b54-bfdd-9f033e50192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeacd977d0>]}
[0m01:09:52.778823 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:09:52.783535 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:09:52.818547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dfc6573-5b0d-4b54-bfdd-9f033e50192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeaca72780>]}
[0m01:09:52.819210 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:09:52.819730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dfc6573-5b0d-4b54-bfdd-9f033e50192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeac4efe30>]}
[0m01:09:52.821687 [info ] [MainThread]: 
[0m01:09:52.822217 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:09:52.822722 [info ] [MainThread]: 
[0m01:09:52.823402 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:09:52.827240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:09:52.876315 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:09:52.876996 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:09:52.877581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:09:52.889436 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m01:09:52.891027 [debug] [ThreadPool]: On list_postgres: Close
[0m01:09:52.892869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:09:52.898218 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:09:52.898769 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:09:52.899284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:09:52.909475 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:09:52.910157 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:09:52.910640 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:09:52.914928 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m01:09:52.916650 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:09:52.918413 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:09:52.923438 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:52.923963 [debug] [MainThread]: On master: BEGIN
[0m01:09:52.924360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:09:52.934483 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:09:52.935151 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:52.935597 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:09:52.940738 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:09:52.942255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dfc6573-5b0d-4b54-bfdd-9f033e50192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeacec6990>]}
[0m01:09:52.942808 [debug] [MainThread]: On master: ROLLBACK
[0m01:09:52.944073 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:52.944545 [debug] [MainThread]: On master: BEGIN
[0m01:09:52.946569 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:09:52.947065 [debug] [MainThread]: On master: COMMIT
[0m01:09:52.947492 [debug] [MainThread]: Using postgres connection "master"
[0m01:09:52.947878 [debug] [MainThread]: On master: COMMIT
[0m01:09:52.949221 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:09:52.949774 [debug] [MainThread]: On master: Close
[0m01:09:52.952874 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:09:52.953699 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:09:52.954452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:09:52.955021 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:09:52.962008 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:09:52.967846 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:09:53.002428 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:09:53.008174 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:09:53.008652 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:09:53.009096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:53.019428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:09:53.020183 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:09:53.020968 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:09:57.055807 [debug] [Thread-1 (]: SQL status: SELECT 157716 in 4.036 seconds
[0m01:09:57.064492 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:09:57.065082 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:09:57.066883 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:09:57.069880 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:09:57.070645 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:09:57.072452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:09:57.086610 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:09:57.087368 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:09:57.087832 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:09:57.318857 [debug] [Thread-1 (]: SQL status: COMMIT in 0.230 seconds
[0m01:09:57.325196 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:09:57.330192 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:09:57.330793 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:09:57.343801 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m01:09:57.346314 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:09:57.348032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfc6573-5b0d-4b54-bfdd-9f033e50192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeaf8db530>]}
[0m01:09:57.348821 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 157716[0m in 4.39s]
[0m01:09:57.349523 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:09:57.350578 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:09:57.351481 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:09:57.352218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:09:57.352988 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:09:57.356957 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:09:57.362617 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:09:57.366198 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:09:57.371911 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:09:57.372492 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:09:57.372895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:57.382100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m01:09:57.382772 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:09:57.383249 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:09:57.411655 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m01:09:57.415102 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:09:57.415590 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:09:57.417365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:09:57.420207 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:09:57.420855 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:09:57.422496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:09:57.424646 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:09:57.425133 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:09:57.454097 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.028 seconds
[0m01:09:57.455920 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:09:57.456418 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:09:57.456863 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:09:57.730552 [debug] [Thread-1 (]: SQL status: COMMIT in 0.273 seconds
[0m01:09:57.733508 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:09:57.734389 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:09:57.734949 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:09:57.739929 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:09:57.741536 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:09:57.742276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfc6573-5b0d-4b54-bfdd-9f033e50192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeab945670>]}
[0m01:09:57.743036 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.39s]
[0m01:09:57.743700 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:09:57.744208 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:09:57.744868 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:09:57.745680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:09:57.746170 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:09:57.750104 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:09:57.756118 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:09:57.759421 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:09:57.765174 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:09:57.765678 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:09:57.766085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:57.776160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:09:57.776896 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:09:57.777362 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:10:01.872385 [debug] [Thread-1 (]: SQL status: SELECT 157716 in 4.094 seconds
[0m01:10:01.876204 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:10:01.876906 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:10:01.878787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:10:01.881568 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:10:01.882021 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:10:01.883433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:10:01.884870 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:10:01.885330 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:10:01.885903 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:10:03.380141 [debug] [Thread-1 (]: SQL status: COMMIT in 1.494 seconds
[0m01:10:03.382960 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:10:03.383913 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:10:03.384438 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:10:03.519667 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.135 seconds
[0m01:10:03.521430 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:10:03.522159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfc6573-5b0d-4b54-bfdd-9f033e50192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeab945670>]}
[0m01:10:03.522822 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 157716[0m in 5.78s]
[0m01:10:03.523469 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:10:03.524010 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:10:03.524676 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:10:03.525344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:10:03.525939 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:10:03.528995 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:10:03.534513 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:10:03.537958 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:10:03.543531 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:10:03.544154 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:10:03.544589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:03.554334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:10:03.554980 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:10:03.555466 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:10:03.820879 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.265 seconds
[0m01:10:03.824179 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:10:03.824699 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:10:03.826612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:10:03.829699 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:10:03.830226 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:10:03.831995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:10:03.833531 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:10:03.833984 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:10:03.834362 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:10:03.978956 [debug] [Thread-1 (]: SQL status: COMMIT in 0.144 seconds
[0m01:10:03.981486 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:10:03.982249 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:10:03.982706 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:10:03.987209 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:10:03.988750 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:10:03.989417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfc6573-5b0d-4b54-bfdd-9f033e50192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeab945400>]}
[0m01:10:03.990163 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.46s]
[0m01:10:03.990973 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:10:03.991501 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:10:03.992165 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:10:03.993054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:10:03.993670 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:10:03.996676 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:10:04.002002 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:10:04.006315 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:10:04.012398 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:10:04.013020 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:10:04.013446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:04.023153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:10:04.023816 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:10:04.024276 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:10:04.026789 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fire_id" does not exist
LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                            ^

[0m01:10:04.027717 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:10:04.029615 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:10:04.033258 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:10:04.034030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dfc6573-5b0d-4b54-bfdd-9f033e50192e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeab12edb0>]}
[0m01:10:04.034724 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m01:10:04.035462 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:10:04.036078 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:10:04.038006 [debug] [MainThread]: Using postgres connection "master"
[0m01:10:04.038406 [debug] [MainThread]: On master: BEGIN
[0m01:10:04.038785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:10:04.048507 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:10:04.049137 [debug] [MainThread]: On master: COMMIT
[0m01:10:04.049549 [debug] [MainThread]: Using postgres connection "master"
[0m01:10:04.049903 [debug] [MainThread]: On master: COMMIT
[0m01:10:04.051053 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:10:04.051482 [debug] [MainThread]: On master: Close
[0m01:10:04.052065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:04.052482 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:10:04.052971 [info ] [MainThread]: 
[0m01:10:04.053468 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 11.23 seconds (11.23s).
[0m01:10:04.054742 [debug] [MainThread]: Command end result
[0m01:10:04.078897 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:10:04.082917 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:10:04.090471 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:10:04.091101 [info ] [MainThread]: 
[0m01:10:04.091744 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:10:04.092418 [info ] [MainThread]: 
[0m01:10:04.093007 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:10:04.093533 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:10:04.094056 [info ] [MainThread]: 
[0m01:10:04.094670 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:10:04.095137 [info ] [MainThread]: 
[0m01:10:04.095583 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:10:04.096813 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.985831, "process_in_blocks": "0", "process_kernel_time": 0.428094, "process_mem_max_rss": "125264", "process_out_blocks": "0", "process_user_time": 2.708599}
[0m01:10:04.097320 [debug] [MainThread]: Command `dbt run` failed at 01:10:04.097230 after 11.99 seconds
[0m01:10:04.097805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aead579d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeafbe0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aeadf007d0>]}
[0m01:10:04.098389 [debug] [MainThread]: Flushing usage events
[0m01:10:05.365312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:11:42.042830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf783f2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf777542f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf77a9a0c0>]}


============================== 01:11:42.091443 | 2ca1707e-1869-4e2f-93f2-f74d78d4e03c ==============================
[0m01:11:42.091443 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:11:42.092224 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'partial_parse': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'printer_width': '80', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'fail_fast': 'False', 'quiet': 'False'}
[0m01:11:42.099315 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:11:42.263411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ca1707e-1869-4e2f-93f2-f74d78d4e03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf79b15e50>]}
[0m01:11:42.319233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ca1707e-1869-4e2f-93f2-f74d78d4e03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf770931d0>]}
[0m01:11:42.320375 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:11:42.405019 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:11:42.563499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:11:42.564235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:11:42.594067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ca1707e-1869-4e2f-93f2-f74d78d4e03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf76e45520>]}
[0m01:11:42.667858 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:11:42.672046 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:11:42.707143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ca1707e-1869-4e2f-93f2-f74d78d4e03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf76cc9190>]}
[0m01:11:42.707787 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:11:42.708285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ca1707e-1869-4e2f-93f2-f74d78d4e03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf771a3d10>]}
[0m01:11:42.710072 [info ] [MainThread]: 
[0m01:11:42.710558 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:11:42.711061 [info ] [MainThread]: 
[0m01:11:42.711736 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:11:42.716378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:11:42.766591 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:11:42.767338 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:11:42.767750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:42.778881 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m01:11:42.781074 [debug] [ThreadPool]: On list_postgres: Close
[0m01:11:42.783287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:11:42.788840 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:11:42.789425 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:11:42.789808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:11:42.801158 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m01:11:42.801813 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:11:42.802235 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:11:42.806590 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m01:11:42.808157 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:11:42.809412 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:11:42.814592 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:42.815399 [debug] [MainThread]: On master: BEGIN
[0m01:11:42.815829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:11:42.825837 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:11:42.826519 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:42.826998 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:11:42.831765 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:11:42.833461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ca1707e-1869-4e2f-93f2-f74d78d4e03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf76f27470>]}
[0m01:11:42.834132 [debug] [MainThread]: On master: ROLLBACK
[0m01:11:42.835701 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:42.836125 [debug] [MainThread]: On master: BEGIN
[0m01:11:42.838607 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:11:42.839219 [debug] [MainThread]: On master: COMMIT
[0m01:11:42.839662 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:42.840018 [debug] [MainThread]: On master: COMMIT
[0m01:11:42.841235 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:11:42.841639 [debug] [MainThread]: On master: Close
[0m01:11:42.844451 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:11:42.845103 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:11:42.845742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:11:42.846550 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:11:42.853854 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:11:42.859785 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:11:42.895111 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:11:42.902410 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:11:42.903035 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:11:42.903516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:42.913371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:11:42.914361 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:11:42.915213 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:11:43.264232 [debug] [Thread-1 (]: SQL status: SELECT 170859 in 0.348 seconds
[0m01:11:43.274560 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:11:43.275249 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:11:43.285171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m01:11:43.288444 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:11:43.288936 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:11:43.290484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:43.304816 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:11:43.305498 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:11:43.305944 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:11:43.323389 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m01:11:43.329419 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:11:43.335098 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:11:43.335809 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:11:43.350119 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m01:11:43.352851 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:11:43.354545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ca1707e-1869-4e2f-93f2-f74d78d4e03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf79aaf980>]}
[0m01:11:43.355280 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 170859[0m in 0.51s]
[0m01:11:43.355960 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:11:43.356603 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:11:43.357310 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:11:43.357959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:11:43.358515 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:11:43.362166 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:11:43.368114 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:11:43.371687 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:11:43.376921 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:43.377536 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:11:43.377968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:43.388223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:11:43.388880 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:43.389362 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:11:43.417131 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.027 seconds
[0m01:11:43.420757 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:43.421323 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:11:43.423136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:43.425805 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:43.426266 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:11:43.427799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:43.429896 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:43.430508 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:11:43.459528 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.028 seconds
[0m01:11:43.461422 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:11:43.461945 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:43.462395 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:11:43.511247 [debug] [Thread-1 (]: SQL status: COMMIT in 0.048 seconds
[0m01:11:43.515132 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:11:43.516426 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:43.517101 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:11:43.521532 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:11:43.523173 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:11:43.524018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ca1707e-1869-4e2f-93f2-f74d78d4e03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf75b00560>]}
[0m01:11:43.524868 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.17s]
[0m01:11:43.525680 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:11:43.526257 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:11:43.526906 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:11:43.527567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:11:43.528217 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:11:43.533880 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:11:43.540167 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:11:43.543687 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:11:43.549868 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:11:43.550690 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:11:43.551221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:43.561204 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:11:43.561937 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:11:43.562447 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:11:44.019513 [debug] [Thread-1 (]: SQL status: SELECT 170859 in 0.456 seconds
[0m01:11:44.023100 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:11:44.023643 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:11:44.025478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:44.028719 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:11:44.029440 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:11:44.031675 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:11:44.034120 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:11:44.034765 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:11:44.035210 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:11:44.057560 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m01:11:44.060452 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:11:44.061414 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:11:44.061924 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:11:44.076895 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m01:11:44.078862 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:11:44.079601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ca1707e-1869-4e2f-93f2-f74d78d4e03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf7530f890>]}
[0m01:11:44.080410 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 170859[0m in 0.55s]
[0m01:11:44.081143 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:11:44.081864 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:11:44.082574 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:11:44.083518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:11:44.084154 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:11:44.087374 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:11:44.093314 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:11:44.096838 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:11:44.103652 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:11:44.104311 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:11:44.104794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:44.114781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:11:44.115802 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:11:44.116804 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:11:44.154182 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.037 seconds
[0m01:11:44.157867 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:11:44.158382 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:11:44.160241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:44.163091 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:11:44.163567 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:11:44.165671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:44.167887 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:11:44.168498 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:11:44.169038 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:11:44.179605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m01:11:44.182628 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:11:44.184003 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:11:44.184600 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:11:44.189387 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:11:44.191079 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:11:44.191823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ca1707e-1869-4e2f-93f2-f74d78d4e03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf75b446b0>]}
[0m01:11:44.192523 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.11s]
[0m01:11:44.193553 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:11:44.194121 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:11:44.194693 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:11:44.195309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:11:44.195823 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:11:44.199359 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:11:44.205395 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:11:44.210393 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:11:44.216961 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:11:44.217891 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:11:44.218411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:44.228595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:11:44.229351 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:11:44.229909 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:11:44.232572 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fire_id" does not exist
LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                            ^

[0m01:11:44.233569 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:11:44.235559 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:11:44.239493 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:11:44.240301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ca1707e-1869-4e2f-93f2-f74d78d4e03c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf7532b740>]}
[0m01:11:44.241099 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m01:11:44.241888 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:11:44.242639 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:11:44.244686 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:44.245108 [debug] [MainThread]: On master: BEGIN
[0m01:11:44.245528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:11:44.255722 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:11:44.256398 [debug] [MainThread]: On master: COMMIT
[0m01:11:44.256957 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:44.257423 [debug] [MainThread]: On master: COMMIT
[0m01:11:44.258630 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:11:44.259072 [debug] [MainThread]: On master: Close
[0m01:11:44.259712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:44.260188 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:11:44.260709 [info ] [MainThread]: 
[0m01:11:44.261201 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m01:11:44.262469 [debug] [MainThread]: Command end result
[0m01:11:44.287242 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:11:44.291434 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:11:44.300410 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:11:44.301125 [info ] [MainThread]: 
[0m01:11:44.301796 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:11:44.302286 [info ] [MainThread]: 
[0m01:11:44.302867 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:11:44.303397 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:11:44.303843 [info ] [MainThread]: 
[0m01:11:44.304359 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:11:44.304794 [info ] [MainThread]: 
[0m01:11:44.305277 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:11:44.306390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3242667, "process_in_blocks": "0", "process_kernel_time": 0.431279, "process_mem_max_rss": "125456", "process_out_blocks": "0", "process_user_time": 2.785513}
[0m01:11:44.306911 [debug] [MainThread]: Command `dbt run` failed at 01:11:44.306818 after 2.32 seconds
[0m01:11:44.307442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf7778bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf78423740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddf777542f0>]}
[0m01:11:44.307918 [debug] [MainThread]: Flushing usage events
[0m01:11:45.296325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:11:53.003090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b2a26ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b2d4f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b28dca40>]}


============================== 01:11:53.060314 | 620e7acf-a172-44e5-a952-43d7c3f78680 ==============================
[0m01:11:53.060314 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:11:53.061061 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'empty': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'debug': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None'}
[0m01:11:53.066804 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:11:53.231067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '620e7acf-a172-44e5-a952-43d7c3f78680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b4aadeb0>]}
[0m01:11:53.286539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '620e7acf-a172-44e5-a952-43d7c3f78680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b2772360>]}
[0m01:11:53.287740 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:11:53.371970 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:11:53.529695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:11:53.530367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:11:53.561044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '620e7acf-a172-44e5-a952-43d7c3f78680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b201f020>]}
[0m01:11:53.628876 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:11:53.633306 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:11:53.669247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '620e7acf-a172-44e5-a952-43d7c3f78680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b1c149b0>]}
[0m01:11:53.669941 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:11:53.670415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '620e7acf-a172-44e5-a952-43d7c3f78680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b13680b0>]}
[0m01:11:53.672192 [info ] [MainThread]: 
[0m01:11:53.672664 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:11:53.673153 [info ] [MainThread]: 
[0m01:11:53.673837 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:11:53.678787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:11:53.730253 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:11:53.730980 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:11:53.731452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:53.743570 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m01:11:53.745617 [debug] [ThreadPool]: On list_postgres: Close
[0m01:11:53.747578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:11:53.752882 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:11:53.753351 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:11:53.753744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:11:53.764653 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m01:11:53.765367 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:11:53.765848 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:11:53.769997 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m01:11:53.771524 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:11:53.772791 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:11:53.778602 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:53.779332 [debug] [MainThread]: On master: BEGIN
[0m01:11:53.779786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:11:53.788955 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:11:53.789598 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:53.790088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:11:53.795628 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:11:53.797247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '620e7acf-a172-44e5-a952-43d7c3f78680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b1c5dee0>]}
[0m01:11:53.797962 [debug] [MainThread]: On master: ROLLBACK
[0m01:11:53.799430 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:53.799878 [debug] [MainThread]: On master: BEGIN
[0m01:11:53.802141 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:11:53.802829 [debug] [MainThread]: On master: COMMIT
[0m01:11:53.803317 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:53.803714 [debug] [MainThread]: On master: COMMIT
[0m01:11:53.805000 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:11:53.805490 [debug] [MainThread]: On master: Close
[0m01:11:53.808470 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:11:53.809547 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:11:53.810378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:11:53.810942 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:11:53.818339 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:11:53.823852 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:11:53.858678 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:11:53.864832 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:11:53.865428 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:11:53.865920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:53.876257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:11:53.877215 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:11:53.878016 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:11:54.328539 [debug] [Thread-1 (]: SQL status: SELECT 184002 in 0.450 seconds
[0m01:11:54.337660 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:11:54.338287 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:11:54.340031 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:54.343359 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:11:54.344096 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:11:54.346286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:11:54.361316 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:11:54.362230 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:11:54.362817 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:11:54.373902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m01:11:54.380766 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:11:54.386164 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:11:54.386707 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:11:54.404228 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m01:11:54.406995 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:11:54.408892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620e7acf-a172-44e5-a952-43d7c3f78680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b4a47a10>]}
[0m01:11:54.410167 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 184002[0m in 0.60s]
[0m01:11:54.411228 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:11:54.411809 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:11:54.412521 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:11:54.413285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:11:54.413828 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:11:54.417290 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:11:54.422350 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:11:54.426090 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:11:54.431723 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:54.432254 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:11:54.432714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:54.442506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:11:54.443418 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:54.444170 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:11:54.472862 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m01:11:54.476766 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:54.477645 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:11:54.479904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:11:54.483163 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:54.483660 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:11:54.485230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:54.487338 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:54.487841 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:11:54.530949 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.043 seconds
[0m01:11:54.532810 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:11:54.533389 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:54.533951 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:11:54.537933 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m01:11:54.540351 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:11:54.541140 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:11:54.541694 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:11:54.547310 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:11:54.549146 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:11:54.549955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620e7acf-a172-44e5-a952-43d7c3f78680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b03d2900>]}
[0m01:11:54.550738 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.14s]
[0m01:11:54.551484 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:11:54.551989 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:11:54.552638 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:11:54.553272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:11:54.553722 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:11:54.558156 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:11:54.564854 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:11:54.568437 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:11:54.574609 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:11:54.575267 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:11:54.575892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:54.586624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:11:54.587306 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:11:54.587924 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:11:55.127766 [debug] [Thread-1 (]: SQL status: SELECT 184002 in 0.539 seconds
[0m01:11:55.131854 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:11:55.132397 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:11:55.134181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:55.136887 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:11:55.137387 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:11:55.138909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:55.140365 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:11:55.140783 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:11:55.141168 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:11:55.182970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m01:11:55.185989 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:11:55.186980 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:11:55.187501 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:11:55.205478 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m01:11:55.207323 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:11:55.208084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620e7acf-a172-44e5-a952-43d7c3f78680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4aff052e0>]}
[0m01:11:55.208862 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 184002[0m in 0.65s]
[0m01:11:55.209686 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:11:55.210367 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:11:55.211291 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:11:55.211990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:11:55.212568 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:11:55.215821 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:11:55.221437 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:11:55.224899 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:11:55.231557 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:11:55.232121 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:11:55.232545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:55.241975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m01:11:55.242673 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:11:55.243409 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:11:55.281460 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.037 seconds
[0m01:11:55.285087 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:11:55.285691 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:11:55.287591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:55.290674 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:11:55.291215 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:11:55.293114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:11:55.295842 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:11:55.296866 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:11:55.297662 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:11:55.308803 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m01:11:55.312213 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:11:55.313722 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:11:55.314335 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:11:55.319454 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:11:55.320982 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:11:55.321739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620e7acf-a172-44e5-a952-43d7c3f78680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b07329c0>]}
[0m01:11:55.322525 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.11s]
[0m01:11:55.323322 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:11:55.323849 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:11:55.324491 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:11:55.325100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:11:55.325601 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:11:55.329423 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:11:55.335494 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:11:55.340559 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:11:55.347006 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:11:55.347698 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:11:55.348246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:55.358080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:11:55.359104 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:11:55.360071 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:11:55.363080 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fire_id" does not exist
LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                            ^

[0m01:11:55.363714 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:11:55.365228 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:11:55.368756 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:11:55.369403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620e7acf-a172-44e5-a952-43d7c3f78680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4aff21880>]}
[0m01:11:55.370085 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m01:11:55.370793 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:11:55.371553 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:11:55.373547 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:55.373980 [debug] [MainThread]: On master: BEGIN
[0m01:11:55.374419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:11:55.385630 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m01:11:55.386267 [debug] [MainThread]: On master: COMMIT
[0m01:11:55.386690 [debug] [MainThread]: Using postgres connection "master"
[0m01:11:55.387126 [debug] [MainThread]: On master: COMMIT
[0m01:11:55.388308 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:11:55.388726 [debug] [MainThread]: On master: Close
[0m01:11:55.389288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:55.389696 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:11:55.390302 [info ] [MainThread]: 
[0m01:11:55.390847 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m01:11:55.392276 [debug] [MainThread]: Command end result
[0m01:11:55.417598 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:11:55.421973 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:11:55.430920 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:11:55.431551 [info ] [MainThread]: 
[0m01:11:55.432150 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:11:55.432647 [info ] [MainThread]: 
[0m01:11:55.433197 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:11:55.433701 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:11:55.434178 [info ] [MainThread]: 
[0m01:11:55.434706 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:11:55.435151 [info ] [MainThread]: 
[0m01:11:55.435603 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:11:55.436837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4947503, "process_in_blocks": "0", "process_kernel_time": 0.443045, "process_mem_max_rss": "124992", "process_out_blocks": "0", "process_user_time": 2.78313}
[0m01:11:55.437365 [debug] [MainThread]: Command `dbt run` failed at 01:11:55.437263 after 2.50 seconds
[0m01:11:55.437899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b2c15d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b2c36d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f4b2c56960>]}
[0m01:11:55.438426 [debug] [MainThread]: Flushing usage events
[0m01:11:56.263378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:13:06.037712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4841105040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4840a69d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4842b51f40>]}


============================== 01:13:06.080893 | 64622a74-29c7-4dd2-bcc2-2801abc630b9 ==============================
[0m01:13:06.080893 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:13:06.081763 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'debug': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'empty': 'False', 'log_format': 'default', 'warn_error': 'None', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'printer_width': '80', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True', 'introspect': 'True'}
[0m01:13:06.089528 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:13:06.271077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64622a74-29c7-4dd2-bcc2-2801abc630b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4840d62450>]}
[0m01:13:06.330466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64622a74-29c7-4dd2-bcc2-2801abc630b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a483fd2e990>]}
[0m01:13:06.331950 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:13:06.426210 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:13:06.587463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:13:06.588174 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:13:06.619706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64622a74-29c7-4dd2-bcc2-2801abc630b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a483fbd1e50>]}
[0m01:13:06.690831 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:13:06.695308 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:13:06.735854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64622a74-29c7-4dd2-bcc2-2801abc630b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a483f9438c0>]}
[0m01:13:06.736703 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:13:06.737367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64622a74-29c7-4dd2-bcc2-2801abc630b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a483f81a120>]}
[0m01:13:06.739605 [info ] [MainThread]: 
[0m01:13:06.740271 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:13:06.740879 [info ] [MainThread]: 
[0m01:13:06.741702 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:13:06.745942 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:13:06.795978 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:13:06.796615 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:13:06.797042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:13:06.810388 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m01:13:06.812128 [debug] [ThreadPool]: On list_postgres: Close
[0m01:13:06.813943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:13:06.819871 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:13:06.820839 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:13:06.821380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:13:06.830983 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:13:06.831636 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:13:06.832093 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:13:06.836644 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m01:13:06.838476 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:13:06.840055 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:13:06.845336 [debug] [MainThread]: Using postgres connection "master"
[0m01:13:06.845873 [debug] [MainThread]: On master: BEGIN
[0m01:13:06.846334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:13:06.856689 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:13:06.857403 [debug] [MainThread]: Using postgres connection "master"
[0m01:13:06.857951 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:13:06.862478 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:13:06.863778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64622a74-29c7-4dd2-bcc2-2801abc630b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a483fe58530>]}
[0m01:13:06.864346 [debug] [MainThread]: On master: ROLLBACK
[0m01:13:06.865583 [debug] [MainThread]: Using postgres connection "master"
[0m01:13:06.865984 [debug] [MainThread]: On master: BEGIN
[0m01:13:06.868434 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:13:06.869343 [debug] [MainThread]: On master: COMMIT
[0m01:13:06.870051 [debug] [MainThread]: Using postgres connection "master"
[0m01:13:06.870569 [debug] [MainThread]: On master: COMMIT
[0m01:13:06.872640 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:13:06.873271 [debug] [MainThread]: On master: Close
[0m01:13:06.876137 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:13:06.876865 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:13:06.877689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:13:06.878191 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:13:06.885625 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:13:06.891739 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:13:06.928161 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:13:06.934184 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:13:06.935242 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:13:06.935859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:06.946023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:13:06.946749 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:13:06.947382 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:13:07.385576 [debug] [Thread-1 (]: SQL status: SELECT 197145 in 0.437 seconds
[0m01:13:07.395503 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:13:07.396157 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:13:07.397981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:13:07.400830 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:13:07.401460 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:13:07.403829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:13:07.418938 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:13:07.419925 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:13:07.420640 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:13:07.433516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m01:13:07.440308 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:13:07.445621 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:13:07.446324 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:13:07.461637 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m01:13:07.464529 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:13:07.466578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64622a74-29c7-4dd2-bcc2-2801abc630b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a484273b710>]}
[0m01:13:07.467523 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 197145[0m in 0.59s]
[0m01:13:07.468671 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:13:07.469796 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:13:07.470932 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:13:07.471796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:13:07.472407 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:13:07.476332 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:13:07.481686 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:13:07.485331 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:13:07.491116 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:13:07.491668 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:13:07.492108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:07.502311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:13:07.503257 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:13:07.503866 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:13:07.532665 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m01:13:07.536760 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:13:07.537507 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:13:07.539685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:13:07.543006 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:13:07.543536 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:13:07.545159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:13:07.547467 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:13:07.548079 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:13:07.576863 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.028 seconds
[0m01:13:07.579069 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:13:07.579625 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:13:07.580093 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:13:07.598723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m01:13:07.601606 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:13:07.603082 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:13:07.603840 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:13:07.608981 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:13:07.610783 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:13:07.611511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64622a74-29c7-4dd2-bcc2-2801abc630b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a483e5bd880>]}
[0m01:13:07.612391 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.14s]
[0m01:13:07.613146 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:13:07.613688 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:13:07.614392 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:13:07.615012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:13:07.615484 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:13:07.620676 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:13:07.627476 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:13:07.631039 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:13:07.637524 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:13:07.638389 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:13:07.638981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:07.648963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:13:07.649737 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:13:07.650292 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:13:08.191258 [debug] [Thread-1 (]: SQL status: SELECT 197145 in 0.540 seconds
[0m01:13:08.194911 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:13:08.195507 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:13:08.197283 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:13:08.200044 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:13:08.200580 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:13:08.202613 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:13:08.204972 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:13:08.205571 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:13:08.206083 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:13:08.234868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m01:13:08.238274 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:13:08.239409 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:13:08.239966 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:13:08.256696 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m01:13:08.258840 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:13:08.259674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64622a74-29c7-4dd2-bcc2-2801abc630b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a483d90d550>]}
[0m01:13:08.260560 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 197145[0m in 0.64s]
[0m01:13:08.261349 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:13:08.261912 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:13:08.262614 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:13:08.263257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:13:08.263733 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:13:08.266652 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:13:08.273450 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:13:08.277304 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:13:08.282851 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:13:08.283426 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:13:08.283877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:08.295532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:13:08.296305 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:13:08.296857 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:13:08.334749 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.037 seconds
[0m01:13:08.339024 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:13:08.339755 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:13:08.341882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:13:08.344895 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:13:08.345379 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:13:08.346824 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:13:08.348302 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:13:08.348796 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:13:08.349314 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:13:08.385216 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m01:13:08.388627 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:13:08.389797 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:13:08.390303 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:13:08.394934 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:13:08.396530 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:13:08.397303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64622a74-29c7-4dd2-bcc2-2801abc630b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a483e144d40>]}
[0m01:13:08.398142 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.13s]
[0m01:13:08.398848 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:13:08.399382 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:13:08.400036 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:13:08.400857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:13:08.401380 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:13:08.404988 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:13:08.410967 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:13:08.416116 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:13:08.423016 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:13:08.423780 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:13:08.424344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:13:08.434320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:13:08.435202 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:13:08.435923 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:13:08.439529 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fire_id" does not exist
LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                            ^

[0m01:13:08.440508 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:13:08.442831 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:13:08.446680 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:13:08.447487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64622a74-29c7-4dd2-bcc2-2801abc630b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a483d933050>]}
[0m01:13:08.448331 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.05s]
[0m01:13:08.449308 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:13:08.450234 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:13:08.452490 [debug] [MainThread]: Using postgres connection "master"
[0m01:13:08.453264 [debug] [MainThread]: On master: BEGIN
[0m01:13:08.453831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:13:08.464272 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:13:08.464954 [debug] [MainThread]: On master: COMMIT
[0m01:13:08.465450 [debug] [MainThread]: Using postgres connection "master"
[0m01:13:08.465913 [debug] [MainThread]: On master: COMMIT
[0m01:13:08.467129 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:13:08.467567 [debug] [MainThread]: On master: Close
[0m01:13:08.468182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:13:08.468605 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:13:08.469432 [info ] [MainThread]: 
[0m01:13:08.470288 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m01:13:08.472288 [debug] [MainThread]: Command end result
[0m01:13:08.498766 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:13:08.504125 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:13:08.513243 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:13:08.513785 [info ] [MainThread]: 
[0m01:13:08.514352 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:13:08.514971 [info ] [MainThread]: 
[0m01:13:08.515725 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:13:08.516344 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "fire_id" does not exist
  LINE 21:     COUNT(DISTINCT fire_id) as unique_fires,
                              ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:13:08.516834 [info ] [MainThread]: 
[0m01:13:08.517362 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:13:08.517811 [info ] [MainThread]: 
[0m01:13:08.518442 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:13:08.520310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5469992, "process_in_blocks": "0", "process_kernel_time": 0.445647, "process_mem_max_rss": "125412", "process_out_blocks": "0", "process_user_time": 2.778269}
[0m01:13:08.521769 [debug] [MainThread]: Command `dbt run` failed at 01:13:08.521437 after 2.55 seconds
[0m01:13:08.522534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4842b51f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a483f9013a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a483fec9280>]}
[0m01:13:08.523223 [debug] [MainThread]: Flushing usage events
[0m01:13:09.657403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:14:41.510030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794d05dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794cec63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794d1d6bd0>]}


============================== 01:14:41.555985 | ea946d9c-17c4-42e6-a211-47e4ef1b80e8 ==============================
[0m01:14:41.555985 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:14:41.556651 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'introspect': 'True', 'empty': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'version_check': 'True', 'invocation_command': 'dbt run', 'printer_width': '80', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt'}
[0m01:14:41.562762 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:14:41.727258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea946d9c-17c4-42e6-a211-47e4ef1b80e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794d05e1b0>]}
[0m01:14:41.783143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea946d9c-17c4-42e6-a211-47e4ef1b80e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794d1d7110>]}
[0m01:14:41.784628 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:14:41.870242 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:14:42.022301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:14:42.023212 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/silver/fires_daily.sql
[0m01:14:42.254012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea946d9c-17c4-42e6-a211-47e4ef1b80e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794b7f6ed0>]}
[0m01:14:42.319759 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:14:42.324312 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:14:42.357407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea946d9c-17c4-42e6-a211-47e4ef1b80e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794c404650>]}
[0m01:14:42.358032 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:14:42.358513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea946d9c-17c4-42e6-a211-47e4ef1b80e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794c6a43b0>]}
[0m01:14:42.360348 [info ] [MainThread]: 
[0m01:14:42.361009 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:14:42.361537 [info ] [MainThread]: 
[0m01:14:42.362352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:14:42.366522 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:14:42.415140 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:14:42.415761 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:14:42.416144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:42.429907 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.014 seconds
[0m01:14:42.431535 [debug] [ThreadPool]: On list_postgres: Close
[0m01:14:42.433261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:14:42.439478 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:14:42.440260 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:14:42.440724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:14:42.450487 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:14:42.451285 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:14:42.451787 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:14:42.456360 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m01:14:42.458170 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:14:42.459690 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:14:42.464638 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:42.465249 [debug] [MainThread]: On master: BEGIN
[0m01:14:42.465740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:14:42.475992 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:14:42.476733 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:42.477274 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:14:42.481550 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:14:42.482844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea946d9c-17c4-42e6-a211-47e4ef1b80e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794c7d6b10>]}
[0m01:14:42.483392 [debug] [MainThread]: On master: ROLLBACK
[0m01:14:42.484917 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:42.485588 [debug] [MainThread]: On master: BEGIN
[0m01:14:42.488047 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:14:42.488725 [debug] [MainThread]: On master: COMMIT
[0m01:14:42.489301 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:42.489811 [debug] [MainThread]: On master: COMMIT
[0m01:14:42.491285 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:14:42.491743 [debug] [MainThread]: On master: Close
[0m01:14:42.494424 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:14:42.495086 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:14:42.495699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:14:42.496227 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:14:42.503600 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:14:42.509779 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:14:42.542986 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:14:42.548874 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:14:42.549473 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:14:42.550006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:42.560227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:14:42.560896 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:14:42.561441 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:14:46.881988 [debug] [Thread-1 (]: SQL status: SELECT 210288 in 4.320 seconds
[0m01:14:46.891799 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:14:46.892508 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:14:46.894496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:14:46.898738 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:14:46.899284 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:14:46.901040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:14:46.916102 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:14:46.916782 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:14:46.917304 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:14:48.387857 [debug] [Thread-1 (]: SQL status: COMMIT in 1.470 seconds
[0m01:14:48.394341 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:14:48.399730 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:14:48.400429 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:14:48.416438 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m01:14:48.419115 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:14:48.421176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea946d9c-17c4-42e6-a211-47e4ef1b80e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794f1eb2f0>]}
[0m01:14:48.422059 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 210288[0m in 5.92s]
[0m01:14:48.422752 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:14:48.423420 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:14:48.424276 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:14:48.425133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:14:48.425804 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:14:48.429855 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:14:48.435383 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:14:48.438903 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:14:48.444459 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:14:48.445127 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:14:48.445776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:48.456001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:14:48.456742 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:14:48.457459 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:14:48.604588 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.146 seconds
[0m01:14:48.608396 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:14:48.609102 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:14:48.611073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:14:48.614424 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:14:48.615060 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:14:48.616800 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:14:48.618976 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:14:48.619489 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:14:48.650690 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.031 seconds
[0m01:14:48.652557 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:14:48.653045 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:14:48.653497 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:14:49.244496 [debug] [Thread-1 (]: SQL status: COMMIT in 0.590 seconds
[0m01:14:49.248027 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:14:49.249058 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:14:49.249647 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:14:49.254932 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:14:49.256756 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:14:49.257878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea946d9c-17c4-42e6-a211-47e4ef1b80e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794a36bfb0>]}
[0m01:14:49.259106 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.83s]
[0m01:14:49.260038 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:14:49.260811 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:14:49.261696 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:14:49.262523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:14:49.263084 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:14:49.267166 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:14:49.274433 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:14:49.278430 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:14:49.285168 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:14:49.285892 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:14:49.286502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:49.297981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:14:49.298803 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:14:49.299378 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:14:56.641681 [debug] [Thread-1 (]: SQL status: SELECT 210288 in 7.343 seconds
[0m01:14:56.645705 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:14:56.646211 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:14:56.647953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:14:56.653065 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:14:56.653767 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:14:56.655796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:14:56.657647 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:14:56.658223 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:14:56.658641 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:14:57.083877 [debug] [Thread-1 (]: SQL status: COMMIT in 0.425 seconds
[0m01:14:57.087248 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:14:57.088366 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:14:57.088891 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:14:57.215593 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.126 seconds
[0m01:14:57.217463 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:14:57.218383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea946d9c-17c4-42e6-a211-47e4ef1b80e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794a3cbd10>]}
[0m01:14:57.219224 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 210288[0m in 7.96s]
[0m01:14:57.219964 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:14:57.220500 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:14:57.221195 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:14:57.221844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:14:57.222336 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:14:57.225511 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:14:57.230893 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:14:57.234695 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:14:57.240550 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:14:57.241250 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:14:57.241754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:57.252084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:14:57.252818 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:14:57.253345 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:14:57.290436 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.037 seconds
[0m01:14:57.293809 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:14:57.294292 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:14:57.295811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:14:57.298377 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:14:57.298832 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:14:57.300558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:14:57.302422 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:14:57.303027 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:14:57.303575 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:14:57.537265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.233 seconds
[0m01:14:57.539968 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:14:57.540751 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:14:57.541211 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:14:57.545361 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:14:57.547057 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:14:57.547728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea946d9c-17c4-42e6-a211-47e4ef1b80e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794a388f50>]}
[0m01:14:57.548399 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.33s]
[0m01:14:57.549232 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:14:57.550490 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:14:57.551225 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:14:57.551993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:14:57.552552 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:14:57.555639 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:14:57.561300 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:14:57.564968 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:14:57.571944 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:14:57.572643 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:14:57.573149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:14:57.583221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:14:57.584089 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:14:57.584655 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_cleaned"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:14:57.587283 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "province" does not exist
LINE 17:     province,
             ^

[0m01:14:57.588067 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:14:57.589643 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:14:57.593427 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "province" does not exist
  LINE 17:     province,
               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:14:57.594122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea946d9c-17c4-42e6-a211-47e4ef1b80e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794a726270>]}
[0m01:14:57.594789 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m01:14:57.595523 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:14:57.596234 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "province" does not exist
  LINE 17:     province,
               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:14:57.598189 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:57.598624 [debug] [MainThread]: On master: BEGIN
[0m01:14:57.599022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:14:57.609332 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:14:57.609990 [debug] [MainThread]: On master: COMMIT
[0m01:14:57.610436 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:57.610808 [debug] [MainThread]: On master: COMMIT
[0m01:14:57.612076 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:14:57.612470 [debug] [MainThread]: On master: Close
[0m01:14:57.613086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:57.613456 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:14:57.614049 [info ] [MainThread]: 
[0m01:14:57.614520 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 15.25 seconds (15.25s).
[0m01:14:57.615942 [debug] [MainThread]: Command end result
[0m01:14:57.714036 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:14:57.718829 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:14:57.727531 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:14:57.728107 [info ] [MainThread]: 
[0m01:14:57.728656 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:14:57.729305 [info ] [MainThread]: 
[0m01:14:57.729930 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:14:57.730457 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "province" does not exist
  LINE 17:     province,
               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:14:57.730888 [info ] [MainThread]: 
[0m01:14:57.731424 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:14:57.731903 [info ] [MainThread]: 
[0m01:14:57.732508 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:14:57.734117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.286455, "process_in_blocks": "0", "process_kernel_time": 0.384409, "process_mem_max_rss": "128548", "process_out_blocks": "0", "process_user_time": 3.043241}
[0m01:14:57.734846 [debug] [MainThread]: Command `dbt run` failed at 01:14:57.734718 after 16.29 seconds
[0m01:14:57.735422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794d1e9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794ed5d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d794d06d0a0>]}
[0m01:14:57.735948 [debug] [MainThread]: Flushing usage events
[0m01:14:58.670686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:15:37.596234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c108208f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c107f46840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c1076279b0>]}


============================== 01:15:37.644850 | 1e01441e-3b12-4a5a-a8c7-7eaa0738db9a ==============================
[0m01:15:37.644850 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:15:37.645673 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'version_check': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'log_format': 'default', 'empty': 'False', 'fail_fast': 'False'}
[0m01:15:37.652220 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:15:37.822741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e01441e-3b12-4a5a-a8c7-7eaa0738db9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c106e97290>]}
[0m01:15:37.879749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e01441e-3b12-4a5a-a8c7-7eaa0738db9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c106daba10>]}
[0m01:15:37.881025 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:15:37.965788 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:15:38.119400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:15:38.120092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:15:38.155659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e01441e-3b12-4a5a-a8c7-7eaa0738db9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c106c3e960>]}
[0m01:15:38.256847 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:15:38.265280 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:15:38.310817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e01441e-3b12-4a5a-a8c7-7eaa0738db9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c106ac1610>]}
[0m01:15:38.311666 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:15:38.312409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e01441e-3b12-4a5a-a8c7-7eaa0738db9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c106f7ae40>]}
[0m01:15:38.315875 [info ] [MainThread]: 
[0m01:15:38.316940 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:15:38.317781 [info ] [MainThread]: 
[0m01:15:38.318655 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:15:38.323323 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:15:38.379100 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:15:38.379899 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:15:38.380541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:38.394397 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.014 seconds
[0m01:15:38.396578 [debug] [ThreadPool]: On list_postgres: Close
[0m01:15:38.398964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:15:38.405455 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:15:38.406113 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:15:38.406624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:38.418834 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m01:15:38.419555 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:15:38.420067 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:15:38.423935 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m01:15:38.425678 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:15:38.428109 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:15:38.433848 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:38.434428 [debug] [MainThread]: On master: BEGIN
[0m01:15:38.434906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:15:38.445477 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:15:38.446162 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:38.446700 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:15:38.451960 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:15:38.453604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e01441e-3b12-4a5a-a8c7-7eaa0738db9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c106e8ee10>]}
[0m01:15:38.454245 [debug] [MainThread]: On master: ROLLBACK
[0m01:15:38.455723 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:38.456194 [debug] [MainThread]: On master: BEGIN
[0m01:15:38.458343 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:15:38.459037 [debug] [MainThread]: On master: COMMIT
[0m01:15:38.459785 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:38.460264 [debug] [MainThread]: On master: COMMIT
[0m01:15:38.462301 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:15:38.462898 [debug] [MainThread]: On master: Close
[0m01:15:38.465784 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:15:38.466513 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:15:38.467219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:15:38.467756 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:15:38.475438 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:15:38.481947 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:15:38.524894 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:15:38.532246 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:15:38.532861 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:15:38.533329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:38.545256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:15:38.546173 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:15:38.547060 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:15:43.039527 [debug] [Thread-1 (]: SQL status: SELECT 223431 in 4.491 seconds
[0m01:15:43.054882 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:15:43.055843 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:15:44.269215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.213 seconds
[0m01:15:44.274792 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:15:44.275851 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:15:44.278575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:15:44.301006 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:15:44.301946 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:15:44.302793 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:15:44.328288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m01:15:44.337167 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:15:44.343691 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:15:44.344441 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:15:44.366916 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.022 seconds
[0m01:15:44.370436 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:15:44.372927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e01441e-3b12-4a5a-a8c7-7eaa0738db9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c1098ab920>]}
[0m01:15:44.373888 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 223431[0m in 5.90s]
[0m01:15:44.374914 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:15:44.375710 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:15:44.376677 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:15:44.377439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:15:44.377984 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:15:44.383274 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:15:44.388651 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:15:44.392913 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:15:44.398338 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:15:44.398968 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:15:44.399573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:44.412628 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:15:44.413413 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:15:44.414133 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:15:44.467960 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.053 seconds
[0m01:15:44.473265 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:15:44.474057 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:15:44.476124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:15:44.479538 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:15:44.480085 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:15:44.482120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:15:44.485066 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:15:44.485811 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:15:44.518487 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.032 seconds
[0m01:15:44.520630 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:15:44.521450 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:15:44.522309 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:15:44.583354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.060 seconds
[0m01:15:44.587082 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:15:44.588659 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:15:44.589273 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:15:44.593786 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:15:44.595628 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:15:44.596555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e01441e-3b12-4a5a-a8c7-7eaa0738db9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c1059413a0>]}
[0m01:15:44.597489 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.22s]
[0m01:15:44.598602 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:15:44.599440 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:15:44.600328 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:15:44.601313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:15:44.602173 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:15:44.608159 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:15:44.615596 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:15:44.620013 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:15:44.627010 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:15:44.627659 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:15:44.628083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:44.640195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:15:44.641028 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:15:44.641627 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:15:45.556084 [debug] [Thread-1 (]: SQL status: SELECT 223431 in 0.914 seconds
[0m01:15:45.564239 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:15:45.565628 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:15:46.211802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.645 seconds
[0m01:15:46.215705 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:15:46.216856 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:15:46.219701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:15:46.222028 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:15:46.222737 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:15:46.223338 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:15:46.226558 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:15:46.229770 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:15:46.230981 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:15:46.231687 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:15:46.255369 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.023 seconds
[0m01:15:46.257838 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:15:46.259221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e01441e-3b12-4a5a-a8c7-7eaa0738db9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c105114050>]}
[0m01:15:46.260396 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 223431[0m in 1.66s]
[0m01:15:46.261604 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:15:46.262548 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:15:46.263656 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:15:46.264717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:15:46.265484 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:15:46.270281 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:15:46.278587 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:15:46.282829 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:15:46.291168 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:15:46.292360 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:15:46.293341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:46.307521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:15:46.308760 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:15:46.309457 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:15:46.349854 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.039 seconds
[0m01:15:46.354057 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:15:46.354716 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:15:46.356767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:15:46.360546 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:15:46.361342 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:15:46.364004 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:15:46.367507 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:15:46.368666 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:15:46.369576 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:15:46.385049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m01:15:46.391186 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:15:46.393165 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:15:46.394796 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:15:46.405326 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m01:15:46.412551 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:15:46.415336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e01441e-3b12-4a5a-a8c7-7eaa0738db9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c105941760>]}
[0m01:15:46.421301 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.15s]
[0m01:15:46.423462 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:15:46.431618 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:15:46.433672 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:15:46.436605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:15:46.439728 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:15:46.447356 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:15:46.478053 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:15:46.498702 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:15:46.529507 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:15:46.530833 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:15:46.531881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:15:46.584934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m01:15:46.587373 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:15:46.589006 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_cleaned"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:15:46.599025 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "province" does not exist
LINE 17:     province,
             ^

[0m01:15:46.600750 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:15:46.609948 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:15:46.620152 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "province" does not exist
  LINE 17:     province,
               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:15:46.628395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e01441e-3b12-4a5a-a8c7-7eaa0738db9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c105122420>]}
[0m01:15:46.637200 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.19s]
[0m01:15:46.639369 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:15:46.642418 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "province" does not exist
  LINE 17:     province,
               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:15:46.647597 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:46.649665 [debug] [MainThread]: On master: BEGIN
[0m01:15:46.651599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:15:46.698187 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m01:15:46.702576 [debug] [MainThread]: On master: COMMIT
[0m01:15:46.704805 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:46.707474 [debug] [MainThread]: On master: COMMIT
[0m01:15:46.715243 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m01:15:46.718889 [debug] [MainThread]: On master: Close
[0m01:15:46.723396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:15:46.724725 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:15:46.727388 [info ] [MainThread]: 
[0m01:15:46.730938 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.41 seconds (8.41s).
[0m01:15:46.736623 [debug] [MainThread]: Command end result
[0m01:15:46.815085 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:15:46.836455 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:15:46.864937 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:15:46.867051 [info ] [MainThread]: 
[0m01:15:46.868738 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:15:46.870378 [info ] [MainThread]: 
[0m01:15:46.871855 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:15:46.873309 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "province" does not exist
  LINE 17:     province,
               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:15:46.874536 [info ] [MainThread]: 
[0m01:15:46.875837 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:15:46.877527 [info ] [MainThread]: 
[0m01:15:46.878987 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:15:46.889220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.360738, "process_in_blocks": "0", "process_kernel_time": 0.416069, "process_mem_max_rss": "125588", "process_out_blocks": "0", "process_user_time": 3.056513}
[0m01:15:46.890938 [debug] [MainThread]: Command `dbt run` failed at 01:15:46.890683 after 9.36 seconds
[0m01:15:46.892121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c107b34da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c10825e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c106d93140>]}
[0m01:15:46.893530 [debug] [MainThread]: Flushing usage events
[0m01:15:47.795779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:59.768371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722676427950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722675e00380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722676476690>]}


============================== 01:16:59.815523 | bdfa8046-1b13-4d15-929f-fc4bc9a28a1a ==============================
[0m01:16:59.815523 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:16:59.816314 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'use_colors': 'True', 'write_json': 'True'}
[0m01:16:59.821958 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:16:59.978229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdfa8046-1b13-4d15-929f-fc4bc9a28a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722675265c10>]}
[0m01:17:00.032156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdfa8046-1b13-4d15-929f-fc4bc9a28a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7226750d2a50>]}
[0m01:17:00.033267 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:17:00.114459 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:17:00.279459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:00.280051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:00.307899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdfa8046-1b13-4d15-929f-fc4bc9a28a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7226760ff4d0>]}
[0m01:17:00.370246 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:17:00.374140 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:17:00.407339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdfa8046-1b13-4d15-929f-fc4bc9a28a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722674cc9430>]}
[0m01:17:00.407967 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:17:00.408469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdfa8046-1b13-4d15-929f-fc4bc9a28a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722674e8d760>]}
[0m01:17:00.410253 [info ] [MainThread]: 
[0m01:17:00.410765 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:17:00.411285 [info ] [MainThread]: 
[0m01:17:00.412165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:17:00.416391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:17:00.464295 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:17:00.464992 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:17:00.465509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:00.476200 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m01:17:00.477726 [debug] [ThreadPool]: On list_postgres: Close
[0m01:17:00.479597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:17:00.485249 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:17:00.485788 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:17:00.486179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:00.495815 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:17:00.496534 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:17:00.497056 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:17:00.501633 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m01:17:00.503150 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:17:00.504472 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:17:00.508936 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:00.509475 [debug] [MainThread]: On master: BEGIN
[0m01:17:00.509907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:17:00.519681 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:17:00.520333 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:00.520823 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:17:00.525315 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:17:00.526693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdfa8046-1b13-4d15-929f-fc4bc9a28a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722674e4a4e0>]}
[0m01:17:00.527241 [debug] [MainThread]: On master: ROLLBACK
[0m01:17:00.528720 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:00.529206 [debug] [MainThread]: On master: BEGIN
[0m01:17:00.531505 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:17:00.532159 [debug] [MainThread]: On master: COMMIT
[0m01:17:00.532612 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:00.533005 [debug] [MainThread]: On master: COMMIT
[0m01:17:00.534347 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:17:00.534803 [debug] [MainThread]: On master: Close
[0m01:17:00.537523 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:17:00.538181 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:17:00.538755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:17:00.539207 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:17:00.546355 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:17:00.551985 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:17:00.584686 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:17:00.590501 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:17:00.591005 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:17:00.591433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:00.601414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:17:00.602083 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:17:00.602637 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:17:00.949564 [debug] [Thread-1 (]: SQL status: SELECT 236574 in 0.346 seconds
[0m01:17:00.958862 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:17:00.959409 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:17:00.961052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:00.964197 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:17:00.964791 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:17:00.966755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:00.981073 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:17:00.981766 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:17:00.982254 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:17:01.014663 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m01:17:01.021442 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:17:01.026627 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:17:01.027180 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:17:01.045386 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m01:17:01.048638 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:17:01.051071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdfa8046-1b13-4d15-929f-fc4bc9a28a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722677aeba40>]}
[0m01:17:01.052335 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 236574[0m in 0.51s]
[0m01:17:01.053263 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:17:01.053949 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:17:01.054670 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:17:01.055351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:17:01.055862 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:17:01.059534 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:17:01.065149 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:17:01.069147 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:17:01.074014 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:01.074525 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:17:01.075010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:01.085438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:17:01.086121 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:01.086658 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:17:01.114632 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.027 seconds
[0m01:17:01.118762 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:01.119374 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:17:01.121426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:01.124654 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:01.125333 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:17:01.126941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:01.129302 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:01.129931 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:17:01.159377 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.029 seconds
[0m01:17:01.161547 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:17:01.162241 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:01.162832 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:17:01.181814 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m01:17:01.185450 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:17:01.186648 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:01.187241 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:17:01.192305 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m01:17:01.193999 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:17:01.194974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdfa8046-1b13-4d15-929f-fc4bc9a28a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722674312510>]}
[0m01:17:01.196161 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.14s]
[0m01:17:01.196986 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:17:01.197520 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:17:01.198316 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:17:01.199011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:17:01.199492 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:17:01.205543 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:17:01.211708 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:17:01.215731 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:17:01.221801 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:17:01.222420 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:17:01.222982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:01.233569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:17:01.234314 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:17:01.234865 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:17:01.711751 [debug] [Thread-1 (]: SQL status: SELECT 236574 in 0.476 seconds
[0m01:17:01.715616 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:17:01.716276 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:17:01.718258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:01.721561 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:17:01.722103 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:17:01.723642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:01.725278 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:17:01.725742 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:17:01.726152 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:17:01.774665 [debug] [Thread-1 (]: SQL status: COMMIT in 0.048 seconds
[0m01:17:01.777462 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:17:01.778396 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:17:01.778926 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:17:01.800204 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.021 seconds
[0m01:17:01.802155 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:17:01.803031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdfa8046-1b13-4d15-929f-fc4bc9a28a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7226733200b0>]}
[0m01:17:01.803840 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 236574[0m in 0.60s]
[0m01:17:01.804552 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:17:01.805187 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:17:01.805793 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:17:01.806395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:17:01.806826 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:17:01.809639 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:17:01.815354 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:17:01.819130 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:17:01.824638 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:17:01.825118 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:17:01.825561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:01.836374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:17:01.837226 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:17:01.837763 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:17:01.874328 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.036 seconds
[0m01:17:01.877906 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:17:01.878451 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:17:01.880313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:01.883389 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:17:01.883953 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:17:01.885868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:01.887549 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:17:01.888063 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:17:01.888488 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:17:01.899757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m01:17:01.902673 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:17:01.903554 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:17:01.904065 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:17:01.908655 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:17:01.910154 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:17:01.910889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdfa8046-1b13-4d15-929f-fc4bc9a28a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7226737419a0>]}
[0m01:17:01.911943 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.10s]
[0m01:17:01.912996 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:17:01.914284 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:17:01.914917 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:17:01.915525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:17:01.916036 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:17:01.919139 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:17:01.924927 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:17:01.930272 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:17:01.936101 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:17:01.936698 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:17:01.937214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:01.946761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m01:17:01.947493 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:17:01.948056 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_cleaned"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:17:01.949921 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "province" does not exist
LINE 17:     province,
             ^

[0m01:17:01.950571 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:17:01.951930 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:17:01.955411 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "province" does not exist
  LINE 17:     province,
               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:17:01.956047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdfa8046-1b13-4d15-929f-fc4bc9a28a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722674c790a0>]}
[0m01:17:01.956758 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m01:17:01.957667 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:17:01.958348 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "province" does not exist
  LINE 17:     province,
               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:17:01.960378 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:01.960860 [debug] [MainThread]: On master: BEGIN
[0m01:17:01.961234 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:17:01.970674 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:17:01.971287 [debug] [MainThread]: On master: COMMIT
[0m01:17:01.971699 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:01.972107 [debug] [MainThread]: On master: COMMIT
[0m01:17:01.973390 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:17:01.973874 [debug] [MainThread]: On master: Close
[0m01:17:01.974420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:01.974828 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:17:01.975373 [info ] [MainThread]: 
[0m01:17:01.975856 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m01:17:01.977218 [debug] [MainThread]: Command end result
[0m01:17:01.999846 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:17:02.003753 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:17:02.011171 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:17:02.011650 [info ] [MainThread]: 
[0m01:17:02.012264 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:17:02.012738 [info ] [MainThread]: 
[0m01:17:02.013254 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:17:02.013788 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "province" does not exist
  LINE 17:     province,
               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:17:02.014288 [info ] [MainThread]: 
[0m01:17:02.014803 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:17:02.015246 [info ] [MainThread]: 
[0m01:17:02.015722 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:17:02.016803 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.309315, "process_in_blocks": "0", "process_kernel_time": 0.400944, "process_mem_max_rss": "125344", "process_out_blocks": "0", "process_user_time": 2.666281}
[0m01:17:02.017279 [debug] [MainThread]: Command `dbt run` failed at 01:17:02.017179 after 2.31 seconds
[0m01:17:02.017747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7226753c0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7226758f2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72267643f620>]}
[0m01:17:02.018257 [debug] [MainThread]: Flushing usage events
[0m01:17:03.278493 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:17:41.287532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca36232c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca360cadb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca36230050>]}


============================== 01:17:41.332824 | e4752f94-82dd-4944-8f70-871443fccfe9 ==============================
[0m01:17:41.332824 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:17:41.333544 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'log_format': 'default', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'empty': 'False', 'version_check': 'True', 'no_print': 'None', 'invocation_command': 'dbt run', 'write_json': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'fail_fast': 'False', 'log_cache_events': 'False'}
[0m01:17:41.339933 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:17:41.506200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4752f94-82dd-4944-8f70-871443fccfe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca357995e0>]}
[0m01:17:41.561664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4752f94-82dd-4944-8f70-871443fccfe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca3815aea0>]}
[0m01:17:41.562923 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:17:41.647468 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:17:41.799929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:41.800557 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:41.830696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4752f94-82dd-4944-8f70-871443fccfe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca356c1610>]}
[0m01:17:41.898763 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:17:41.903223 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:17:41.939273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4752f94-82dd-4944-8f70-871443fccfe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca35441dc0>]}
[0m01:17:41.940062 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:17:41.940669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4752f94-82dd-4944-8f70-871443fccfe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca3559b590>]}
[0m01:17:41.943612 [info ] [MainThread]: 
[0m01:17:41.944489 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:17:41.945061 [info ] [MainThread]: 
[0m01:17:41.945762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:17:41.949905 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:17:42.001812 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:17:42.002484 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:17:42.002965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:42.016071 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m01:17:42.017638 [debug] [ThreadPool]: On list_postgres: Close
[0m01:17:42.019726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:17:42.025289 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:17:42.025907 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:17:42.026285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:42.035724 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:17:42.036344 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:17:42.036797 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:17:42.041206 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m01:17:42.042983 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:17:42.044476 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:17:42.049434 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:42.050056 [debug] [MainThread]: On master: BEGIN
[0m01:17:42.050476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:17:42.060545 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:17:42.061207 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:42.061680 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:17:42.066056 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:17:42.067408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4752f94-82dd-4944-8f70-871443fccfe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca34b8b710>]}
[0m01:17:42.067954 [debug] [MainThread]: On master: ROLLBACK
[0m01:17:42.069166 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:42.069616 [debug] [MainThread]: On master: BEGIN
[0m01:17:42.071747 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:17:42.072320 [debug] [MainThread]: On master: COMMIT
[0m01:17:42.072741 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:42.073181 [debug] [MainThread]: On master: COMMIT
[0m01:17:42.074568 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:17:42.075159 [debug] [MainThread]: On master: Close
[0m01:17:42.078074 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:17:42.078807 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:17:42.079521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:17:42.079995 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:17:42.086896 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:17:42.092777 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:17:42.126702 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:17:42.132992 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:17:42.133846 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:17:42.134422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:42.144886 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:17:42.145592 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:17:42.146212 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:17:42.514097 [debug] [Thread-1 (]: SQL status: SELECT 249717 in 0.367 seconds
[0m01:17:42.522998 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:17:42.523661 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:17:42.525698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:17:42.528693 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:17:42.529145 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:17:42.530638 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:42.544498 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:17:42.545181 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:17:42.545687 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:17:42.568129 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m01:17:42.574459 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:17:42.580528 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:17:42.581172 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:17:42.599685 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m01:17:42.602347 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:17:42.604065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4752f94-82dd-4944-8f70-871443fccfe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca382ccb90>]}
[0m01:17:42.604764 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 249717[0m in 0.52s]
[0m01:17:42.605540 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:17:42.606263 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:17:42.607043 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:17:42.607797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:17:42.608326 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:17:42.612107 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:17:42.616946 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:17:42.620225 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:17:42.625381 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:42.626012 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:17:42.626461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:42.635969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m01:17:42.636702 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:42.637249 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:17:42.665052 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.027 seconds
[0m01:17:42.668759 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:42.669379 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:17:42.671362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:17:42.674394 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:42.674966 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:17:42.676764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:42.679000 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:42.679485 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:17:42.707512 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.027 seconds
[0m01:17:42.709569 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:17:42.710096 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:42.710532 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:17:42.800188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.089 seconds
[0m01:17:42.803069 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:17:42.803944 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:17:42.804394 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:17:42.808992 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:17:42.810971 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:17:42.811765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4752f94-82dd-4944-8f70-871443fccfe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca34bf4d40>]}
[0m01:17:42.812552 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.20s]
[0m01:17:42.813373 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:17:42.813902 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:17:42.814566 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:17:42.815163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:17:42.815665 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:17:42.820044 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:17:42.826565 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:17:42.830013 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:17:42.835418 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:17:42.835957 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:17:42.836381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:42.846747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:17:42.847516 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:17:42.848047 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:17:43.488237 [debug] [Thread-1 (]: SQL status: SELECT 249717 in 0.639 seconds
[0m01:17:43.492039 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:17:43.492707 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:17:43.494580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:43.497619 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:17:43.498087 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:17:43.499574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:43.501061 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:17:43.501501 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:17:43.501907 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:17:43.536628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.034 seconds
[0m01:17:43.539413 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:17:43.540335 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:17:43.540882 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:17:43.561989 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.021 seconds
[0m01:17:43.564018 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:17:43.564872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4752f94-82dd-4944-8f70-871443fccfe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca33f06f90>]}
[0m01:17:43.565713 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 249717[0m in 0.75s]
[0m01:17:43.566428 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:17:43.566998 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:17:43.567597 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:17:43.568152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:17:43.568620 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:17:43.571452 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:17:43.577081 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:17:43.581130 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:17:43.586919 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:17:43.587546 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:17:43.587981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:43.598352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:17:43.599291 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:17:43.599797 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:17:43.636509 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.036 seconds
[0m01:17:43.640052 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:17:43.640739 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:17:43.643072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:17:43.646155 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:17:43.646688 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:17:43.648404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:43.649861 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:17:43.650291 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:17:43.650688 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:17:43.661217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m01:17:43.663866 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:17:43.664628 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:17:43.665061 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:17:43.669580 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:17:43.671166 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:17:43.671881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4752f94-82dd-4944-8f70-871443fccfe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca33bf48c0>]}
[0m01:17:43.672631 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.10s]
[0m01:17:43.673366 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:17:43.674593 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:17:43.675510 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:17:43.676207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:17:43.676789 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:17:43.680216 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:17:43.686155 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:17:43.691496 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:17:43.697850 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:17:43.698526 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:17:43.698964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:43.709398 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:17:43.710100 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:17:43.710640 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_cleaned"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:17:43.713102 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "province" does not exist
LINE 17:     province,
             ^

[0m01:17:43.713839 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:17:43.715731 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:17:43.719288 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "province" does not exist
  LINE 17:     province,
               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:17:43.719976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4752f94-82dd-4944-8f70-871443fccfe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca33734290>]}
[0m01:17:43.720660 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m01:17:43.721436 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:17:43.722094 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "province" does not exist
  LINE 17:     province,
               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:17:43.724321 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:43.724899 [debug] [MainThread]: On master: BEGIN
[0m01:17:43.725337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:17:43.735320 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:17:43.735998 [debug] [MainThread]: On master: COMMIT
[0m01:17:43.736412 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:43.736826 [debug] [MainThread]: On master: COMMIT
[0m01:17:43.738214 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:17:43.738635 [debug] [MainThread]: On master: Close
[0m01:17:43.739287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:43.739727 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:17:43.740263 [info ] [MainThread]: 
[0m01:17:43.740765 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m01:17:43.742392 [debug] [MainThread]: Command end result
[0m01:17:43.768595 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:17:43.772921 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:17:43.782393 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:17:43.783003 [info ] [MainThread]: 
[0m01:17:43.783612 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:17:43.784296 [info ] [MainThread]: 
[0m01:17:43.785012 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:17:43.785625 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "province" does not exist
  LINE 17:     province,
               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:17:43.786113 [info ] [MainThread]: 
[0m01:17:43.786665 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:17:43.787185 [info ] [MainThread]: 
[0m01:17:43.787721 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:17:43.788914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5633311, "process_in_blocks": "0", "process_kernel_time": 0.385922, "process_mem_max_rss": "125316", "process_out_blocks": "0", "process_user_time": 2.826078}
[0m01:17:43.789681 [debug] [MainThread]: Command `dbt run` failed at 01:17:43.789524 after 2.56 seconds
[0m01:17:43.790283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca36457f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca35eec8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aca35b4e870>]}
[0m01:17:43.790908 [debug] [MainThread]: Flushing usage events
[0m01:17:44.631315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:03.266656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e80ec704a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e810a71ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e80e646990>]}


============================== 01:18:03.312400 | dd52e0c5-3644-4cae-8276-809a811465aa ==============================
[0m01:18:03.312400 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:18:03.313204 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'empty': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'no_print': 'None', 'printer_width': '80', 'invocation_command': 'dbt run', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'target_path': 'None', 'version_check': 'True', 'introspect': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:18:03.319455 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:18:03.502190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd52e0c5-3644-4cae-8276-809a811465aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e8106bddf0>]}
[0m01:18:03.558470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd52e0c5-3644-4cae-8276-809a811465aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e80db76720>]}
[0m01:18:03.559720 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:18:03.643489 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:18:03.807697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:18:03.808562 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/silver/fires_enriched.sql
[0m01:18:03.809096 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/silver/fires_daily.sql
[0m01:18:04.403201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd52e0c5-3644-4cae-8276-809a811465aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e80cf83e60>]}
[0m01:18:04.634491 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:18:04.649240 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:18:04.786806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd52e0c5-3644-4cae-8276-809a811465aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e80d834b60>]}
[0m01:18:04.787894 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:18:04.788933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd52e0c5-3644-4cae-8276-809a811465aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e80d7a6600>]}
[0m01:18:04.792580 [info ] [MainThread]: 
[0m01:18:04.793750 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:18:04.794892 [info ] [MainThread]: 
[0m01:18:04.796660 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:18:04.807540 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:18:04.888408 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:18:04.889505 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:18:04.890369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:04.907218 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.017 seconds
[0m01:18:04.909505 [debug] [ThreadPool]: On list_postgres: Close
[0m01:18:04.913302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:18:04.922694 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:18:04.923585 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:18:04.924272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:04.937799 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m01:18:04.938718 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:18:04.939389 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:18:04.946470 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m01:18:04.949682 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:18:04.951961 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:18:04.960496 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:04.961322 [debug] [MainThread]: On master: BEGIN
[0m01:18:04.962133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:04.974549 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m01:18:04.975470 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:04.976189 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:18:04.983255 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m01:18:04.985238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd52e0c5-3644-4cae-8276-809a811465aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e80da2fb30>]}
[0m01:18:04.986099 [debug] [MainThread]: On master: ROLLBACK
[0m01:18:04.987968 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:04.988646 [debug] [MainThread]: On master: BEGIN
[0m01:18:04.991716 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:18:04.992543 [debug] [MainThread]: On master: COMMIT
[0m01:18:04.993156 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:04.993716 [debug] [MainThread]: On master: COMMIT
[0m01:18:04.995882 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:18:04.996869 [debug] [MainThread]: On master: Close
[0m01:18:05.001731 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:18:05.002892 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:18:05.003930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:18:05.004966 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:18:05.019482 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:18:05.026630 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:18:05.076944 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:18:05.085270 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:18:05.086068 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:18:05.086694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:05.101242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:18:05.102205 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:18:05.103029 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:18:17.214307 [debug] [Thread-1 (]: SQL status: SELECT 262860 in 12.110 seconds
[0m01:18:17.223254 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:18:17.223832 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:18:17.226099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:18:17.230420 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:18:17.231045 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:18:17.232815 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:18:17.246659 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:18:17.247399 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:18:17.247813 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:18:17.542984 [debug] [Thread-1 (]: SQL status: COMMIT in 0.295 seconds
[0m01:18:17.549127 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:18:17.554387 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:18:17.554891 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:18:17.577553 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.022 seconds
[0m01:18:17.580180 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:18:17.581899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd52e0c5-3644-4cae-8276-809a811465aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e810657890>]}
[0m01:18:17.582633 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 262860[0m in 12.58s]
[0m01:18:17.583343 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:18:17.583890 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:18:17.584621 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:18:17.585254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:18:17.585746 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:18:17.589101 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:18:17.594600 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:18:17.598170 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:18:17.603476 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:18:17.604054 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:18:17.604442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:17.614715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:18:17.615457 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:18:17.616052 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:18:17.750393 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.134 seconds
[0m01:18:17.753949 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:18:17.754459 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:18:17.756072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:18:17.758616 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:18:17.759204 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:18:17.761417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:18:17.763786 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:18:17.764306 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:18:17.792840 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.028 seconds
[0m01:18:17.794993 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:18:17.795515 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:18:17.795972 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:18:18.418692 [debug] [Thread-1 (]: SQL status: COMMIT in 0.622 seconds
[0m01:18:18.421728 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:18:18.422608 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:18:18.423087 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:18:18.428026 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:18:18.429925 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:18:18.430636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd52e0c5-3644-4cae-8276-809a811465aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e80bbb58b0>]}
[0m01:18:18.431346 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.85s]
[0m01:18:18.432051 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:18:18.432575 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:18:18.433228 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:18:18.433859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:18:18.434487 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:18:18.437406 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:18:18.442939 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:18:18.447090 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:18:18.453114 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:18:18.453706 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:18:18.454104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:18.464885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:18:18.465582 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:18:18.466101 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region,

    ROW_NUMBER() OVER (
        PARTITION BY fc.acq_date, fc.latitude, fc.longitude
        ORDER BY fc.acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:18:39.327360 [debug] [Thread-1 (]: SQL status: SELECT 262860 in 20.862 seconds
[0m01:18:39.331558 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:18:39.332513 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:18:39.334952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:18:39.340003 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:18:39.340681 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:18:39.342432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:18:39.344189 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:18:39.344738 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:18:39.345191 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:18:41.071551 [debug] [Thread-1 (]: SQL status: COMMIT in 1.726 seconds
[0m01:18:41.074884 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:18:41.076222 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:18:41.077029 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:18:41.099091 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.021 seconds
[0m01:18:41.101142 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:18:41.102347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd52e0c5-3644-4cae-8276-809a811465aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e80b7f2fc0>]}
[0m01:18:41.108238 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 262860[0m in 22.67s]
[0m01:18:41.109376 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:18:41.109994 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:18:41.110767 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:18:41.111421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:18:41.111931 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:18:41.115483 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:18:41.122078 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:18:41.126957 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:18:41.133137 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:18:41.133990 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:18:41.134584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:41.147254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:18:41.147958 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:18:41.148474 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:18:41.233839 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.085 seconds
[0m01:18:41.238087 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:18:41.238678 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:18:41.240570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:18:41.243388 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:18:41.243871 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:18:41.245642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:18:41.247374 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:18:41.247856 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:18:41.248322 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:18:41.554141 [debug] [Thread-1 (]: SQL status: COMMIT in 0.305 seconds
[0m01:18:41.557190 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:18:41.558137 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:18:41.558612 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:18:41.662699 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.103 seconds
[0m01:18:41.664469 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:18:41.665222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd52e0c5-3644-4cae-8276-809a811465aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e80b7b4c80>]}
[0m01:18:41.669221 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.55s]
[0m01:18:41.670262 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:18:41.670860 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:18:41.671475 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:18:41.672082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:18:41.672550 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:18:41.675545 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:18:41.681195 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:18:41.684831 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:18:41.691095 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:18:41.691709 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:18:41.692121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:41.701882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:18:41.702709 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:18:41.703307 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:18:41.706182 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "intensity_level" does not exist
LINE 27:     COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as ...
                             ^

[0m01:18:41.706917 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: ROLLBACK
[0m01:18:41.708589 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:18:41.712346 [debug] [Thread-1 (]: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "intensity_level" does not exist
  LINE 27:     COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as ...
                               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:18:41.713154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd52e0c5-3644-4cae-8276-809a811465aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e80cfcedb0>]}
[0m01:18:41.713866 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public_public.fires_daily ................ [[31mERROR[0m in 0.04s]
[0m01:18:41.714593 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:18:41.715287 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_daily' to be skipped because of status 'error'.  Reason: Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "intensity_level" does not exist
  LINE 27:     COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as ...
                               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql.
[0m01:18:41.717755 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:41.718483 [debug] [MainThread]: On master: BEGIN
[0m01:18:41.718932 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:41.729476 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:18:41.730132 [debug] [MainThread]: On master: COMMIT
[0m01:18:41.730575 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:41.730929 [debug] [MainThread]: On master: COMMIT
[0m01:18:41.732158 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:18:41.732613 [debug] [MainThread]: On master: Close
[0m01:18:41.733243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:41.733763 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:18:41.734345 [info ] [MainThread]: 
[0m01:18:41.734872 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 36.94 seconds (36.94s).
[0m01:18:41.736955 [debug] [MainThread]: Command end result
[0m01:18:41.835369 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:18:41.839790 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:18:41.847660 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:18:41.848165 [info ] [MainThread]: 
[0m01:18:41.848757 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:18:41.849320 [info ] [MainThread]: 
[0m01:18:41.849906 [error] [MainThread]: [31mFailure in model fires_daily (models/silver/fires_daily.sql)[0m
[0m01:18:41.850594 [error] [MainThread]:   Database Error in model fires_daily (models/silver/fires_daily.sql)
  column "intensity_level" does not exist
  LINE 27:     COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as ...
                               ^
  compiled code at target/run/fires_dbt/models/silver/fires_daily.sql
[0m01:18:41.851256 [info ] [MainThread]: 
[0m01:18:41.852000 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/silver/fires_daily.sql
[0m01:18:41.852648 [info ] [MainThread]: 
[0m01:18:41.853272 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m01:18:41.854590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 38.648685, "process_in_blocks": "0", "process_kernel_time": 0.46832, "process_mem_max_rss": "128756", "process_out_blocks": "0", "process_user_time": 3.585076}
[0m01:18:41.855188 [debug] [MainThread]: Command `dbt run` failed at 01:18:41.855081 after 38.65 seconds
[0m01:18:41.855733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e80e9740e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e80e304ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e8120d8230>]}
[0m01:18:41.856267 [debug] [MainThread]: Flushing usage events
[0m01:18:42.878013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:19.155313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c73c631ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c73a273b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c73a902d20>]}


============================== 01:19:19.198012 | 17a979b9-821a-4ddf-9ff5-2a5e37f2b838 ==============================
[0m01:19:19.198012 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:19:19.198698 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'target_path': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run', 'debug': 'False', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None', 'partial_parse': 'True', 'log_format': 'default', 'introspect': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'indirect_selection': 'eager', 'quiet': 'False', 'version_check': 'True', 'fail_fast': 'False'}
[0m01:19:19.204667 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:19:19.366677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17a979b9-821a-4ddf-9ff5-2a5e37f2b838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c7398cf410>]}
[0m01:19:19.421176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17a979b9-821a-4ddf-9ff5-2a5e37f2b838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c73ac34ec0>]}
[0m01:19:19.422348 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:19:19.507403 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:19:19.658341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:19:19.659476 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/silver/fires_enriched.sql
[0m01:19:19.888155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17a979b9-821a-4ddf-9ff5-2a5e37f2b838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c738bf6e70>]}
[0m01:19:19.952775 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:19:19.957206 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:19:19.995115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17a979b9-821a-4ddf-9ff5-2a5e37f2b838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c739509e20>]}
[0m01:19:19.995809 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:19:19.996331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17a979b9-821a-4ddf-9ff5-2a5e37f2b838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c738ba41a0>]}
[0m01:19:19.998294 [info ] [MainThread]: 
[0m01:19:19.998848 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:19:19.999351 [info ] [MainThread]: 
[0m01:19:20.000048 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:19:20.004033 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:19:20.054490 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:19:20.055185 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:19:20.055714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:20.066976 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m01:19:20.068625 [debug] [ThreadPool]: On list_postgres: Close
[0m01:19:20.070391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:19:20.075795 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:19:20.076455 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:19:20.076887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:20.086817 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:19:20.087491 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:19:20.087932 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:19:20.092239 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m01:19:20.094069 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:19:20.095698 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:19:20.100579 [debug] [MainThread]: Using postgres connection "master"
[0m01:19:20.101097 [debug] [MainThread]: On master: BEGIN
[0m01:19:20.101564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:20.111190 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:19:20.111843 [debug] [MainThread]: Using postgres connection "master"
[0m01:19:20.112368 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:19:20.117271 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:19:20.118679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17a979b9-821a-4ddf-9ff5-2a5e37f2b838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c738ef6fc0>]}
[0m01:19:20.119255 [debug] [MainThread]: On master: ROLLBACK
[0m01:19:20.120536 [debug] [MainThread]: Using postgres connection "master"
[0m01:19:20.120942 [debug] [MainThread]: On master: BEGIN
[0m01:19:20.122698 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:19:20.123175 [debug] [MainThread]: On master: COMMIT
[0m01:19:20.123585 [debug] [MainThread]: Using postgres connection "master"
[0m01:19:20.123946 [debug] [MainThread]: On master: COMMIT
[0m01:19:20.125365 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:19:20.125912 [debug] [MainThread]: On master: Close
[0m01:19:20.129274 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:19:20.130035 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:19:20.130692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:19:20.131234 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:19:20.138058 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:19:20.144520 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:19:20.177792 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:19:20.183883 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:19:20.184433 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:19:20.184876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:20.194916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:19:20.195717 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:19:20.196361 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:19:24.856460 [debug] [Thread-1 (]: SQL status: SELECT 276003 in 4.659 seconds
[0m01:19:24.865530 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:19:24.866279 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:19:24.868218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:19:24.871995 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:19:24.872446 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:19:24.873992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:19:24.888045 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:19:24.888774 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:19:24.889205 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:19:24.911606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m01:19:24.917882 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:19:24.923383 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:19:24.923952 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:19:24.943716 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.019 seconds
[0m01:19:24.946510 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:19:24.948910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a979b9-821a-4ddf-9ff5-2a5e37f2b838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c73772f0b0>]}
[0m01:19:24.949807 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 276003[0m in 4.82s]
[0m01:19:24.950544 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:19:24.951230 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:19:24.951880 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:19:24.952707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:19:24.953203 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:19:24.956644 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:19:24.961576 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:19:24.965352 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:19:24.971106 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:19:24.971702 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:19:24.972188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:24.982065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:19:24.982847 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:19:24.983478 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:19:25.011487 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.027 seconds
[0m01:19:25.015419 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:19:25.016048 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:19:25.017785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:19:25.020603 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:19:25.021103 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:19:25.022646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:19:25.024723 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:19:25.025254 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:19:25.056698 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.031 seconds
[0m01:19:25.058943 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:19:25.059669 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:19:25.060195 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:19:25.076517 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m01:19:25.079402 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:19:25.080416 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:19:25.080939 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:19:25.085473 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:19:25.087231 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:19:25.088059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a979b9-821a-4ddf-9ff5-2a5e37f2b838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c737b1d460>]}
[0m01:19:25.088861 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.14s]
[0m01:19:25.089695 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:19:25.090220 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:19:25.090900 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:19:25.091582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:19:25.092085 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:19:25.095057 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:19:25.100764 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:19:25.104298 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:19:25.110117 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:19:25.110755 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:19:25.111238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:25.121984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:19:25.122806 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:19:25.123388 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region,

    CASE
        WHEN fc.frp >= 50 THEN 'Alta'
        WHEN fc.frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,

    ROW_NUMBER() OVER (
        PARTITION BY fc.acq_date, fc.latitude, fc.longitude
        ORDER BY fc.acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:19:26.089619 [debug] [Thread-1 (]: SQL status: SELECT 276003 in 0.966 seconds
[0m01:19:26.093297 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:19:26.093882 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:19:26.095751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:19:26.100565 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:19:26.101194 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:19:26.103023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:19:26.104586 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:19:26.105067 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:19:26.105492 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:19:26.135421 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m01:19:26.138166 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:19:26.139085 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:19:26.139519 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:19:26.161168 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.021 seconds
[0m01:19:26.163026 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:19:26.164039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a979b9-821a-4ddf-9ff5-2a5e37f2b838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c7377b8f50>]}
[0m01:19:26.164999 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 276003[0m in 1.07s]
[0m01:19:26.165977 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:19:26.166549 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:19:26.167252 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:19:26.167903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:19:26.168342 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:19:26.171332 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:19:26.177094 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:19:26.180930 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:19:26.187126 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:19:26.187765 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:19:26.188208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:26.198239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:19:26.199252 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:19:26.199815 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:19:26.236303 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.036 seconds
[0m01:19:26.239992 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:19:26.240537 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:19:26.242263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:19:26.244997 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:19:26.245519 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:19:26.247204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:19:26.249206 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:19:26.249760 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:19:26.250183 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:19:26.261429 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m01:19:26.264215 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:19:26.265211 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:19:26.265722 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:19:26.270413 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:19:26.271982 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:19:26.272683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a979b9-821a-4ddf-9ff5-2a5e37f2b838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c737788c50>]}
[0m01:19:26.273419 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.10s]
[0m01:19:26.274161 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:19:26.274737 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:19:26.275346 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:19:26.275992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:19:26.276489 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:19:26.279411 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:19:26.285610 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:19:26.289242 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:19:26.294585 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:19:26.295121 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:19:26.295569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:19:26.306345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:19:26.307121 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:19:26.307665 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:19:26.611750 [debug] [Thread-1 (]: SQL status: SELECT 1042 in 0.303 seconds
[0m01:19:26.615475 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:19:26.616231 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */
alter table "postgres"."public_public"."fires_daily__dbt_tmp" rename to "fires_daily"
[0m01:19:26.617944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:19:26.619435 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: COMMIT
[0m01:19:26.619878 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:19:26.620295 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: COMMIT
[0m01:19:26.623089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:19:26.625641 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_daily__dbt_backup"
[0m01:19:26.626530 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:19:26.627017 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */
drop table if exists "postgres"."public_public"."fires_daily__dbt_backup" cascade
[0m01:19:26.628652 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m01:19:26.630134 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:19:26.630970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17a979b9-821a-4ddf-9ff5-2a5e37f2b838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c7377a6090>]}
[0m01:19:26.631737 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public_public.fires_daily .................... [[32mSELECT 1042[0m in 0.35s]
[0m01:19:26.632610 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:19:26.634396 [debug] [MainThread]: Using postgres connection "master"
[0m01:19:26.634951 [debug] [MainThread]: On master: BEGIN
[0m01:19:26.635388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:19:26.644348 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:19:26.645010 [debug] [MainThread]: On master: COMMIT
[0m01:19:26.645460 [debug] [MainThread]: Using postgres connection "master"
[0m01:19:26.645907 [debug] [MainThread]: On master: COMMIT
[0m01:19:26.647271 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:19:26.647837 [debug] [MainThread]: On master: Close
[0m01:19:26.648448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:26.648860 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:19:26.649440 [info ] [MainThread]: 
[0m01:19:26.649973 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 6.65 seconds (6.65s).
[0m01:19:26.651502 [debug] [MainThread]: Command end result
[0m01:19:26.743533 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:19:26.748225 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:19:26.756721 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:19:26.757312 [info ] [MainThread]: 
[0m01:19:26.757842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:19:26.758327 [info ] [MainThread]: 
[0m01:19:26.758869 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m01:19:26.760213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6648765, "process_in_blocks": "0", "process_kernel_time": 0.444088, "process_mem_max_rss": "128364", "process_out_blocks": "0", "process_user_time": 2.936586}
[0m01:19:26.760968 [debug] [MainThread]: Command `dbt run` succeeded at 01:19:26.760863 after 7.67 seconds
[0m01:19:26.762583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c73a9a2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c73ad39820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c7377b7aa0>]}
[0m01:19:26.763545 [debug] [MainThread]: Flushing usage events
[0m01:19:27.595234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:20:03.052650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c68279970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c6876c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c68c11100>]}


============================== 01:20:03.090123 | d8d9a5cc-5a78-483f-b0f7-bf2f5d27b6c4 ==============================
[0m01:20:03.090123 [info ] [MainThread]: Running with dbt=1.10.11
[0m01:20:03.090842 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'static_parser': 'True', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'printer_width': '80', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'log_format': 'default', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'use_colors': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'quiet': 'False'}
[0m01:20:03.096007 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m01:20:03.257810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8d9a5cc-5a78-483f-b0f7-bf2f5d27b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c67b3a240>]}
[0m01:20:03.314111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8d9a5cc-5a78-483f-b0f7-bf2f5d27b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c68d43170>]}
[0m01:20:03.315282 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:20:03.400058 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m01:20:03.545977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:20:03.546604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:20:03.575779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8d9a5cc-5a78-483f-b0f7-bf2f5d27b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c67baebd0>]}
[0m01:20:03.644204 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:20:03.648520 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:20:03.684029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8d9a5cc-5a78-483f-b0f7-bf2f5d27b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c683b5400>]}
[0m01:20:03.684656 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m01:20:03.685147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d9a5cc-5a78-483f-b0f7-bf2f5d27b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c6892dc40>]}
[0m01:20:03.687113 [info ] [MainThread]: 
[0m01:20:03.687768 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m01:20:03.688251 [info ] [MainThread]: 
[0m01:20:03.688906 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:20:03.692784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m01:20:03.743138 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m01:20:03.743965 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m01:20:03.744524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:03.760502 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.016 seconds
[0m01:20:03.762274 [debug] [ThreadPool]: On list_postgres: Close
[0m01:20:03.764354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m01:20:03.772788 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:20:03.773628 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m01:20:03.774337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:03.785854 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m01:20:03.786975 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m01:20:03.787696 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m01:20:03.792424 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m01:20:03.794746 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m01:20:03.796736 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m01:20:03.802996 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:03.804166 [debug] [MainThread]: On master: BEGIN
[0m01:20:03.804934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:03.817072 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m01:20:03.817819 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:03.819235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:20:03.825341 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:20:03.827093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d9a5cc-5a78-483f-b0f7-bf2f5d27b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c66708380>]}
[0m01:20:03.827793 [debug] [MainThread]: On master: ROLLBACK
[0m01:20:03.829364 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:03.829928 [debug] [MainThread]: On master: BEGIN
[0m01:20:03.832315 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:20:03.832878 [debug] [MainThread]: On master: COMMIT
[0m01:20:03.833426 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:03.833857 [debug] [MainThread]: On master: COMMIT
[0m01:20:03.835188 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:20:03.835921 [debug] [MainThread]: On master: Close
[0m01:20:03.839797 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m01:20:03.840664 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m01:20:03.841487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m01:20:03.842022 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m01:20:03.852664 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m01:20:03.859565 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m01:20:03.893633 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m01:20:03.899614 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:20:03.900145 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m01:20:03.900605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:03.912238 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:20:03.913087 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:20:03.913816 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m01:20:03.942912 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m01:20:03.952437 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:20:03.953187 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m01:20:03.955242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:03.958429 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:20:03.958928 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m01:20:03.960553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:03.975225 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:20:03.975934 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:20:03.976401 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m01:20:03.987882 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m01:20:03.994722 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m01:20:04.000889 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m01:20:04.001633 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m01:20:04.023518 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.021 seconds
[0m01:20:04.026632 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m01:20:04.028463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d9a5cc-5a78-483f-b0f7-bf2f5d27b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c6a717a40>]}
[0m01:20:04.029289 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 13143[0m in 0.19s]
[0m01:20:04.030068 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m01:20:04.030704 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m01:20:04.031403 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m01:20:04.031993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m01:20:04.032466 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m01:20:04.035985 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m01:20:04.041427 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m01:20:04.045326 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m01:20:04.050102 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:20:04.050722 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m01:20:04.051246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:04.061522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:20:04.062205 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:20:04.062786 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m01:20:04.092025 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.029 seconds
[0m01:20:04.095666 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:20:04.096179 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m01:20:04.097891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:04.100895 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:20:04.101380 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m01:20:04.103170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:04.105740 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:20:04.106388 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m01:20:04.135103 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.028 seconds
[0m01:20:04.137496 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:20:04.138252 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:20:04.138770 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m01:20:04.157991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m01:20:04.160877 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m01:20:04.161857 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m01:20:04.162324 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m01:20:04.166245 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m01:20:04.167816 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m01:20:04.168524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d9a5cc-5a78-483f-b0f7-bf2f5d27b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c66745bb0>]}
[0m01:20:04.169262 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.14s]
[0m01:20:04.170095 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m01:20:04.170721 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m01:20:04.171387 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m01:20:04.171960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m01:20:04.172472 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m01:20:04.177100 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m01:20:04.182895 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m01:20:04.186253 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m01:20:04.192598 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:20:04.193312 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m01:20:04.193784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:04.203373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m01:20:04.204463 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:20:04.205100 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region,

    CASE
        WHEN fc.frp >= 50 THEN 'Alta'
        WHEN fc.frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,

    ROW_NUMBER() OVER (
        PARTITION BY fc.acq_date, fc.latitude, fc.longitude
        ORDER BY fc.acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m01:20:04.246258 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.041 seconds
[0m01:20:04.249976 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:20:04.250527 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m01:20:04.252072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:04.254980 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:20:04.255562 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m01:20:04.257353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:04.258872 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:20:04.259327 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:20:04.259793 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m01:20:04.265564 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m01:20:04.267860 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m01:20:04.268604 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m01:20:04.269078 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m01:20:04.291933 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.022 seconds
[0m01:20:04.293804 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m01:20:04.294661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d9a5cc-5a78-483f-b0f7-bf2f5d27b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c65f0f4d0>]}
[0m01:20:04.295359 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 13143[0m in 0.12s]
[0m01:20:04.296111 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m01:20:04.296629 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m01:20:04.297260 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m01:20:04.297799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m01:20:04.298264 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m01:20:04.300981 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m01:20:04.306623 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m01:20:04.310162 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m01:20:04.315352 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:20:04.315831 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m01:20:04.316240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:04.326081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:20:04.327336 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:20:04.327963 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m01:20:04.364390 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.036 seconds
[0m01:20:04.367908 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:20:04.368446 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m01:20:04.370442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:04.373803 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:20:04.374390 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m01:20:04.376376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:04.378485 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:20:04.379123 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:20:04.379697 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m01:20:04.438556 [debug] [Thread-1 (]: SQL status: COMMIT in 0.058 seconds
[0m01:20:04.441310 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m01:20:04.442281 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m01:20:04.442757 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m01:20:04.447615 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m01:20:04.449350 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m01:20:04.450377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d9a5cc-5a78-483f-b0f7-bf2f5d27b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c673b8bc0>]}
[0m01:20:04.451249 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.15s]
[0m01:20:04.451908 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m01:20:04.452387 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m01:20:04.453159 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m01:20:04.454059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m01:20:04.454608 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m01:20:04.458152 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m01:20:04.463002 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m01:20:04.467815 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m01:20:04.473534 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:20:04.474125 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m01:20:04.474546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:20:04.485213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:20:04.485873 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:20:04.486464 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m01:20:04.512317 [debug] [Thread-1 (]: SQL status: SELECT 1042 in 0.025 seconds
[0m01:20:04.515694 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:20:04.516179 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */
alter table "postgres"."public_public"."fires_daily" rename to "fires_daily__dbt_backup"
[0m01:20:04.517937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:04.521105 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:20:04.521713 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */
alter table "postgres"."public_public"."fires_daily__dbt_tmp" rename to "fires_daily"
[0m01:20:04.523417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:04.525232 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: COMMIT
[0m01:20:04.525904 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:20:04.526432 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: COMMIT
[0m01:20:04.529441 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m01:20:04.532009 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_daily__dbt_backup"
[0m01:20:04.532858 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m01:20:04.533292 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */
drop table if exists "postgres"."public_public"."fires_daily__dbt_backup" cascade
[0m01:20:04.537083 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m01:20:04.538981 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m01:20:04.540066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d9a5cc-5a78-483f-b0f7-bf2f5d27b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c65f28110>]}
[0m01:20:04.541753 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public_public.fires_daily .................... [[32mSELECT 1042[0m in 0.09s]
[0m01:20:04.542812 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m01:20:04.544476 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:04.544975 [debug] [MainThread]: On master: BEGIN
[0m01:20:04.545388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:04.555175 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:20:04.555953 [debug] [MainThread]: On master: COMMIT
[0m01:20:04.556421 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:04.556906 [debug] [MainThread]: On master: COMMIT
[0m01:20:04.558243 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:20:04.558690 [debug] [MainThread]: On master: Close
[0m01:20:04.559282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:04.559690 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m01:20:04.560165 [info ] [MainThread]: 
[0m01:20:04.560618 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m01:20:04.561937 [debug] [MainThread]: Command end result
[0m01:20:04.587228 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m01:20:04.591713 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m01:20:04.599488 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m01:20:04.599962 [info ] [MainThread]: 
[0m01:20:04.600467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:20:04.600935 [info ] [MainThread]: 
[0m01:20:04.601551 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m01:20:04.602745 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6092286, "process_in_blocks": "0", "process_kernel_time": 0.412059, "process_mem_max_rss": "124752", "process_out_blocks": "0", "process_user_time": 2.764399}
[0m01:20:04.603509 [debug] [MainThread]: Command `dbt run` succeeded at 01:20:04.603380 after 1.61 seconds
[0m01:20:04.604060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c68f82de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c68dd6e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716c68d3c590>]}
[0m01:20:04.604550 [debug] [MainThread]: Flushing usage events
[0m01:20:05.588319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:54:45.491965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78650a99e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78650a2c4da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78650a2adaf0>]}


============================== 02:54:45.530718 | bbe28686-9af5-4849-83c5-a41cc05a42c5 ==============================
[0m02:54:45.530718 [info ] [MainThread]: Running with dbt=1.10.11
[0m02:54:45.531490 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_format': 'default', 'static_parser': 'True', 'quiet': 'False', 'no_print': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'indirect_selection': 'eager', 'warn_error': 'None', 'empty': 'False', 'invocation_command': 'dbt run --target default', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'target_path': 'None', 'introspect': 'True'}
[0m02:54:45.806847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbe28686-9af5-4849-83c5-a41cc05a42c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786509537650>]}
[0m02:54:45.858806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbe28686-9af5-4849-83c5-a41cc05a42c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78650bfc6990>]}
[0m02:54:45.860616 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:54:45.946808 [debug] [MainThread]: checksum: a2c7fdd2820eaf5e12b4c16ff21fd54c082ab081252f73bfd9edd48ce00aac03, vars: {}, profile: , target: default, version: 1.10.11
[0m02:54:46.019511 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:54:46.020100 [debug] [MainThread]: previous checksum: a2c7fdd2820eaf5e12b4c16ff21fd54c082ab081252f73bfd9edd48ce00aac03, current checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9
[0m02:54:46.020739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bbe28686-9af5-4849-83c5-a41cc05a42c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865091f0140>]}
[0m02:54:47.034229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbe28686-9af5-4849-83c5-a41cc05a42c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78650854c830>]}
[0m02:54:47.092984 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m02:54:47.097830 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m02:54:47.145273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbe28686-9af5-4849-83c5-a41cc05a42c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786509537f20>]}
[0m02:54:47.145919 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m02:54:47.146399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe28686-9af5-4849-83c5-a41cc05a42c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78650956aa50>]}
[0m02:54:47.148435 [info ] [MainThread]: 
[0m02:54:47.148962 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m02:54:47.149455 [info ] [MainThread]: 
[0m02:54:47.150169 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:54:47.154365 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m02:54:47.212277 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m02:54:47.212918 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m02:54:47.213335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:47.226520 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m02:54:47.228279 [debug] [ThreadPool]: On list_postgres: Close
[0m02:54:47.230142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m02:54:47.236988 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m02:54:47.237659 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m02:54:47.238153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:54:47.248314 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m02:54:47.249033 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m02:54:47.249596 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m02:54:47.253960 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m02:54:47.255676 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m02:54:47.257319 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m02:54:47.263280 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:47.263925 [debug] [MainThread]: On master: BEGIN
[0m02:54:47.264512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:54:47.274737 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m02:54:47.275483 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:47.276071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:54:47.281731 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m02:54:47.283293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe28686-9af5-4849-83c5-a41cc05a42c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786508914530>]}
[0m02:54:47.284025 [debug] [MainThread]: On master: ROLLBACK
[0m02:54:47.285471 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:47.285914 [debug] [MainThread]: On master: BEGIN
[0m02:54:47.287912 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m02:54:47.288312 [debug] [MainThread]: On master: COMMIT
[0m02:54:47.288718 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:47.289072 [debug] [MainThread]: On master: COMMIT
[0m02:54:47.290108 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m02:54:47.290508 [debug] [MainThread]: On master: Close
[0m02:54:47.294877 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m02:54:47.295605 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m02:54:47.296243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m02:54:47.296773 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m02:54:47.305348 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m02:54:47.311682 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m02:54:47.344533 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m02:54:47.350516 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m02:54:47.351102 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m02:54:47.351601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:47.361039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:54:47.361810 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m02:54:47.362406 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m02:54:47.423761 [debug] [Thread-1 (]: SQL status: SELECT 26286 in 0.061 seconds
[0m02:54:47.434359 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m02:54:47.434911 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m02:54:47.436642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:54:47.439394 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m02:54:47.439834 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m02:54:47.441389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:54:47.454854 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m02:54:47.455395 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m02:54:47.455910 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m02:54:47.470105 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m02:54:47.476183 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m02:54:47.481647 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m02:54:47.482339 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m02:54:47.487521 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m02:54:47.490036 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m02:54:47.492347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe28686-9af5-4849-83c5-a41cc05a42c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78650c0b37d0>]}
[0m02:54:47.494448 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 26286[0m in 0.19s]
[0m02:54:47.495241 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m02:54:47.495764 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m02:54:47.496445 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m02:54:47.497006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m02:54:47.497455 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m02:54:47.500899 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m02:54:47.505625 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m02:54:47.509273 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m02:54:47.514024 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m02:54:47.514576 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m02:54:47.515041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:47.524869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:54:47.525669 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m02:54:47.526325 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m02:54:47.554228 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.027 seconds
[0m02:54:47.557959 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m02:54:47.558580 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m02:54:47.560298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:54:47.563322 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m02:54:47.563777 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m02:54:47.565174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:54:47.567246 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m02:54:47.567729 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m02:54:47.598095 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.030 seconds
[0m02:54:47.600050 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m02:54:47.600575 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m02:54:47.601058 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m02:54:47.622351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m02:54:47.625213 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m02:54:47.626046 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m02:54:47.626516 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m02:54:47.630547 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:54:47.632187 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m02:54:47.632901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe28686-9af5-4849-83c5-a41cc05a42c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78650aa1c5c0>]}
[0m02:54:47.633604 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.14s]
[0m02:54:47.634379 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m02:54:47.634932 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m02:54:47.635579 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m02:54:47.636211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m02:54:47.636695 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m02:54:47.639703 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m02:54:47.645113 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m02:54:47.649124 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m02:54:47.654826 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m02:54:47.655442 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m02:54:47.655905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:47.666332 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:54:47.667044 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m02:54:47.667607 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region,

    CASE
        WHEN fc.frp >= 50 THEN 'Alta'
        WHEN fc.frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,

    ROW_NUMBER() OVER (
        PARTITION BY fc.acq_date, fc.latitude, fc.longitude
        ORDER BY fc.acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m02:54:47.759919 [debug] [Thread-1 (]: SQL status: SELECT 26286 in 0.092 seconds
[0m02:54:47.765290 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m02:54:47.765936 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m02:54:47.781438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m02:54:47.784939 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m02:54:47.785571 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m02:54:47.787377 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:54:47.789000 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m02:54:47.789472 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m02:54:47.789891 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m02:54:47.792016 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:54:47.794462 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m02:54:47.795434 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m02:54:47.795863 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m02:54:47.799480 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:54:47.800991 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m02:54:47.801707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe28686-9af5-4849-83c5-a41cc05a42c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865075fb350>]}
[0m02:54:47.802478 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 26286[0m in 0.17s]
[0m02:54:47.803132 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m02:54:47.803630 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m02:54:47.804263 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m02:54:47.804840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m02:54:47.805311 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m02:54:47.808199 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m02:54:47.813412 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m02:54:47.817034 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m02:54:47.822292 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m02:54:47.822756 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m02:54:47.823234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:47.833671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:54:47.834380 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m02:54:47.834955 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m02:54:47.873019 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.037 seconds
[0m02:54:47.877092 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m02:54:47.877653 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m02:54:47.879579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:54:47.882445 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m02:54:47.882951 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m02:54:47.884473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:54:47.885963 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m02:54:47.886409 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m02:54:47.886880 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m02:54:47.960028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.073 seconds
[0m02:54:47.962707 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m02:54:47.963539 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m02:54:47.963966 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m02:54:47.967645 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:54:47.968951 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m02:54:47.969703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe28686-9af5-4849-83c5-a41cc05a42c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78650792e150>]}
[0m02:54:47.972801 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.16s]
[0m02:54:47.973659 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m02:54:47.974160 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m02:54:47.974713 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m02:54:47.975341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m02:54:47.975854 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m02:54:47.978870 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m02:54:47.983942 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m02:54:47.987247 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m02:54:47.992322 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m02:54:47.992863 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m02:54:47.993341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:48.003336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:54:48.003985 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m02:54:48.004454 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m02:54:48.048424 [debug] [Thread-1 (]: SQL status: SELECT 1042 in 0.043 seconds
[0m02:54:48.051916 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m02:54:48.052450 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */
alter table "postgres"."public_public"."fires_daily" rename to "fires_daily__dbt_backup"
[0m02:54:48.054147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:54:48.057984 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m02:54:48.058541 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */
alter table "postgres"."public_public"."fires_daily__dbt_tmp" rename to "fires_daily"
[0m02:54:48.060139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:54:48.061642 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: COMMIT
[0m02:54:48.062195 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m02:54:48.062904 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: COMMIT
[0m02:54:48.065857 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:54:48.068376 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_daily__dbt_backup"
[0m02:54:48.069112 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m02:54:48.069604 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */
drop table if exists "postgres"."public_public"."fires_daily__dbt_backup" cascade
[0m02:54:48.072800 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:54:48.074243 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m02:54:48.075037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe28686-9af5-4849-83c5-a41cc05a42c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786507103a10>]}
[0m02:54:48.075780 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public_public.fires_daily .................... [[32mSELECT 1042[0m in 0.10s]
[0m02:54:48.076564 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m02:54:48.078173 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:48.078626 [debug] [MainThread]: On master: BEGIN
[0m02:54:48.079106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:54:48.088152 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m02:54:48.088768 [debug] [MainThread]: On master: COMMIT
[0m02:54:48.089185 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:48.089524 [debug] [MainThread]: On master: COMMIT
[0m02:54:48.090707 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m02:54:48.091198 [debug] [MainThread]: On master: Close
[0m02:54:48.091857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:54:48.092239 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m02:54:48.092880 [info ] [MainThread]: 
[0m02:54:48.093568 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m02:54:48.095502 [debug] [MainThread]: Command end result
[0m02:54:48.119604 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m02:54:48.123751 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m02:54:48.132526 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m02:54:48.133086 [info ] [MainThread]: 
[0m02:54:48.133679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:54:48.134302 [info ] [MainThread]: 
[0m02:54:48.134873 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m02:54:48.136553 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.704989, "process_in_blocks": "66408", "process_kernel_time": 0.457442, "process_mem_max_rss": "128760", "process_out_blocks": "0", "process_user_time": 3.511073}
[0m02:54:48.137160 [debug] [MainThread]: Command `dbt run` succeeded at 02:54:48.137013 after 2.71 seconds
[0m02:54:48.137650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78650dd93080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865091f33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78650921b440>]}
[0m02:54:48.138156 [debug] [MainThread]: Flushing usage events
[0m02:54:49.061315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:03:56.490822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b84703d6b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846ef20ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846ef28d40>]}


============================== 03:03:56.534564 | 4d20f832-f740-41ef-a6d1-88987cff2eeb ==============================
[0m03:03:56.534564 [info ] [MainThread]: Running with dbt=1.10.11
[0m03:03:56.535409 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'write_json': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'printer_width': '80', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'introspect': 'True', 'quiet': 'False'}
[0m03:03:56.541557 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m03:03:56.823212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d20f832-f740-41ef-a6d1-88987cff2eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846e3c6510>]}
[0m03:03:56.876420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d20f832-f740-41ef-a6d1-88987cff2eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846e4987a0>]}
[0m03:03:56.877904 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m03:03:56.971729 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m03:03:57.048246 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m03:03:57.049052 [debug] [MainThread]: previous checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, current checksum: a2c7fdd2820eaf5e12b4c16ff21fd54c082ab081252f73bfd9edd48ce00aac03
[0m03:03:57.049705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4d20f832-f740-41ef-a6d1-88987cff2eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846e118350>]}
[0m03:03:58.121344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d20f832-f740-41ef-a6d1-88987cff2eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846d5ecef0>]}
[0m03:03:58.186555 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m03:03:58.191581 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m03:03:58.242147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d20f832-f740-41ef-a6d1-88987cff2eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846e129790>]}
[0m03:03:58.242825 [info ] [MainThread]: Found 5 models, 2 sources, 434 macros
[0m03:03:58.243309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d20f832-f740-41ef-a6d1-88987cff2eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846e4b7140>]}
[0m03:03:58.245282 [info ] [MainThread]: 
[0m03:03:58.246009 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m03:03:58.246544 [info ] [MainThread]: 
[0m03:03:58.247320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:03:58.251863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m03:03:58.310513 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m03:03:58.311168 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m03:03:58.311610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:03:58.323934 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m03:03:58.325597 [debug] [ThreadPool]: On list_postgres: Close
[0m03:03:58.327328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m03:03:58.332706 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m03:03:58.333359 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m03:03:58.333835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:03:58.343616 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m03:03:58.344346 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m03:03:58.344802 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m03:03:58.349130 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m03:03:58.350961 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m03:03:58.352498 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m03:03:58.358936 [debug] [MainThread]: Using postgres connection "master"
[0m03:03:58.359597 [debug] [MainThread]: On master: BEGIN
[0m03:03:58.360121 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:03:58.370551 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m03:03:58.371293 [debug] [MainThread]: Using postgres connection "master"
[0m03:03:58.371825 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m03:03:58.377405 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m03:03:58.378910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d20f832-f740-41ef-a6d1-88987cff2eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846e1281a0>]}
[0m03:03:58.379531 [debug] [MainThread]: On master: ROLLBACK
[0m03:03:58.380997 [debug] [MainThread]: Using postgres connection "master"
[0m03:03:58.381439 [debug] [MainThread]: On master: BEGIN
[0m03:03:58.383873 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m03:03:58.384509 [debug] [MainThread]: On master: COMMIT
[0m03:03:58.385057 [debug] [MainThread]: Using postgres connection "master"
[0m03:03:58.385511 [debug] [MainThread]: On master: COMMIT
[0m03:03:58.386915 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m03:03:58.387387 [debug] [MainThread]: On master: Close
[0m03:03:58.391880 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_data_silver
[0m03:03:58.392608 [info ] [Thread-1 (]: 1 of 5 START sql table model public_public.fires_data_silver ................... [RUN]
[0m03:03:58.393402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_data_silver)
[0m03:03:58.393983 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_data_silver
[0m03:03:58.401420 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_data_silver"
[0m03:03:58.407501 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_data_silver
[0m03:03:58.445822 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_data_silver"
[0m03:03:58.451489 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m03:03:58.452097 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: BEGIN
[0m03:03:58.452554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:03:58.463265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m03:03:58.464084 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m03:03:58.464747 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */

  
    

  create  table "postgres"."public_public"."fires_data_silver__dbt_tmp"
  
  
    as
  
  (
    

-- Transición de Bronze a Silver: agregar provincia
SELECT
    CAST(latitude AS FLOAT) AS latitude,
    CAST(longitude AS FLOAT) AS longitude,
    CAST(brightness AS FLOAT) AS brightness,
    CAST(scan AS FLOAT) AS scan,
    CAST(track AS FLOAT) AS track,
    CAST(acq_date AS DATE) AS acq_date,
    CAST(acq_time AS VARCHAR(10)) AS acq_time,
    CAST(satellite AS VARCHAR(10)) AS satellite,
    CAST(instrument AS VARCHAR(10)) AS instrument,
    CAST(confidence AS INTEGER) AS confidence,
    CAST(version AS VARCHAR(10)) AS version,
    CAST(bright_t31 AS FLOAT) AS bright_t31,
    CAST(frp AS FLOAT) AS frp,
    CAST(daynight AS VARCHAR(5)) AS daynight,
    ingested_at,
    validation_status,
    source_file,
    processing_date,
    CAST(data_quality_score AS INTEGER) AS data_quality_score,
    CASE
        WHEN CAST(latitude AS FLOAT) BETWEEN -41.0 AND -33.5 AND CAST(longitude AS FLOAT) BETWEEN -63.5 AND -56.5 THEN 'Buenos Aires'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -29.5 AND CAST(longitude AS FLOAT) BETWEEN -65.5 AND -61.5 THEN 'Córdoba'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.5 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -62.5 AND -58.5 THEN 'Santa Fe'
        WHEN CAST(latitude AS FLOAT) BETWEEN -34.0 AND -30.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Entre Ríos'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.5 AND -27.0 AND CAST(longitude AS FLOAT) BETWEEN -59.0 AND -56.0 THEN 'Corrientes'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -25.5 AND CAST(longitude AS FLOAT) BETWEEN -56.0 AND -53.5 THEN 'Misiones'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -63.0 AND -58.5 THEN 'Chaco'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.5 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -60.0 AND -57.5 THEN 'Formosa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -26.0 AND -22.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -63.5 THEN 'Salta'
        WHEN CAST(latitude AS FLOAT) BETWEEN -24.5 AND -21.5 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Jujuy'
        WHEN CAST(latitude AS FLOAT) BETWEEN -28.5 AND -26.0 AND CAST(longitude AS FLOAT) BETWEEN -66.0 AND -64.0 THEN 'Tucumán'
        WHEN CAST(latitude AS FLOAT) BETWEEN -30.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -65.0 AND -61.0 THEN 'Santiago del Estero'
        WHEN CAST(latitude AS FLOAT) BETWEEN -29.0 AND -24.0 AND CAST(longitude AS FLOAT) BETWEEN -67.5 AND -64.5 THEN 'Catamarca'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -68.0 AND -65.5 THEN 'La Rioja'
        WHEN CAST(latitude AS FLOAT) BETWEEN -32.0 AND -28.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.5 THEN 'San Juan'
        WHEN CAST(latitude AS FLOAT) BETWEEN -37.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -70.0 AND -67.0 THEN 'Mendoza'
        WHEN CAST(latitude AS FLOAT) BETWEEN -35.0 AND -32.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -64.5 THEN 'San Luis'
        WHEN CAST(latitude AS FLOAT) BETWEEN -39.0 AND -35.0 AND CAST(longitude AS FLOAT) BETWEEN -67.0 AND -62.0 THEN 'La Pampa'
        WHEN CAST(latitude AS FLOAT) BETWEEN -40.0 AND -36.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -68.0 THEN 'Neuquén'
        WHEN CAST(latitude AS FLOAT) BETWEEN -42.0 AND -38.0 AND CAST(longitude AS FLOAT) BETWEEN -71.0 AND -62.0 THEN 'Río Negro'
        WHEN CAST(latitude AS FLOAT) BETWEEN -46.0 AND -42.0 AND CAST(longitude AS FLOAT) BETWEEN -72.0 AND -64.0 THEN 'Chubut'
        WHEN CAST(latitude AS FLOAT) BETWEEN -52.0 AND -46.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Santa Cruz'
        WHEN CAST(latitude AS FLOAT) BETWEEN -55.0 AND -52.0 AND CAST(longitude AS FLOAT) BETWEEN -73.0 AND -65.0 THEN 'Tierra del Fuego'
        WHEN CAST(latitude AS FLOAT) <= -35.0 THEN 'Patagonia'
        WHEN CAST(latitude AS FLOAT) > -28.0 THEN 'Norte'
        ELSE 'Pampa'
    END AS province
FROM "postgres"."public"."fires_bronze"
  );
  
[0m03:03:58.540726 [debug] [Thread-1 (]: SQL status: SELECT 39429 in 0.075 seconds
[0m03:03:58.551751 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m03:03:58.552549 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver" rename to "fires_data_silver__dbt_backup"
[0m03:03:58.554812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m03:03:58.558805 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m03:03:58.562995 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
alter table "postgres"."public_public"."fires_data_silver__dbt_tmp" rename to "fires_data_silver"
[0m03:03:58.565085 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:03:58.580059 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m03:03:58.580894 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m03:03:58.581544 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: COMMIT
[0m03:03:58.681469 [debug] [Thread-1 (]: SQL status: COMMIT in 0.099 seconds
[0m03:03:58.688434 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_data_silver__dbt_backup"
[0m03:03:58.693947 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_data_silver"
[0m03:03:58.694545 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_data_silver"} */
drop table if exists "postgres"."public_public"."fires_data_silver__dbt_backup" cascade
[0m03:03:58.701693 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m03:03:58.704513 [debug] [Thread-1 (]: On model.fires_dbt.fires_data_silver: Close
[0m03:03:58.707281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d20f832-f740-41ef-a6d1-88987cff2eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8470faf950>]}
[0m03:03:58.708174 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public_public.fires_data_silver .............. [[32mSELECT 39429[0m in 0.31s]
[0m03:03:58.709035 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_data_silver
[0m03:03:58.709701 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m03:03:58.710328 [info ] [Thread-1 (]: 2 of 5 START sql table model public_public.fires_raw ........................... [RUN]
[0m03:03:58.711308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_data_silver, now model.fires_dbt.fires_raw)
[0m03:03:58.711831 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m03:03:58.715487 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m03:03:58.719951 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m03:03:58.723864 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m03:03:58.728599 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m03:03:58.729270 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m03:03:58.729766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:03:58.740473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m03:03:58.741253 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m03:03:58.741885 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m03:03:58.770205 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m03:03:58.774058 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m03:03:58.774600 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m03:03:58.776497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:03:58.779586 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m03:03:58.780061 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m03:03:58.781650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:03:58.783971 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m03:03:58.784547 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m03:03:58.820179 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.035 seconds
[0m03:03:58.822185 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m03:03:58.822855 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m03:03:58.823371 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m03:03:58.844179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m03:03:58.847209 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m03:03:58.848174 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m03:03:58.848836 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m03:03:58.854229 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m03:03:58.856107 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m03:03:58.857031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d20f832-f740-41ef-a6d1-88987cff2eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846c51ad20>]}
[0m03:03:58.857937 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.15s]
[0m03:03:58.858740 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m03:03:58.859318 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_enriched
[0m03:03:58.860037 [info ] [Thread-1 (]: 3 of 5 START sql table model public_public.fires_enriched ...................... [RUN]
[0m03:03:58.860664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_raw, now model.fires_dbt.fires_enriched)
[0m03:03:58.861124 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_enriched
[0m03:03:58.864354 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_enriched"
[0m03:03:58.870614 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_enriched
[0m03:03:58.874643 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_enriched"
[0m03:03:58.880220 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m03:03:58.880812 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: BEGIN
[0m03:03:58.881262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:03:58.891316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m03:03:58.892102 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m03:03:58.892673 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */

  
    

  create  table "postgres"."public_public"."fires_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    fc.*,

    CAST('Argentina' AS VARCHAR(20)) AS country,

    CASE
        WHEN fc.province IN ('Buenos Aires', 'Córdoba', 'Santa Fe', 'Entre Ríos') THEN 'Pampa'
        WHEN fc.province IN ('Corrientes', 'Misiones', 'Chaco', 'Formosa', 'Salta', 'Jujuy', 'Tucumán', 'Santiago del Estero', 'Catamarca') THEN 'Norte'
        ELSE 'Patagonia'
    END AS region,

    CASE
        WHEN fc.frp >= 50 THEN 'Alta'
        WHEN fc.frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,

    ROW_NUMBER() OVER (
        PARTITION BY fc.acq_date, fc.latitude, fc.longitude
        ORDER BY fc.acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_data_silver" fc
  );
  
[0m03:03:59.029020 [debug] [Thread-1 (]: SQL status: SELECT 39429 in 0.136 seconds
[0m03:03:59.034375 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m03:03:59.035246 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched" rename to "fires_enriched__dbt_backup"
[0m03:03:59.037493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:03:59.040495 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m03:03:59.040933 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
alter table "postgres"."public_public"."fires_enriched__dbt_tmp" rename to "fires_enriched"
[0m03:03:59.042375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:03:59.043804 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m03:03:59.044228 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m03:03:59.044622 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: COMMIT
[0m03:03:59.070412 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m03:03:59.073169 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_enriched__dbt_backup"
[0m03:03:59.074105 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_enriched"
[0m03:03:59.074591 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_enriched"} */
drop table if exists "postgres"."public_public"."fires_enriched__dbt_backup" cascade
[0m03:03:59.080500 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m03:03:59.082099 [debug] [Thread-1 (]: On model.fires_dbt.fires_enriched: Close
[0m03:03:59.082853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d20f832-f740-41ef-a6d1-88987cff2eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846c1b7d40>]}
[0m03:03:59.083598 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public_public.fires_enriched ................. [[32mSELECT 39429[0m in 0.22s]
[0m03:03:59.084410 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_enriched
[0m03:03:59.084957 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_cleaned
[0m03:03:59.085620 [info ] [Thread-1 (]: 4 of 5 START sql table model public_public.fires_cleaned ....................... [RUN]
[0m03:03:59.086214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_enriched, now model.fires_dbt.fires_cleaned)
[0m03:03:59.086728 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_cleaned
[0m03:03:59.089594 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_cleaned"
[0m03:03:59.094854 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_cleaned
[0m03:03:59.098505 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_cleaned"
[0m03:03:59.104583 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m03:03:59.105243 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: BEGIN
[0m03:03:59.105739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:03:59.115752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m03:03:59.116714 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m03:03:59.117343 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */

  
    

  create  table "postgres"."public_public"."fires_cleaned__dbt_tmp"
  
  
    as
  
  (
    

-- Modelo intermedio: datos limpios desde fires_raw
-- Este modelo actúa como puente entre bronze y silver layer
SELECT
    *,
    CASE
        WHEN frp >= 50 THEN 'Alta'
        WHEN frp >= 20 THEN 'Media'
        ELSE 'Baja'
    END as intensity_level,
    
    ROW_NUMBER() OVER (
        PARTITION BY acq_date, latitude, longitude 
        ORDER BY acq_time
    ) as fire_id

FROM "postgres"."public_public"."fires_raw"

WHERE validation_status = 'valid'
    AND confidence > 30
    AND frp > 0
  );
  
[0m03:03:59.158003 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.040 seconds
[0m03:03:59.161535 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m03:03:59.162068 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned" rename to "fires_cleaned__dbt_backup"
[0m03:03:59.163754 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:03:59.167100 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m03:03:59.167638 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
alter table "postgres"."public_public"."fires_cleaned__dbt_tmp" rename to "fires_cleaned"
[0m03:03:59.169302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:03:59.171119 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m03:03:59.171596 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m03:03:59.171989 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: COMMIT
[0m03:03:59.174482 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m03:03:59.177016 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_cleaned__dbt_backup"
[0m03:03:59.177776 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_cleaned"
[0m03:03:59.178204 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_cleaned"} */
drop table if exists "postgres"."public_public"."fires_cleaned__dbt_backup" cascade
[0m03:03:59.183221 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m03:03:59.184866 [debug] [Thread-1 (]: On model.fires_dbt.fires_cleaned: Close
[0m03:03:59.185699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d20f832-f740-41ef-a6d1-88987cff2eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846c59e630>]}
[0m03:03:59.186483 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public_public.fires_cleaned .................. [[32mSELECT 13143[0m in 0.10s]
[0m03:03:59.187429 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_cleaned
[0m03:03:59.188097 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_daily
[0m03:03:59.188731 [info ] [Thread-1 (]: 5 of 5 START sql table model public_public.fires_daily ......................... [RUN]
[0m03:03:59.189405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fires_dbt.fires_cleaned, now model.fires_dbt.fires_daily)
[0m03:03:59.189945 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_daily
[0m03:03:59.193135 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_daily"
[0m03:03:59.197983 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_daily
[0m03:03:59.201610 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_daily"
[0m03:03:59.207342 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m03:03:59.208031 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: BEGIN
[0m03:03:59.208535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:03:59.219282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m03:03:59.220026 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m03:03:59.220573 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */

  
    

  create  table "postgres"."public_public"."fires_daily__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    acq_date,
    satellite,
    province,
    region,

    COUNT(*) as total_fires,
    COUNT(DISTINCT fire_id) as unique_fires,

    ROUND(AVG(frp)::numeric, 2) as avg_frp,
    ROUND(MAX(frp)::numeric, 2) as max_frp,
    ROUND(SUM(frp)::numeric, 2) as total_frp,

    COUNT(CASE WHEN intensity_level = 'Alta' THEN 1 END) as high_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Media' THEN 1 END) as medium_intensity_fires,
    COUNT(CASE WHEN intensity_level = 'Baja' THEN 1 END) as low_intensity_fires,

    ROUND(AVG(confidence)::numeric, 1) as avg_confidence,
    ROUND(AVG(data_quality_score)::numeric, 1) as avg_quality_score,

    ROUND(AVG(brightness)::numeric, 2) as avg_brightness,
    ROUND(AVG(bright_t31)::numeric, 2) as avg_bright_t31

FROM "postgres"."public_public"."fires_enriched"
GROUP BY acq_date, satellite, province, region
ORDER BY acq_date DESC, total_fires DESC
  );
  
[0m03:03:59.288645 [debug] [Thread-1 (]: SQL status: SELECT 1042 in 0.067 seconds
[0m03:03:59.292240 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m03:03:59.292763 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */
alter table "postgres"."public_public"."fires_daily" rename to "fires_daily__dbt_backup"
[0m03:03:59.294776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:03:59.299182 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m03:03:59.299687 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */
alter table "postgres"."public_public"."fires_daily__dbt_tmp" rename to "fires_daily"
[0m03:03:59.301405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m03:03:59.302980 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: COMMIT
[0m03:03:59.303502 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m03:03:59.304090 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: COMMIT
[0m03:03:59.308195 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m03:03:59.311152 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_daily__dbt_backup"
[0m03:03:59.312098 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_daily"
[0m03:03:59.312546 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_daily"} */
drop table if exists "postgres"."public_public"."fires_daily__dbt_backup" cascade
[0m03:03:59.316766 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m03:03:59.318518 [debug] [Thread-1 (]: On model.fires_dbt.fires_daily: Close
[0m03:03:59.319449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d20f832-f740-41ef-a6d1-88987cff2eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846c1509e0>]}
[0m03:03:59.320276 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public_public.fires_daily .................... [[32mSELECT 1042[0m in 0.13s]
[0m03:03:59.321007 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_daily
[0m03:03:59.322852 [debug] [MainThread]: Using postgres connection "master"
[0m03:03:59.323401 [debug] [MainThread]: On master: BEGIN
[0m03:03:59.323891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:03:59.334365 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m03:03:59.335176 [debug] [MainThread]: On master: COMMIT
[0m03:03:59.335727 [debug] [MainThread]: Using postgres connection "master"
[0m03:03:59.336166 [debug] [MainThread]: On master: COMMIT
[0m03:03:59.337726 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m03:03:59.338248 [debug] [MainThread]: On master: Close
[0m03:03:59.338945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:03:59.339448 [debug] [MainThread]: Connection 'model.fires_dbt.fires_daily' was properly closed.
[0m03:03:59.339972 [info ] [MainThread]: 
[0m03:03:59.340676 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m03:03:59.342503 [debug] [MainThread]: Command end result
[0m03:03:59.370011 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m03:03:59.375988 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m03:03:59.384812 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m03:03:59.385677 [info ] [MainThread]: 
[0m03:03:59.386720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:03:59.387916 [info ] [MainThread]: 
[0m03:03:59.388764 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m03:03:59.390557 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.95966, "process_in_blocks": "66144", "process_kernel_time": 0.468497, "process_mem_max_rss": "129108", "process_out_blocks": "0", "process_user_time": 3.695923}
[0m03:03:59.391277 [debug] [MainThread]: Command `dbt run` succeeded at 03:03:59.391128 after 2.96 seconds
[0m03:03:59.391842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846e715100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b8470fac0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b846ef8c2c0>]}
[0m03:03:59.392360 [debug] [MainThread]: Flushing usage events
[0m03:04:00.356757 [debug] [MainThread]: An error was encountered while trying to flush usage events
