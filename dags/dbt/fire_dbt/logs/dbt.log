[0m05:01:06.364357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d535a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d507cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d5368a40>]}


============================== 05:01:06.404918 | a5291720-4f37-4ecd-9cac-aa62204bb2ab ==============================
[0m05:01:06.404918 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:01:06.405788 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'empty': 'False', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_format': 'default', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'static_parser': 'True'}
[0m05:01:06.411421 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
  
[0m05:01:06.413302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11072302, "process_in_blocks": "728", "process_kernel_time": 0.28657, "process_mem_max_rss": "123040", "process_out_blocks": "0", "process_user_time": 1.838829}
[0m05:01:06.413884 [debug] [MainThread]: Command `dbt run` failed at 05:01:06.413787 after 0.11 seconds
[0m05:01:06.414340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d7767830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d4ab9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505d53de840>]}
[0m05:01:06.414823 [debug] [MainThread]: Flushing usage events
[0m05:01:07.658736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:12:28.679083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747809b11c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747809891bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747809b25280>]}


============================== 05:12:28.720971 | bb9996a3-2391-4640-88d0-91c1c9dd9a75 ==============================
[0m05:12:28.720971 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:12:28.721644 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'no_print': 'None', 'partial_parse': 'True'}
[0m05:12:28.727817 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:12:28.728339 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev
[0m05:12:28.729794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.108145274, "process_in_blocks": "56200", "process_kernel_time": 0.298636, "process_mem_max_rss": "122872", "process_out_blocks": "0", "process_user_time": 1.892708}
[0m05:12:28.730277 [debug] [MainThread]: Command `dbt run` failed at 05:12:28.730182 after 0.11 seconds
[0m05:12:28.730689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74780a10b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747809032120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747809068440>]}
[0m05:12:28.731117 [debug] [MainThread]: Flushing usage events
[0m05:12:29.791985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:13:16.143385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3fac1cf5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3fac23c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3fac414c20>]}


============================== 05:13:16.189040 | 7ffc74bb-7634-47be-b9c6-b791b780ec53 ==============================
[0m05:13:16.189040 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:13:16.189845 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'debug': 'False', 'use_colors': 'True', 'log_format': 'default', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'quiet': 'False', 'warn_error': 'None', 'introspect': 'True'}
[0m05:13:16.197742 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:13:16.198401 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev
[0m05:13:16.199855 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11445144, "process_in_blocks": "56520", "process_kernel_time": 0.295073, "process_mem_max_rss": "122904", "process_out_blocks": "0", "process_user_time": 1.894052}
[0m05:13:16.200390 [debug] [MainThread]: Command `dbt run` failed at 05:13:16.200277 after 0.12 seconds
[0m05:13:16.200809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3fac2cb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3fabe2acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3fae523860>]}
[0m05:13:16.201239 [debug] [MainThread]: Flushing usage events
[0m05:13:16.821317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:14:15.455230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757188ffb8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757188542de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75718870b110>]}


============================== 05:14:15.499902 | 33c58034-bffb-46d3-8571-090ccd2e8ca2 ==============================
[0m05:14:15.499902 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:14:15.500570 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'use_experimental_parser': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'target_path': 'None', 'empty': 'False', 'printer_width': '80', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'quiet': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'debug': 'False'}
[0m05:14:15.506486 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:14:15.506993 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev
[0m05:14:15.508501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.112531126, "process_in_blocks": "56520", "process_kernel_time": 0.327147, "process_mem_max_rss": "122376", "process_out_blocks": "0", "process_user_time": 1.923468}
[0m05:14:15.509056 [debug] [MainThread]: Command `dbt run` failed at 05:14:15.508898 after 0.11 seconds
[0m05:14:15.509512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757188713500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75718855cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757188971c10>]}
[0m05:14:15.509954 [debug] [MainThread]: Flushing usage events
[0m05:14:16.679717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:14:30.037899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71367b0d9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71367d5d8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71367d5f0f80>]}


============================== 05:14:30.075897 | 33f01a71-3e8d-4b5f-9d62-420dd925f47d ==============================
[0m05:14:30.075897 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:14:30.076588 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'log_format': 'default', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'empty': 'False', 'write_json': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None'}
[0m05:14:30.082984 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:14:30.083705 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev
[0m05:14:30.084937 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.104628675, "process_in_blocks": "0", "process_kernel_time": 0.310821, "process_mem_max_rss": "122976", "process_out_blocks": "0", "process_user_time": 1.89282}
[0m05:14:30.085506 [debug] [MainThread]: Command `dbt run` failed at 05:14:30.085404 after 0.11 seconds
[0m05:14:30.085955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71367ef7ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71367aa76030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71367b1093a0>]}
[0m05:14:30.086429 [debug] [MainThread]: Flushing usage events
[0m05:14:30.679916 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:14:37.660838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77be7d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77c7b0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77c7c8890>]}


============================== 05:14:37.699673 | ad0eef74-dd23-413b-afc8-55d84b044afd ==============================
[0m05:14:37.699673 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:14:37.700429 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'quiet': 'False', 'warn_error': 'None', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'indirect_selection': 'eager', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'empty': 'None'}
[0m05:14:37.729259 [info ] [MainThread]: dbt version: 1.10.11
[0m05:14:37.729905 [info ] [MainThread]: python version: 3.12.11
[0m05:14:37.730404 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:14:37.730913 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m05:14:37.740094 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:14:37.740798 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/fire_dbt
[0m05:14:37.741364 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
[0m05:14:37.741801 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml
[0m05:14:37.798816 [info ] [MainThread]: Configuration:
[0m05:14:37.799657 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m05:14:37.800164 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m05:14:37.800677 [info ] [MainThread]: Required dependencies:
[0m05:14:37.801192 [debug] [MainThread]: Executing "git --help"
[0m05:14:37.805992 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m05:14:37.806700 [info ] [MainThread]: Connection test skipped since no profile was found
[0m05:14:37.807331 [info ] [MainThread]: [31m3 checks failed:[0m
[0m05:14:37.807828 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev


[0m05:14:37.808358 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path []: Additional properties are not allowed ('target' was unexpected)

Error encountered in /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml


[0m05:14:37.808951 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m05:14:37.810340 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.20945089, "process_in_blocks": "768", "process_kernel_time": 0.307861, "process_mem_max_rss": "122936", "process_out_blocks": "0", "process_user_time": 1.95912}
[0m05:14:37.810893 [debug] [MainThread]: Command `dbt debug` failed at 05:14:37.810800 after 0.21 seconds
[0m05:14:37.811377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77a33acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77a33cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb779d35130>]}
[0m05:14:37.811916 [debug] [MainThread]: Flushing usage events
[0m05:14:38.425390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:14:47.729897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecd54b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecddb4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecdf1d2b0>]}


============================== 05:14:47.769494 | 8f5a033e-1cdc-49c2-b7b2-b3cf29240364 ==============================
[0m05:14:47.769494 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:14:47.770317 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'warn_error': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'version_check': 'True', 'empty': 'None', 'use_colors': 'True', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None'}
[0m05:14:47.788569 [info ] [MainThread]: dbt version: 1.10.11
[0m05:14:47.789165 [info ] [MainThread]: python version: 3.12.11
[0m05:14:47.789688 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:14:47.790157 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m05:14:47.800007 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:14:47.800734 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/fire_dbt
[0m05:14:47.801334 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
[0m05:14:47.801808 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml
[0m05:14:47.898461 [info ] [MainThread]: Configuration:
[0m05:14:47.899340 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m05:14:47.899980 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:14:47.900494 [info ] [MainThread]: Required dependencies:
[0m05:14:47.901006 [debug] [MainThread]: Executing "git --help"
[0m05:14:47.902465 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m05:14:47.902965 [info ] [MainThread]: Connection test skipped since no profile was found
[0m05:14:47.903497 [info ] [MainThread]: [31m2 checks failed:[0m
[0m05:14:47.903940 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev


[0m05:14:47.904446 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m05:14:47.905582 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.23957731, "process_in_blocks": "0", "process_kernel_time": 0.326112, "process_mem_max_rss": "123000", "process_out_blocks": "0", "process_user_time": 1.968603}
[0m05:14:47.906097 [debug] [MainThread]: Command `dbt debug` failed at 05:14:47.906004 after 0.24 seconds
[0m05:14:47.906603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecdd1d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecd6928a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ecd71d880>]}
[0m05:14:47.907132 [debug] [MainThread]: Flushing usage events
[0m05:14:48.552452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:15:26.489634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a497a12e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a49708ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a499521970>]}


============================== 05:15:26.530377 | 09eb88ca-e597-4238-8773-bcfd1616def6 ==============================
[0m05:15:26.530377 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:15:26.531106 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'indirect_selection': 'eager', 'target_path': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt debug', 'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'log_format': 'default', 'empty': 'None', 'no_print': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False'}
[0m05:15:26.548254 [info ] [MainThread]: dbt version: 1.10.11
[0m05:15:26.548921 [info ] [MainThread]: python version: 3.12.11
[0m05:15:26.549463 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:15:26.550001 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m05:15:26.559102 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:15:26.559701 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/fire_dbt
[0m05:15:26.560149 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
[0m05:15:26.560632 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml
[0m05:15:26.617633 [info ] [MainThread]: Configuration:
[0m05:15:26.618309 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m05:15:26.618834 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m05:15:26.619372 [info ] [MainThread]: Required dependencies:
[0m05:15:26.620029 [debug] [MainThread]: Executing "git --help"
[0m05:15:26.621711 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m05:15:26.622217 [info ] [MainThread]: Connection test skipped since no profile was found
[0m05:15:26.622791 [info ] [MainThread]: [31m3 checks failed:[0m
[0m05:15:26.623308 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev


[0m05:15:26.623827 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path []: Additional properties are not allowed ('target' was unexpected)

Error encountered in /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml


[0m05:15:26.624306 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m05:15:26.625526 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.19257554, "process_in_blocks": "0", "process_kernel_time": 0.29175, "process_mem_max_rss": "123084", "process_out_blocks": "0", "process_user_time": 1.85841}
[0m05:15:26.626059 [debug] [MainThread]: Command `dbt debug` failed at 05:15:26.625960 after 0.19 seconds
[0m05:15:26.626516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a497a14980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a4967c3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a4967c21e0>]}
[0m05:15:26.626991 [debug] [MainThread]: Flushing usage events
[0m05:15:27.842136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:16:50.852931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc4141e4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc415eec770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc413a60c20>]}


============================== 05:16:50.894095 | 3d00c53c-503f-48a8-ac26-2c1e5e148794 ==============================
[0m05:16:50.894095 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:16:50.894802 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'use_colors': 'True', 'quiet': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'None', 'no_print': 'None'}
[0m05:16:50.911086 [info ] [MainThread]: dbt version: 1.10.11
[0m05:16:50.911651 [info ] [MainThread]: python version: 3.12.11
[0m05:16:50.912196 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:16:50.912732 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m05:16:50.921636 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:16:50.922236 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/fire_dbt
[0m05:16:50.922769 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
[0m05:16:50.923195 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml
[0m05:16:51.008926 [info ] [MainThread]: Configuration:
[0m05:16:51.009627 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m05:16:51.010081 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:16:51.010528 [info ] [MainThread]: Required dependencies:
[0m05:16:51.010989 [debug] [MainThread]: Executing "git --help"
[0m05:16:51.012333 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m05:16:51.012772 [info ] [MainThread]: Connection test skipped since no profile was found
[0m05:16:51.013289 [info ] [MainThread]: [31m2 checks failed:[0m
[0m05:16:51.013728 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev


[0m05:16:51.014214 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m05:16:51.015240 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.21890254, "process_in_blocks": "0", "process_kernel_time": 0.252374, "process_mem_max_rss": "122908", "process_out_blocks": "0", "process_user_time": 1.910834}
[0m05:16:51.015732 [debug] [MainThread]: Command `dbt debug` failed at 05:16:51.015636 after 0.22 seconds
[0m05:16:51.016169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc413bc6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc4141e8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc413a60c20>]}
[0m05:16:51.016595 [debug] [MainThread]: Flushing usage events
[0m05:16:52.242465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:17:09.826645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f87bad30e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f87d455580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f87dd0c650>]}


============================== 05:17:09.867665 | 565b2037-c749-4933-a69a-e8921a5830a8 ==============================
[0m05:17:09.867665 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:17:09.868652 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'invocation_command': 'dbt debug', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'use_colors': 'True', 'version_check': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'printer_width': '80', 'warn_error': 'None', 'fail_fast': 'False'}
[0m05:17:09.885037 [info ] [MainThread]: dbt version: 1.10.11
[0m05:17:09.885590 [info ] [MainThread]: python version: 3.12.11
[0m05:17:09.886147 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:17:09.886652 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m05:17:09.895165 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:17:09.895712 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/fire_dbt
[0m05:17:09.896163 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
[0m05:17:09.896653 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml
[0m05:17:09.983366 [info ] [MainThread]: Configuration:
[0m05:17:09.984154 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m05:17:09.984780 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:17:09.985297 [info ] [MainThread]: Required dependencies:
[0m05:17:09.985803 [debug] [MainThread]: Executing "git --help"
[0m05:17:09.987136 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m05:17:09.987573 [info ] [MainThread]: Connection test skipped since no profile was found
[0m05:17:09.988020 [info ] [MainThread]: [31m2 checks failed:[0m
[0m05:17:09.988486 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'fires_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev


[0m05:17:09.988968 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m05:17:09.990023 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.22047564, "process_in_blocks": "0", "process_kernel_time": 0.294966, "process_mem_max_rss": "122960", "process_out_blocks": "0", "process_user_time": 1.885395}
[0m05:17:09.990517 [debug] [MainThread]: Command `dbt debug` failed at 05:17:09.990430 after 0.22 seconds
[0m05:17:09.990942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f87b34c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f87d455580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f87da55fa0>]}
[0m05:17:09.991390 [debug] [MainThread]: Flushing usage events
[0m05:17:10.662337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:18:35.558560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c37f6d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c3783c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c3814d580>]}


============================== 05:18:35.600670 | 0d82ce88-7859-4334-ae1f-e26e8eb08c68 ==============================
[0m05:18:35.600670 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:18:35.601418 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'debug': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'partial_parse': 'True', 'printer_width': '80', 'quiet': 'False', 'empty': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'invocation_command': 'dbt debug'}
[0m05:18:35.618398 [info ] [MainThread]: dbt version: 1.10.11
[0m05:18:35.619014 [info ] [MainThread]: python version: 3.12.11
[0m05:18:35.619505 [info ] [MainThread]: python path: /usr/local/bin/python
[0m05:18:35.619979 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m05:18:35.628784 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:18:35.700188 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:18:35.701303 [info ] [MainThread]: Using profiles dir at /usr/local/airflow/dags/dbt/fire_dbt
[0m05:18:35.702128 [info ] [MainThread]: Using profiles.yml file at /usr/local/airflow/dags/dbt/fire_dbt/profiles.yml
[0m05:18:35.702861 [info ] [MainThread]: Using dbt_project.yml file at /usr/local/airflow/dags/dbt/fire_dbt/dbt_project.yml
[0m05:18:35.704174 [info ] [MainThread]: adapter type: postgres
[0m05:18:35.704751 [info ] [MainThread]: adapter version: 1.9.1
[0m05:18:35.809948 [info ] [MainThread]: Configuration:
[0m05:18:35.810671 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:18:35.811284 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:18:35.811752 [info ] [MainThread]: Required dependencies:
[0m05:18:35.812218 [debug] [MainThread]: Executing "git --help"
[0m05:18:35.813619 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m05:18:35.814083 [info ] [MainThread]: Connection:
[0m05:18:35.814628 [info ] [MainThread]:   host: host.docker.internal
[0m05:18:35.815072 [info ] [MainThread]:   port: 5432
[0m05:18:35.815524 [info ] [MainThread]:   user: postgres
[0m05:18:35.815968 [info ] [MainThread]:   database: postgres
[0m05:18:35.816433 [info ] [MainThread]:   schema: public
[0m05:18:35.816867 [info ] [MainThread]:   connect_timeout: 10
[0m05:18:35.817378 [info ] [MainThread]:   role: None
[0m05:18:35.817829 [info ] [MainThread]:   search_path: None
[0m05:18:35.818273 [info ] [MainThread]:   keepalives_idle: 0
[0m05:18:35.818726 [info ] [MainThread]:   sslmode: None
[0m05:18:35.819241 [info ] [MainThread]:   sslcert: None
[0m05:18:35.819676 [info ] [MainThread]:   sslkey: None
[0m05:18:35.820103 [info ] [MainThread]:   sslrootcert: None
[0m05:18:35.820502 [info ] [MainThread]:   application_name: dbt
[0m05:18:35.820947 [info ] [MainThread]:   retries: 1
[0m05:18:35.821582 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m05:18:35.899718 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m05:18:35.943330 [debug] [MainThread]: Using postgres connection "debug"
[0m05:18:35.943950 [debug] [MainThread]: On debug: select 1 as id
[0m05:18:35.944378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:18:35.954948 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m05:18:35.956187 [debug] [MainThread]: On debug: Close
[0m05:18:35.956698 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:18:35.957181 [info ] [MainThread]: [31m1 check failed:[0m
[0m05:18:35.957691 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m05:18:35.958826 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.45813006, "process_in_blocks": "4056", "process_kernel_time": 0.328092, "process_mem_max_rss": "122988", "process_out_blocks": "0", "process_user_time": 2.200622}
[0m05:18:35.959348 [debug] [MainThread]: Command `dbt debug` failed at 05:18:35.959252 after 0.46 seconds
[0m05:18:35.959771 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:18:35.960197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c3859aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c37690650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720c3749b290>]}
[0m05:18:35.960628 [debug] [MainThread]: Flushing usage events
[0m05:18:36.950369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:18:47.704254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368db96fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368da8a0f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368db9efe00>]}


============================== 05:18:47.747772 | f8906437-8587-4266-b1b1-763c070dc1b9 ==============================
[0m05:18:47.747772 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:18:47.748538 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'write_json': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error': 'None', 'empty': 'False', 'version_check': 'True'}
[0m05:18:47.754943 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:18:48.020751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368dd0a2270>]}
[0m05:18:48.074854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368db01a150>]}
[0m05:18:48.075976 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m05:18:48.160012 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m05:18:48.162423 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m05:18:48.162960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368da70b800>]}
[0m05:18:49.011153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368db6391c0>]}
[0m05:18:49.066275 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m05:18:49.071248 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m05:18:49.108052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368d955d130>]}
[0m05:18:49.108729 [info ] [MainThread]: Found 2 models, 434 macros
[0m05:18:49.109295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368da759970>]}
[0m05:18:49.111200 [info ] [MainThread]: 
[0m05:18:49.111831 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m05:18:49.112371 [info ] [MainThread]: 
[0m05:18:49.113069 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:18:49.116957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:18:49.165603 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:18:49.166484 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:18:49.167036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:18:49.178171 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m05:18:49.179802 [debug] [ThreadPool]: On list_postgres: Close
[0m05:18:49.181555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m05:18:49.187161 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m05:18:49.187673 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m05:18:49.188088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:18:49.197054 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m05:18:49.197649 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m05:18:49.198207 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:18:49.208179 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.009 seconds
[0m05:18:49.210118 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m05:18:49.211262 [debug] [ThreadPool]: On list_postgres_public: Close
[0m05:18:49.220447 [debug] [MainThread]: Using postgres connection "master"
[0m05:18:49.220974 [debug] [MainThread]: On master: BEGIN
[0m05:18:49.221385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:18:49.230771 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m05:18:49.231451 [debug] [MainThread]: Using postgres connection "master"
[0m05:18:49.231999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m05:18:49.242180 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m05:18:49.243615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368da7098b0>]}
[0m05:18:49.244208 [debug] [MainThread]: On master: ROLLBACK
[0m05:18:49.245491 [debug] [MainThread]: Using postgres connection "master"
[0m05:18:49.245975 [debug] [MainThread]: On master: BEGIN
[0m05:18:49.247872 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m05:18:49.248283 [debug] [MainThread]: On master: COMMIT
[0m05:18:49.248680 [debug] [MainThread]: Using postgres connection "master"
[0m05:18:49.249043 [debug] [MainThread]: On master: COMMIT
[0m05:18:49.250138 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:18:49.250555 [debug] [MainThread]: On master: Close
[0m05:18:49.254445 [debug] [Thread-1 (]: Began running node model.fires_dbt.model1
[0m05:18:49.255135 [info ] [Thread-1 (]: 1 of 2 START sql view model public.model1 ...................................... [RUN]
[0m05:18:49.255791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.fires_dbt.model1)
[0m05:18:49.256251 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.model1
[0m05:18:49.266601 [debug] [Thread-1 (]: Compilation Error in model model1 (models/model1.sql)
  Required var 'my_name' not found in config:
  Vars supplied to model1 = {}
[0m05:18:49.268691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8906437-8587-4266-b1b1-763c070dc1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368d952fa70>]}
[0m05:18:49.269475 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.model1 ............................. [[31mERROR[0m in 0.01s]
[0m05:18:49.270174 [debug] [Thread-1 (]: Finished running node model.fires_dbt.model1
[0m05:18:49.270799 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.model1' to be skipped because of status 'error'.  Reason: Compilation Error in model model1 (models/model1.sql)
  Required var 'my_name' not found in config:
  Vars supplied to model1 = {}.
[0m05:18:49.272102 [debug] [Thread-1 (]: Began running node model.fires_dbt.model2
[0m05:18:49.272715 [info ] [Thread-1 (]: 2 of 2 SKIP relation public.model2 ............................................. [[33mSKIP[0m]
[0m05:18:49.273277 [debug] [Thread-1 (]: Finished running node model.fires_dbt.model2
[0m05:18:49.274576 [debug] [MainThread]: Using postgres connection "master"
[0m05:18:49.274956 [debug] [MainThread]: On master: BEGIN
[0m05:18:49.275278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:18:49.284490 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m05:18:49.285146 [debug] [MainThread]: On master: COMMIT
[0m05:18:49.285605 [debug] [MainThread]: Using postgres connection "master"
[0m05:18:49.285990 [debug] [MainThread]: On master: COMMIT
[0m05:18:49.287190 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:18:49.287621 [debug] [MainThread]: On master: Close
[0m05:18:49.288192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:18:49.288581 [debug] [MainThread]: Connection 'model.fires_dbt.model1' was properly closed.
[0m05:18:49.289076 [info ] [MainThread]: 
[0m05:18:49.289536 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m05:18:49.290369 [debug] [MainThread]: Command end result
[0m05:18:49.313368 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m05:18:49.317957 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m05:18:49.326831 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m05:18:49.327367 [info ] [MainThread]: 
[0m05:18:49.327908 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m05:18:49.328426 [info ] [MainThread]: 
[0m05:18:49.329018 [error] [MainThread]: [31mFailure in model model1 (models/model1.sql)[0m
[0m05:18:49.329535 [error] [MainThread]:   Compilation Error in model model1 (models/model1.sql)
  Required var 'my_name' not found in config:
  Vars supplied to model1 = {}
[0m05:18:49.329995 [info ] [MainThread]: 
[0m05:18:49.330497 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m05:18:49.331902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6843011, "process_in_blocks": "5064", "process_kernel_time": 0.369253, "process_mem_max_rss": "126276", "process_out_blocks": "0", "process_user_time": 3.030285}
[0m05:18:49.332651 [debug] [MainThread]: Command `dbt run` failed at 05:18:49.332529 after 1.69 seconds
[0m05:18:49.333194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368da7c9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368da7302c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7368db01a0f0>]}
[0m05:18:49.333723 [debug] [MainThread]: Flushing usage events
[0m05:18:49.970008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:25:56.052732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176db8ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176df8d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176f13c050>]}


============================== 05:25:56.097163 | 78df600d-e2ad-4a40-9a8e-b6b909982412 ==============================
[0m05:25:56.097163 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:25:56.097906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'log_format': 'default', 'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'debug': 'False', 'version_check': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'no_print': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'empty': 'False', 'indirect_selection': 'eager'}
[0m05:25:56.104050 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:25:56.266747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176fb421b0>]}
[0m05:25:56.320187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176f9cad50>]}
[0m05:25:56.321372 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m05:25:56.404532 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m05:25:56.499643 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m05:25:56.500557 [debug] [MainThread]: Partial parsing: added file: fires_dbt://models/fires_raw.sql
[0m05:25:56.501145 [debug] [MainThread]: Partial parsing: added file: fires_dbt://models/sources.yml
[0m05:25:56.501524 [debug] [MainThread]: Partial parsing: deleted file: fires_dbt://models/model2.sql
[0m05:25:56.501891 [debug] [MainThread]: Partial parsing: deleted file: fires_dbt://models/model1.sql
[0m05:25:56.810602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176bffcd40>]}
[0m05:25:56.869381 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m05:25:56.873465 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m05:25:56.907887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176ccdf8c0>]}
[0m05:25:56.908528 [info ] [MainThread]: Found 1 model, 1 source, 434 macros
[0m05:25:56.909070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176cfc50d0>]}
[0m05:25:56.910880 [info ] [MainThread]: 
[0m05:25:56.911548 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m05:25:56.912179 [info ] [MainThread]: 
[0m05:25:56.912963 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:25:56.914259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:25:56.962778 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:25:56.963546 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:25:56.964091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:25:56.975411 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m05:25:56.976928 [debug] [ThreadPool]: On list_postgres: Close
[0m05:25:56.978472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m05:25:56.984700 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m05:25:56.985289 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m05:25:56.985796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:25:56.995115 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m05:25:56.995850 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m05:25:56.996401 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:25:57.000535 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.004 seconds
[0m05:25:57.002434 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m05:25:57.003865 [debug] [ThreadPool]: On list_postgres_public: Close
[0m05:25:57.012887 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:57.013460 [debug] [MainThread]: On master: BEGIN
[0m05:25:57.013896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:25:57.023319 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m05:25:57.023965 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:57.024461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m05:25:57.029044 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m05:25:57.030496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176b386f60>]}
[0m05:25:57.031086 [debug] [MainThread]: On master: ROLLBACK
[0m05:25:57.032446 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:57.032861 [debug] [MainThread]: On master: BEGIN
[0m05:25:57.034768 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:25:57.035234 [debug] [MainThread]: On master: COMMIT
[0m05:25:57.035630 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:57.036056 [debug] [MainThread]: On master: COMMIT
[0m05:25:57.037346 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:25:57.037780 [debug] [MainThread]: On master: Close
[0m05:25:57.040440 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m05:25:57.041106 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fires_raw .................................. [RUN]
[0m05:25:57.041737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.fires_dbt.fires_raw)
[0m05:25:57.042275 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m05:25:57.048823 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m05:25:57.057216 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m05:25:57.091775 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m05:25:57.101847 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:25:57.102526 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m05:25:57.102973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:25:57.112833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m05:25:57.113608 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:25:57.114063 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    

select
    cast(latitude as float) as latitude,
    cast(longitude as float) as longitude,
    cast(brightness as float) as brightness,
    cast(scan as float) as scan,
    cast(track as float) as track,
    cast(acq_date as date) as acq_date,
    cast(acq_time as varchar) as acq_time,
    cast(satellite as varchar) as satellite,
    cast(instrument as varchar) as instrument,
    cast(confidence as int) as confidence,
    cast(version as varchar) as version,
    cast(bright_t31 as float) as bright_t31,
    cast(frp as float) as frp,
    cast(daynight as varchar) as daynight
from "postgres"."public"."fires_raw"
  );
  
[0m05:25:57.135020 [debug] [Thread-1 (]: SQL status: SELECT 13877 in 0.020 seconds
[0m05:25:57.143907 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:25:57.144435 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m05:25:57.146144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:25:57.149633 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:25:57.150094 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m05:25:57.151598 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:25:57.165396 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m05:25:57.166029 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:25:57.166557 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m05:25:57.179651 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m05:25:57.185684 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."fires_raw__dbt_backup"
[0m05:25:57.190972 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:25:57.191521 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public"."fires_raw__dbt_backup" cascade
[0m05:25:57.195951 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m05:25:57.198633 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m05:25:57.200560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78df600d-e2ad-4a40-9a8e-b6b909982412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176cfe01d0>]}
[0m05:25:57.201352 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.fires_raw ............................. [[32mSELECT 13877[0m in 0.16s]
[0m05:25:57.202115 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m05:25:57.203830 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:57.204306 [debug] [MainThread]: On master: BEGIN
[0m05:25:57.204709 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:25:57.214256 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m05:25:57.214984 [debug] [MainThread]: On master: COMMIT
[0m05:25:57.215474 [debug] [MainThread]: Using postgres connection "master"
[0m05:25:57.215888 [debug] [MainThread]: On master: COMMIT
[0m05:25:57.217100 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:25:57.217519 [debug] [MainThread]: On master: Close
[0m05:25:57.218067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:25:57.218491 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m05:25:57.218935 [info ] [MainThread]: 
[0m05:25:57.219455 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m05:25:57.220360 [debug] [MainThread]: Command end result
[0m05:25:57.244044 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m05:25:57.248762 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m05:25:57.257357 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m05:25:57.257938 [info ] [MainThread]: 
[0m05:25:57.258545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:25:57.259078 [info ] [MainThread]: 
[0m05:25:57.259584 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m05:25:57.260788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2679242, "process_in_blocks": "264", "process_kernel_time": 0.460989, "process_mem_max_rss": "130400", "process_out_blocks": "0", "process_user_time": 2.666588}
[0m05:25:57.261368 [debug] [MainThread]: Command `dbt run` succeeded at 05:25:57.261266 after 1.27 seconds
[0m05:25:57.261893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176d6577a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176ce6baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78176e0d8530>]}
[0m05:25:57.262494 [debug] [MainThread]: Flushing usage events
[0m05:25:58.778985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:29:09.121002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f2c675c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f5401970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f21e4bf0>]}


============================== 05:29:09.166617 | b1395102-37b2-4014-9143-7fd63a9e17df ==============================
[0m05:29:09.166617 [info ] [MainThread]: Running with dbt=1.10.11
[0m05:29:09.167493 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'debug': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'fail_fast': 'False', 'printer_width': '80', 'empty': 'False', 'target_path': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs'}
[0m05:29:09.173344 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m05:29:09.437778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f1770410>]}
[0m05:29:09.490725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f22e6780>]}
[0m05:29:09.492222 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m05:29:09.579433 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m05:29:09.719824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:29:09.720448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:29:09.746533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f16a10d0>]}
[0m05:29:09.811050 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m05:29:09.815988 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m05:29:09.861428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f15f54c0>]}
[0m05:29:09.862078 [info ] [MainThread]: Found 1 model, 1 source, 434 macros
[0m05:29:09.862637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f15f6240>]}
[0m05:29:09.864496 [info ] [MainThread]: 
[0m05:29:09.865189 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m05:29:09.865676 [info ] [MainThread]: 
[0m05:29:09.866412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:29:09.867613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m05:29:09.922680 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m05:29:09.923266 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m05:29:09.923808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:29:09.936054 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m05:29:09.937572 [debug] [ThreadPool]: On list_postgres: Close
[0m05:29:09.938958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m05:29:09.944006 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m05:29:09.944437 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m05:29:09.944858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:29:09.954564 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m05:29:09.955138 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m05:29:09.955693 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:29:09.960851 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.005 seconds
[0m05:29:09.962739 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m05:29:09.964137 [debug] [ThreadPool]: On list_postgres_public: Close
[0m05:29:09.973047 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:09.973544 [debug] [MainThread]: On master: BEGIN
[0m05:29:09.973900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:29:09.983581 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m05:29:09.984199 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:09.984672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m05:29:09.989861 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m05:29:09.991123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f15f5820>]}
[0m05:29:09.991688 [debug] [MainThread]: On master: ROLLBACK
[0m05:29:09.992879 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:09.993266 [debug] [MainThread]: On master: BEGIN
[0m05:29:09.995104 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m05:29:09.995595 [debug] [MainThread]: On master: COMMIT
[0m05:29:09.995982 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:09.996444 [debug] [MainThread]: On master: COMMIT
[0m05:29:09.998182 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:29:09.998858 [debug] [MainThread]: On master: Close
[0m05:29:10.002741 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m05:29:10.003477 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fires_raw .................................. [RUN]
[0m05:29:10.004029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.fires_dbt.fires_raw)
[0m05:29:10.004459 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m05:29:10.010468 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m05:29:10.016382 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m05:29:10.052905 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m05:29:10.057690 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:29:10.058216 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m05:29:10.058625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:10.068671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m05:29:10.069336 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:29:10.069837 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    

select
    cast(latitude as float) as latitude,
    cast(longitude as float) as longitude,
    cast(brightness as float) as brightness,
    cast(scan as float) as scan,
    cast(track as float) as track,
    cast(acq_date as date) as acq_date,
    cast(acq_time as varchar) as acq_time,
    cast(satellite as varchar) as satellite,
    cast(instrument as varchar) as instrument,
    cast(confidence as int) as confidence,
    cast(version as varchar) as version,
    cast(bright_t31 as float) as bright_t31,
    cast(frp as float) as frp,
    cast(daynight as varchar) as daynight
from "postgres"."public"."fires_raw"
  );
  
[0m05:29:10.094452 [debug] [Thread-1 (]: SQL status: SELECT 13877 in 0.024 seconds
[0m05:29:10.103859 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:29:10.104484 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m05:29:10.106742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:29:10.109846 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:29:10.110325 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m05:29:10.111949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m05:29:10.126479 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m05:29:10.127162 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:29:10.127729 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m05:29:10.138451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m05:29:10.144331 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."fires_raw__dbt_backup"
[0m05:29:10.149334 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m05:29:10.149944 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public"."fires_raw__dbt_backup" cascade
[0m05:29:10.154441 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m05:29:10.156881 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m05:29:10.158743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1395102-37b2-4014-9143-7fd63a9e17df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f429f710>]}
[0m05:29:10.159540 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.fires_raw ............................. [[32mSELECT 13877[0m in 0.15s]
[0m05:29:10.160387 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m05:29:10.162019 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:10.162449 [debug] [MainThread]: On master: BEGIN
[0m05:29:10.162841 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:29:10.172658 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m05:29:10.173339 [debug] [MainThread]: On master: COMMIT
[0m05:29:10.173773 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:10.174167 [debug] [MainThread]: On master: COMMIT
[0m05:29:10.175379 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m05:29:10.175806 [debug] [MainThread]: On master: Close
[0m05:29:10.176377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:29:10.176792 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m05:29:10.177218 [info ] [MainThread]: 
[0m05:29:10.177751 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m05:29:10.178489 [debug] [MainThread]: Command end result
[0m05:29:10.200758 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m05:29:10.204770 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m05:29:10.212218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m05:29:10.212727 [info ] [MainThread]: 
[0m05:29:10.213356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:29:10.213840 [info ] [MainThread]: 
[0m05:29:10.214347 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m05:29:10.215915 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.156132, "process_in_blocks": "64976", "process_kernel_time": 0.514134, "process_mem_max_rss": "124652", "process_out_blocks": "0", "process_user_time": 2.535078}
[0m05:29:10.216500 [debug] [MainThread]: Command `dbt run` succeeded at 05:29:10.216408 after 1.16 seconds
[0m05:29:10.216966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f2405130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f294c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d3f14ab6e0>]}
[0m05:29:10.217438 [debug] [MainThread]: Flushing usage events
[0m05:29:11.430517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:01.561925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f9053a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f7cdb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f84a7980>]}


============================== 19:34:01.607310 | c504c1f3-c906-4e03-84dc-c17e78ee7a4a ==============================
[0m19:34:01.607310 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:34:01.607980 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'empty': 'False', 'debug': 'False', 'printer_width': '80', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'version_check': 'True', 'static_parser': 'True', 'target_path': 'None'}
[0m19:34:01.614066 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:34:01.893607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f711cb90>]}
[0m19:34:01.949086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f70a42c0>]}
[0m19:34:01.950638 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:34:02.036975 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:34:02.192054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:34:02.192896 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/sources.yml
[0m19:34:02.193356 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/fires_raw.sql
[0m19:34:02.517856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f639cda0>]}
[0m19:34:02.584188 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:34:02.588904 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:34:02.639762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f6d84710>]}
[0m19:34:02.640392 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:34:02.640903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f6ec8980>]}
[0m19:34:02.642571 [info ] [MainThread]: 
[0m19:34:02.643129 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:34:02.643623 [info ] [MainThread]: 
[0m19:34:02.644345 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:34:02.645468 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:34:02.704044 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:34:02.704668 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:34:02.705117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:02.718204 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m19:34:02.719852 [debug] [ThreadPool]: On list_postgres: Close
[0m19:34:02.720878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_bronze)
[0m19:34:02.721516 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_bronze"
"
[0m19:34:02.726395 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_bronze"
[0m19:34:02.726962 [debug] [ThreadPool]: On create_postgres_public_bronze: BEGIN
[0m19:34:02.727375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:02.737532 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:34:02.738185 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_bronze"
[0m19:34:02.738601 [debug] [ThreadPool]: On create_postgres_public_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "create_postgres_public_bronze"} */
create schema if not exists "public_bronze"
[0m19:34:02.740231 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m19:34:02.741351 [debug] [ThreadPool]: On create_postgres_public_bronze: COMMIT
[0m19:34:02.741780 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_bronze"
[0m19:34:02.742174 [debug] [ThreadPool]: On create_postgres_public_bronze: COMMIT
[0m19:34:02.744738 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m19:34:02.745209 [debug] [ThreadPool]: On create_postgres_public_bronze: Close
[0m19:34:02.746663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_bronze, now list_postgres_public_bronze)
[0m19:34:02.752159 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_bronze"
[0m19:34:02.752712 [debug] [ThreadPool]: On list_postgres_public_bronze: BEGIN
[0m19:34:02.753118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:02.763235 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:34:02.763864 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_bronze"
[0m19:34:02.764397 [debug] [ThreadPool]: On list_postgres_public_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_bronze"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m19:34:02.768717 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:34:02.770089 [debug] [ThreadPool]: On list_postgres_public_bronze: ROLLBACK
[0m19:34:02.771443 [debug] [ThreadPool]: On list_postgres_public_bronze: Close
[0m19:34:02.775514 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:02.776008 [debug] [MainThread]: On master: BEGIN
[0m19:34:02.776385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:02.786385 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:34:02.787103 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:02.787612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:34:02.793243 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:34:02.794627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f571a6f0>]}
[0m19:34:02.795212 [debug] [MainThread]: On master: ROLLBACK
[0m19:34:02.796890 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:02.797403 [debug] [MainThread]: On master: BEGIN
[0m19:34:02.799738 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:34:02.800293 [debug] [MainThread]: On master: COMMIT
[0m19:34:02.800735 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:02.801188 [debug] [MainThread]: On master: COMMIT
[0m19:34:02.802515 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:34:02.802984 [debug] [MainThread]: On master: Close
[0m19:34:02.806864 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:34:02.807612 [info ] [Thread-1 (]: 1 of 1 START sql table model public_bronze.fires_raw ........................... [RUN]
[0m19:34:02.808278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_bronze, now model.fires_dbt.fires_raw)
[0m19:34:02.808746 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:34:02.816207 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:34:02.820891 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:34:02.855441 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:34:02.860130 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:34:02.860658 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:34:02.861066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:02.871066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m19:34:02.871793 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:34:02.872426 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_bronze"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:34:02.904134 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.031 seconds
[0m19:34:02.914051 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:34:02.914716 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_bronze"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:34:02.916759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:34:02.919102 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:34:02.919639 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO bronze.fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:34:02.965245 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no partition of relation "fires_bronze" found for row
DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).

[0m19:34:02.965976 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:34:02.967555 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:34:03.075462 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  no partition of relation "fires_bronze" found for row
  DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:34:03.077761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c504c1f3-c906-4e03-84dc-c17e78ee7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f4bec950>]}
[0m19:34:03.078462 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_bronze.fires_raw .................. [[31mERROR[0m in 0.27s]
[0m19:34:03.079202 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:34:03.079904 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  no partition of relation "fires_bronze" found for row
  DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:34:03.081953 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:03.082375 [debug] [MainThread]: On master: BEGIN
[0m19:34:03.082742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:34:03.092480 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:34:03.093096 [debug] [MainThread]: On master: COMMIT
[0m19:34:03.093479 [debug] [MainThread]: Using postgres connection "master"
[0m19:34:03.093815 [debug] [MainThread]: On master: COMMIT
[0m19:34:03.094974 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:34:03.095366 [debug] [MainThread]: On master: Close
[0m19:34:03.095911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:03.096382 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:34:03.096849 [info ] [MainThread]: 
[0m19:34:03.097358 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m19:34:03.098296 [debug] [MainThread]: Command end result
[0m19:34:03.123140 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:34:03.127333 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:34:03.134702 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:34:03.135268 [info ] [MainThread]: 
[0m19:34:03.135788 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:34:03.136256 [info ] [MainThread]: 
[0m19:34:03.136762 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:34:03.137273 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  no partition of relation "fires_bronze" found for row
  DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:34:03.137701 [info ] [MainThread]: 
[0m19:34:03.138191 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:34:03.138615 [info ] [MainThread]: 
[0m19:34:03.139098 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:34:03.140553 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6389753, "process_in_blocks": "68200", "process_kernel_time": 0.535609, "process_mem_max_rss": "130500", "process_out_blocks": "0", "process_user_time": 2.931967}
[0m19:34:03.141062 [debug] [MainThread]: Command `dbt run` failed at 19:34:03.140966 after 1.64 seconds
[0m19:34:03.141564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f9dd4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f4fa36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389f5b8f260>]}
[0m19:34:03.141998 [debug] [MainThread]: Flushing usage events
[0m19:34:03.951846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:35:49.938689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7ac4ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7deceb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7cff87d0>]}


============================== 19:35:49.978453 | e7e06cef-9a39-4f12-a69f-3da48ca2f1ec ==============================
[0m19:35:49.978453 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:35:49.979225 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'partial_parse': 'True', 'empty': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'introspect': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False'}
[0m19:35:49.985319 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:35:50.145986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7a988d10>]}
[0m19:35:50.200892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7acc2ed0>]}
[0m19:35:50.202067 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:35:50.285555 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:35:50.397192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:35:50.397843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:35:50.426144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7a2c34d0>]}
[0m19:35:50.491685 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:35:50.496279 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:35:50.530530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe79edafc0>]}
[0m19:35:50.531274 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:35:50.531758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe79922180>]}
[0m19:35:50.533934 [info ] [MainThread]: 
[0m19:35:50.534462 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:35:50.534955 [info ] [MainThread]: 
[0m19:35:50.535620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:35:50.536687 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:35:50.585472 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:35:50.586159 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:35:50.586620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:50.597898 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m19:35:50.599534 [debug] [ThreadPool]: On list_postgres: Close
[0m19:35:50.601052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_bronze)
[0m19:35:50.606417 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_bronze"
[0m19:35:50.606927 [debug] [ThreadPool]: On list_postgres_public_bronze: BEGIN
[0m19:35:50.607416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:50.617118 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:35:50.617794 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_bronze"
[0m19:35:50.618286 [debug] [ThreadPool]: On list_postgres_public_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_bronze"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m19:35:50.622133 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m19:35:50.623579 [debug] [ThreadPool]: On list_postgres_public_bronze: ROLLBACK
[0m19:35:50.624846 [debug] [ThreadPool]: On list_postgres_public_bronze: Close
[0m19:35:50.629184 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:50.629801 [debug] [MainThread]: On master: BEGIN
[0m19:35:50.630267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:50.639479 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:35:50.640126 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:50.640659 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:35:50.645632 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:35:50.647207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7a065670>]}
[0m19:35:50.647826 [debug] [MainThread]: On master: ROLLBACK
[0m19:35:50.649261 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:50.649742 [debug] [MainThread]: On master: BEGIN
[0m19:35:50.651878 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:35:50.652389 [debug] [MainThread]: On master: COMMIT
[0m19:35:50.652831 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:50.653239 [debug] [MainThread]: On master: COMMIT
[0m19:35:50.654478 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:35:50.654913 [debug] [MainThread]: On master: Close
[0m19:35:50.657756 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:35:50.658535 [info ] [Thread-1 (]: 1 of 1 START sql table model public_bronze.fires_raw ........................... [RUN]
[0m19:35:50.659281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_bronze, now model.fires_dbt.fires_raw)
[0m19:35:50.659849 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:35:50.667395 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:35:50.673108 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:35:50.708859 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:35:50.714244 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:35:50.714826 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:35:50.715323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:50.724867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:35:50.725574 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:35:50.726099 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_bronze"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:35:50.755136 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m19:35:50.764971 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:35:50.765648 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_bronze"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:35:50.767620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:35:50.769878 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:35:50.770414 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO bronze.fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:35:50.810733 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no partition of relation "fires_bronze" found for row
DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).

[0m19:35:50.811469 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:35:50.813188 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:35:50.817318 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  no partition of relation "fires_bronze" found for row
  DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:35:50.819075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7e06cef-9a39-4f12-a69f-3da48ca2f1ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe789386e0>]}
[0m19:35:50.819808 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_bronze.fires_raw .................. [[31mERROR[0m in 0.16s]
[0m19:35:50.820566 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:35:50.821366 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  no partition of relation "fires_bronze" found for row
  DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:35:50.823343 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:50.823729 [debug] [MainThread]: On master: BEGIN
[0m19:35:50.824175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:35:50.833765 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:35:50.834441 [debug] [MainThread]: On master: COMMIT
[0m19:35:50.834903 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:50.835328 [debug] [MainThread]: On master: COMMIT
[0m19:35:50.836512 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:35:50.836922 [debug] [MainThread]: On master: Close
[0m19:35:50.837557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:50.837939 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:35:50.838373 [info ] [MainThread]: 
[0m19:35:50.838825 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m19:35:50.839722 [debug] [MainThread]: Command end result
[0m19:35:50.863334 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:35:50.867384 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:35:50.875246 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:35:50.875751 [info ] [MainThread]: 
[0m19:35:50.876304 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:35:50.876844 [info ] [MainThread]: 
[0m19:35:50.877593 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:35:50.878169 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  no partition of relation "fires_bronze" found for row
  DETAIL:  Partition key of the failing row contains (acq_date) = (2025-09-01).
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:35:50.878620 [info ] [MainThread]: 
[0m19:35:50.879166 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:35:50.879600 [info ] [MainThread]: 
[0m19:35:50.880078 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:35:50.881215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0049814, "process_in_blocks": "0", "process_kernel_time": 0.368274, "process_mem_max_rss": "125160", "process_out_blocks": "0", "process_user_time": 2.525879}
[0m19:35:50.881735 [debug] [MainThread]: Command `dbt run` failed at 19:35:50.881636 after 1.01 seconds
[0m19:35:50.882238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7a5ac440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7a03dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fe7a1492b0>]}
[0m19:35:50.882663 [debug] [MainThread]: Flushing usage events
[0m19:35:51.688737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:39.830024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bf3f45f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bf23cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bf10deb0>]}


============================== 19:37:39.870193 | bccc81e0-8267-4979-ac85-a8cc1a150c1b ==============================
[0m19:37:39.870193 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:37:39.870929 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'target_path': 'None', 'empty': 'False', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False'}
[0m19:37:39.877483 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:37:40.039137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34be48f290>]}
[0m19:37:40.097584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bf985160>]}
[0m19:37:40.098703 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:37:40.182422 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:37:40.291589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:37:40.292544 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/sources.yml
[0m19:37:40.293010 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/fires_raw.sql
[0m19:37:40.611037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bcda4ad0>]}
[0m19:37:40.670993 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:37:40.675869 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:37:40.708784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34be242d80>]}
[0m19:37:40.709517 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:37:40.710128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bd58f8c0>]}
[0m19:37:40.711952 [info ] [MainThread]: 
[0m19:37:40.712490 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:37:40.712956 [info ] [MainThread]: 
[0m19:37:40.713663 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:37:40.714767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:37:40.761944 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:37:40.762634 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:37:40.763105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:40.773854 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m19:37:40.775495 [debug] [ThreadPool]: On list_postgres: Close
[0m19:37:40.776691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_public)
[0m19:37:40.777383 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_public"
"
[0m19:37:40.782507 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_public"
[0m19:37:40.782965 [debug] [ThreadPool]: On create_postgres_public_public: BEGIN
[0m19:37:40.783346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:40.792886 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:37:40.793598 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_public"
[0m19:37:40.794007 [debug] [ThreadPool]: On create_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "create_postgres_public_public"} */
create schema if not exists "public_public"
[0m19:37:40.795647 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m19:37:40.796710 [debug] [ThreadPool]: On create_postgres_public_public: COMMIT
[0m19:37:40.797125 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_public"
[0m19:37:40.797478 [debug] [ThreadPool]: On create_postgres_public_public: COMMIT
[0m19:37:40.799515 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m19:37:40.799948 [debug] [ThreadPool]: On create_postgres_public_public: Close
[0m19:37:40.801395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_public, now list_postgres_public_public)
[0m19:37:40.806326 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:37:40.806786 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:37:40.807233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:40.816747 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:37:40.817366 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:37:40.817813 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:37:40.821343 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m19:37:40.822689 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:37:40.823840 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:37:40.829088 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:40.829681 [debug] [MainThread]: On master: BEGIN
[0m19:37:40.830115 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:40.839646 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:37:40.840274 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:40.840813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:37:40.845625 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:37:40.847538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bc1ac650>]}
[0m19:37:40.848187 [debug] [MainThread]: On master: ROLLBACK
[0m19:37:40.849753 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:40.850263 [debug] [MainThread]: On master: BEGIN
[0m19:37:40.852173 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:37:40.852600 [debug] [MainThread]: On master: COMMIT
[0m19:37:40.852988 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:40.853363 [debug] [MainThread]: On master: COMMIT
[0m19:37:40.854447 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:37:40.854875 [debug] [MainThread]: On master: Close
[0m19:37:40.857632 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:37:40.858488 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:37:40.859294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:37:40.859837 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:37:40.867155 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:37:40.871676 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:37:40.905174 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:37:40.911207 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:37:40.911839 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:37:40.912332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:40.921890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:37:40.922702 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:37:40.923278 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:37:40.951697 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m19:37:40.961744 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:37:40.962440 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:37:40.964228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:37:40.966188 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:37:40.966717 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:37:40.969969 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:37:40.970620 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:37:40.971970 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:37:40.976092 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:37:40.978087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bccc81e0-8267-4979-ac85-a8cc1a150c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34b9597710>]}
[0m19:37:40.978898 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.12s]
[0m19:37:40.979647 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:37:40.980288 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:37:40.982206 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:40.982681 [debug] [MainThread]: On master: BEGIN
[0m19:37:40.983050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:40.992328 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:37:40.992993 [debug] [MainThread]: On master: COMMIT
[0m19:37:40.993479 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:40.993845 [debug] [MainThread]: On master: COMMIT
[0m19:37:40.995120 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:37:40.995553 [debug] [MainThread]: On master: Close
[0m19:37:40.996133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:40.996535 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:37:40.996985 [info ] [MainThread]: 
[0m19:37:40.997440 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m19:37:40.998239 [debug] [MainThread]: Command end result
[0m19:37:41.021586 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:37:41.025767 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:37:41.033658 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:37:41.034267 [info ] [MainThread]: 
[0m19:37:41.034841 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:37:41.035323 [info ] [MainThread]: 
[0m19:37:41.035844 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:37:41.036383 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:37:41.036805 [info ] [MainThread]: 
[0m19:37:41.037280 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:37:41.037712 [info ] [MainThread]: 
[0m19:37:41.038174 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:37:41.039299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2736015, "process_in_blocks": "0", "process_kernel_time": 0.418026, "process_mem_max_rss": "130928", "process_out_blocks": "0", "process_user_time": 2.725056}
[0m19:37:41.039805 [debug] [MainThread]: Command `dbt run` failed at 19:37:41.039711 after 1.27 seconds
[0m19:37:41.040278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34beea4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bf654590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c34bf10deb0>]}
[0m19:37:41.040863 [debug] [MainThread]: Flushing usage events
[0m19:37:41.869088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:59.813486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca43c5c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca458aca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca43781b20>]}


============================== 19:38:59.860127 | eb00b737-efde-478c-a975-1619fa5f4536 ==============================
[0m19:38:59.860127 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:38:59.860867 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --debug', 'empty': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'debug': 'True', 'static_parser': 'True', 'version_check': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'fail_fast': 'False'}
[0m19:38:59.868128 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:39:00.040905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca429f97f0>]}
[0m19:39:00.097635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca42d49730>]}
[0m19:39:00.099110 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:39:00.184706 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:39:00.297000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:00.297860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:00.326847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca429346b0>]}
[0m19:39:00.393938 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:39:00.398877 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:39:00.434710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca41fb3e30>]}
[0m19:39:00.435533 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:39:00.436169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca42935280>]}
[0m19:39:00.437928 [info ] [MainThread]: 
[0m19:39:00.438493 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:39:00.438976 [info ] [MainThread]: 
[0m19:39:00.439702 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:00.441183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:39:00.493641 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:39:00.494552 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:39:00.495284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:00.506650 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m19:39:00.508546 [debug] [ThreadPool]: On list_postgres: Close
[0m19:39:00.510213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:39:00.516667 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:39:00.517509 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:39:00.518051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:00.528129 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:39:00.528852 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:39:00.529419 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:39:00.534420 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:39:00.536237 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:39:00.537905 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:39:00.542526 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:00.543204 [debug] [MainThread]: On master: BEGIN
[0m19:39:00.543746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:00.554196 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:39:00.554912 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:00.555526 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:39:00.561015 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:39:00.562657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca41fb05c0>]}
[0m19:39:00.563437 [debug] [MainThread]: On master: ROLLBACK
[0m19:39:00.565103 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:00.565778 [debug] [MainThread]: On master: BEGIN
[0m19:39:00.568346 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:39:00.569008 [debug] [MainThread]: On master: COMMIT
[0m19:39:00.569633 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:00.570186 [debug] [MainThread]: On master: COMMIT
[0m19:39:00.571826 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:39:00.572532 [debug] [MainThread]: On master: Close
[0m19:39:00.575629 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:39:00.576554 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:39:00.577373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:39:00.577950 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:39:00.585608 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:39:00.591314 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:39:00.628707 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:39:00.634699 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:00.635367 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:39:00.636006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:00.646769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m19:39:00.647593 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:00.648274 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:39:00.700074 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.051 seconds
[0m19:39:00.711500 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:00.712704 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:39:00.714407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:39:00.716871 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:00.717566 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:39:00.721404 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:39:00.722225 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:39:00.723725 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:39:00.729889 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:39:00.732259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb00b737-efde-478c-a975-1619fa5f4536', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca40f3c410>]}
[0m19:39:00.733304 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.15s]
[0m19:39:00.734374 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:39:00.735219 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:39:00.737461 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:00.738058 [debug] [MainThread]: On master: BEGIN
[0m19:39:00.738541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:00.749710 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m19:39:00.750526 [debug] [MainThread]: On master: COMMIT
[0m19:39:00.751117 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:00.751658 [debug] [MainThread]: On master: COMMIT
[0m19:39:00.752978 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:39:00.753479 [debug] [MainThread]: On master: Close
[0m19:39:00.754177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:00.754642 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:39:00.755155 [info ] [MainThread]: 
[0m19:39:00.755743 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m19:39:00.756654 [debug] [MainThread]: Command end result
[0m19:39:00.781671 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:39:00.786419 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:39:00.795494 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:39:00.796238 [info ] [MainThread]: 
[0m19:39:00.797032 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:39:00.797733 [info ] [MainThread]: 
[0m19:39:00.798385 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:39:00.799025 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:39:00.799575 [info ] [MainThread]: 
[0m19:39:00.800178 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:39:00.800722 [info ] [MainThread]: 
[0m19:39:00.801318 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:39:00.802583 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0528926, "process_in_blocks": "0", "process_kernel_time": 0.457724, "process_mem_max_rss": "125252", "process_out_blocks": "0", "process_user_time": 2.615}
[0m19:39:00.803442 [debug] [MainThread]: Command `dbt run` failed at 19:39:00.803329 after 1.05 seconds
[0m19:39:00.804109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca4352ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca43f0fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ca4405fb90>]}
[0m19:39:00.804721 [debug] [MainThread]: Flushing usage events
[0m19:39:01.635515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:08.112742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c800962090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8004aebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c800392030>]}


============================== 19:39:08.160182 | b6ead55f-aea6-497f-90d1-80af8331688c ==============================
[0m19:39:08.160182 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:39:08.160867 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'fail_fast': 'False', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'warn_error': 'None'}
[0m19:39:08.167528 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:39:08.333771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ffc6f440>]}
[0m19:39:08.392217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c800696fc0>]}
[0m19:39:08.393398 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:39:08.477090 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:39:08.593068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:08.593669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:08.622784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ffa490d0>]}
[0m19:39:08.687823 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:39:08.692074 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:39:08.726861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ff8a3230>]}
[0m19:39:08.727530 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:39:08.727989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ffa29040>]}
[0m19:39:08.729588 [info ] [MainThread]: 
[0m19:39:08.730087 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:39:08.730588 [info ] [MainThread]: 
[0m19:39:08.731369 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:08.732729 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:39:08.786115 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:39:08.786821 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:39:08.787352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:08.798528 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m19:39:08.800183 [debug] [ThreadPool]: On list_postgres: Close
[0m19:39:08.802182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:39:08.807859 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:39:08.808385 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:39:08.808809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:08.819149 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:39:08.819990 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:39:08.820517 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:39:08.825066 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:39:08.826596 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:39:08.827959 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:39:08.832157 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.832655 [debug] [MainThread]: On master: BEGIN
[0m19:39:08.833117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:08.843229 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:39:08.843849 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.844320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:39:08.848519 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:39:08.850140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ffa48bf0>]}
[0m19:39:08.851005 [debug] [MainThread]: On master: ROLLBACK
[0m19:39:08.852955 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.853485 [debug] [MainThread]: On master: BEGIN
[0m19:39:08.855423 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:39:08.855869 [debug] [MainThread]: On master: COMMIT
[0m19:39:08.856341 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.856731 [debug] [MainThread]: On master: COMMIT
[0m19:39:08.857841 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:39:08.858272 [debug] [MainThread]: On master: Close
[0m19:39:08.860995 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:39:08.861686 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:39:08.862348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:39:08.862830 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:39:08.870712 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:39:08.875582 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:39:08.912590 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:39:08.918577 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:08.919329 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:39:08.919778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:08.929134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:39:08.929798 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:08.930344 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:39:08.959676 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.029 seconds
[0m19:39:08.969324 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:08.970191 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:39:08.972353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:39:08.974907 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:39:08.975508 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:39:08.979067 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:39:08.979860 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:39:08.981515 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:39:08.986298 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:39:08.988432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6ead55f-aea6-497f-90d1-80af8331688c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ffa020c0>]}
[0m19:39:08.989245 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.12s]
[0m19:39:08.990153 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:39:08.990833 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:39:08.992889 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.993393 [debug] [MainThread]: On master: BEGIN
[0m19:39:08.993781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:09.006280 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m19:39:09.006951 [debug] [MainThread]: On master: COMMIT
[0m19:39:09.007456 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:09.007889 [debug] [MainThread]: On master: COMMIT
[0m19:39:09.009103 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:39:09.009518 [debug] [MainThread]: On master: Close
[0m19:39:09.010123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:09.010550 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:39:09.011042 [info ] [MainThread]: 
[0m19:39:09.011525 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m19:39:09.012322 [debug] [MainThread]: Command end result
[0m19:39:09.036682 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:39:09.040893 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:39:09.048432 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:39:09.049023 [info ] [MainThread]: 
[0m19:39:09.049839 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:39:09.050600 [info ] [MainThread]: 
[0m19:39:09.051263 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:39:09.051887 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:39:09.052465 [info ] [MainThread]: 
[0m19:39:09.053043 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:39:09.053468 [info ] [MainThread]: 
[0m19:39:09.053906 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:39:09.055003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0023806, "process_in_blocks": "0", "process_kernel_time": 0.463931, "process_mem_max_rss": "125432", "process_out_blocks": "0", "process_user_time": 2.599613}
[0m19:39:09.055529 [debug] [MainThread]: Command `dbt run` failed at 19:39:09.055428 after 1.00 seconds
[0m19:39:09.056008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c8005eede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c800cb4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7ffc0cfb0>]}
[0m19:39:09.056487 [debug] [MainThread]: Flushing usage events
[0m19:39:09.691708 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:55.013508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052b517680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052adb5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052ae65670>]}


============================== 19:40:55.061131 | b35e3534-d3f2-465d-949d-6d007714106a ==============================
[0m19:40:55.061131 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:40:55.061959 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'target_path': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'quiet': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False'}
[0m19:40:55.067865 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:40:55.230700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052cc39fd0>]}
[0m19:40:55.284920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052aa54da0>]}
[0m19:40:55.286080 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:40:55.368508 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:40:55.478714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:40:55.479571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:40:55.507771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052a06af60>]}
[0m19:40:55.572562 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:40:55.576831 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:40:55.609386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720529dfade0>]}
[0m19:40:55.610019 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:40:55.610496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052a127050>]}
[0m19:40:55.612482 [info ] [MainThread]: 
[0m19:40:55.613245 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:40:55.613750 [info ] [MainThread]: 
[0m19:40:55.614412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:55.615482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:40:55.664096 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:40:55.664801 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:40:55.665425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:55.675976 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.010 seconds
[0m19:40:55.677560 [debug] [ThreadPool]: On list_postgres: Close
[0m19:40:55.679624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:40:55.685215 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:40:55.685753 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:40:55.686150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:55.696223 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:40:55.696980 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:40:55.697481 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:40:55.701664 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:40:55.703084 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:40:55.704315 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:40:55.708303 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:55.708826 [debug] [MainThread]: On master: BEGIN
[0m19:40:55.709297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:55.720199 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m19:40:55.720810 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:55.721348 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:40:55.725588 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:40:55.726941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7205295be840>]}
[0m19:40:55.727543 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:55.729623 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:55.730334 [debug] [MainThread]: On master: BEGIN
[0m19:40:55.732519 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:40:55.733041 [debug] [MainThread]: On master: COMMIT
[0m19:40:55.733472 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:55.733828 [debug] [MainThread]: On master: COMMIT
[0m19:40:55.734994 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:40:55.735411 [debug] [MainThread]: On master: Close
[0m19:40:55.738054 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:40:55.738738 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:40:55.739336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:40:55.739791 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:40:55.747284 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:40:55.752218 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:40:55.787732 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:40:55.793272 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:40:55.793809 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:40:55.794247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:55.804334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m19:40:55.805004 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:40:55.805582 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:40:55.871026 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.065 seconds
[0m19:40:55.879664 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:40:55.880364 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:40:55.882169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:40:55.884266 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:40:55.884967 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:40:55.887954 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:40:55.888531 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:40:55.889848 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:40:55.893824 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:40:55.895882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b35e3534-d3f2-465d-949d-6d007714106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x720528105e80>]}
[0m19:40:55.896987 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.16s]
[0m19:40:55.897832 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:40:55.898499 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:40:55.900557 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:55.901076 [debug] [MainThread]: On master: BEGIN
[0m19:40:55.901481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:55.910879 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:40:55.911812 [debug] [MainThread]: On master: COMMIT
[0m19:40:55.912545 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:55.913096 [debug] [MainThread]: On master: COMMIT
[0m19:40:55.914872 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:40:55.915428 [debug] [MainThread]: On master: Close
[0m19:40:55.916064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:55.916449 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:40:55.916956 [info ] [MainThread]: 
[0m19:40:55.917482 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m19:40:55.918304 [debug] [MainThread]: Command end result
[0m19:40:55.941516 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:40:55.946417 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:40:55.954360 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:40:55.954902 [info ] [MainThread]: 
[0m19:40:55.955460 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:40:55.955921 [info ] [MainThread]: 
[0m19:40:55.956459 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:40:55.956953 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:40:55.957414 [info ] [MainThread]: 
[0m19:40:55.957947 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:40:55.958382 [info ] [MainThread]: 
[0m19:40:55.958830 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:40:55.960079 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0115949, "process_in_blocks": "0", "process_kernel_time": 0.463195, "process_mem_max_rss": "125416", "process_out_blocks": "0", "process_user_time": 2.502047}
[0m19:40:55.961293 [debug] [MainThread]: Command `dbt run` failed at 19:40:55.961080 after 1.01 seconds
[0m19:40:55.962550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052abd1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052b3f5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72052a0c83e0>]}
[0m19:40:55.964317 [debug] [MainThread]: Flushing usage events
[0m19:40:56.761561 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:42:45.552014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db728614f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db728601a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db7291d580>]}


============================== 19:42:45.599451 | 5d9c0dad-c2f4-4ab6-a913-447256cc242e ==============================
[0m19:42:45.599451 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:42:45.600164 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None', 'empty': 'False', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_colors': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'version_check': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs'}
[0m19:42:45.606136 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:42:45.772889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db71c37050>]}
[0m19:42:45.827943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db72871be0>]}
[0m19:42:45.829415 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:42:45.912578 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:42:46.022528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:42:46.023165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:42:46.052272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db71aedd00>]}
[0m19:42:46.119258 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:42:46.123328 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:42:46.157102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db71882d20>]}
[0m19:42:46.157774 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:42:46.158309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db7183b860>]}
[0m19:42:46.160151 [info ] [MainThread]: 
[0m19:42:46.160965 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:42:46.161549 [info ] [MainThread]: 
[0m19:42:46.162288 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:42:46.163794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:42:46.211062 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:42:46.211858 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:42:46.212339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:46.223428 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m19:42:46.225007 [debug] [ThreadPool]: On list_postgres: Close
[0m19:42:46.226617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:42:46.232423 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:42:46.233001 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:42:46.233526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:46.242900 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:42:46.243624 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:42:46.244270 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:42:46.248831 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:42:46.250345 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:42:46.251625 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:42:46.255684 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:46.256181 [debug] [MainThread]: On master: BEGIN
[0m19:42:46.256609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:42:46.267027 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:42:46.267688 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:46.268299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:42:46.273060 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:42:46.274339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db6ff05850>]}
[0m19:42:46.274842 [debug] [MainThread]: On master: ROLLBACK
[0m19:42:46.276063 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:46.276464 [debug] [MainThread]: On master: BEGIN
[0m19:42:46.278857 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:42:46.279578 [debug] [MainThread]: On master: COMMIT
[0m19:42:46.280030 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:46.280414 [debug] [MainThread]: On master: COMMIT
[0m19:42:46.281843 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:42:46.282305 [debug] [MainThread]: On master: Close
[0m19:42:46.284975 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:42:46.285765 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:42:46.286430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:42:46.286905 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:42:46.293962 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:42:46.299733 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:42:46.336405 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:42:46.341400 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:42:46.341928 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:42:46.342326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:46.352154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m19:42:46.352800 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:42:46.353335 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:42:46.383369 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.029 seconds
[0m19:42:46.392208 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:42:46.392770 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:42:46.394833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:42:46.397465 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:42:46.398122 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:42:46.401632 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:42:46.402240 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:42:46.403588 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:42:46.407703 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:42:46.409499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d9c0dad-c2f4-4ab6-a913-447256cc242e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db6fb05cd0>]}
[0m19:42:46.410261 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.12s]
[0m19:42:46.411143 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:42:46.411911 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:42:46.414198 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:46.414700 [debug] [MainThread]: On master: BEGIN
[0m19:42:46.415103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:42:46.424498 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:42:46.425142 [debug] [MainThread]: On master: COMMIT
[0m19:42:46.425682 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:46.426106 [debug] [MainThread]: On master: COMMIT
[0m19:42:46.427540 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:42:46.428249 [debug] [MainThread]: On master: Close
[0m19:42:46.429098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:46.429574 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:42:46.430102 [info ] [MainThread]: 
[0m19:42:46.430590 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m19:42:46.431401 [debug] [MainThread]: Command end result
[0m19:42:46.454435 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:42:46.458509 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:42:46.466516 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:42:46.467059 [info ] [MainThread]: 
[0m19:42:46.467735 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:42:46.468259 [info ] [MainThread]: 
[0m19:42:46.468817 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:42:46.469385 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:42:46.469838 [info ] [MainThread]: 
[0m19:42:46.470340 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:42:46.470773 [info ] [MainThread]: 
[0m19:42:46.471249 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:42:46.472318 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9813851, "process_in_blocks": "0", "process_kernel_time": 0.451478, "process_mem_max_rss": "125188", "process_out_blocks": "0", "process_user_time": 2.457161}
[0m19:42:46.472828 [debug] [MainThread]: Command `dbt run` failed at 19:42:46.472719 after 0.98 seconds
[0m19:42:46.473332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db71f185c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db71b68ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79db71b6b200>]}
[0m19:42:46.473799 [debug] [MainThread]: Flushing usage events
[0m19:42:47.312593 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:13.231666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754648703620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546480e0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546483f0920>]}


============================== 19:44:13.275787 | e923b039-74f2-4801-8845-aae84acb1bcf ==============================
[0m19:44:13.275787 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:44:13.276434 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'empty': 'False', 'fail_fast': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt'}
[0m19:44:13.283559 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:44:13.463935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546472d3320>]}
[0m19:44:13.523509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754647312e10>]}
[0m19:44:13.524672 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:44:13.614730 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:44:13.727515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:44:13.728050 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:44:13.755926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754647155a60>]}
[0m19:44:13.818125 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:44:13.822802 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:44:13.855193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754646fe75f0>]}
[0m19:44:13.855933 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:44:13.856488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75464677b800>]}
[0m19:44:13.858122 [info ] [MainThread]: 
[0m19:44:13.858596 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:44:13.859011 [info ] [MainThread]: 
[0m19:44:13.859619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:44:13.860681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:44:13.906797 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:44:13.907424 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:44:13.907846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:13.918292 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.010 seconds
[0m19:44:13.919923 [debug] [ThreadPool]: On list_postgres: Close
[0m19:44:13.921423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:44:13.926473 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:44:13.926922 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:44:13.927316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:13.936223 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:44:13.936808 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:44:13.937235 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:44:13.940792 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m19:44:13.942233 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:44:13.943418 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:44:13.947262 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:13.947721 [debug] [MainThread]: On master: BEGIN
[0m19:44:13.948111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:13.956941 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:44:13.957558 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:13.958067 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:44:13.962157 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:44:13.963461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754645701ac0>]}
[0m19:44:13.964004 [debug] [MainThread]: On master: ROLLBACK
[0m19:44:13.965330 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:13.965769 [debug] [MainThread]: On master: BEGIN
[0m19:44:13.967733 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:44:13.968216 [debug] [MainThread]: On master: COMMIT
[0m19:44:13.968707 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:13.969115 [debug] [MainThread]: On master: COMMIT
[0m19:44:13.970329 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:44:13.970741 [debug] [MainThread]: On master: Close
[0m19:44:13.973268 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:44:13.973970 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:44:13.974548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:44:13.974992 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:44:13.982020 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:44:13.987275 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:44:14.021128 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:44:14.026451 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:44:14.026992 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:44:14.027397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:14.036758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:44:14.037403 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:44:14.037919 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:44:14.066265 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m19:44:14.074912 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:44:14.075425 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:44:14.077127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:44:14.079010 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:44:14.079504 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:44:14.082659 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:44:14.083297 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:44:14.084607 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:44:14.088701 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:44:14.090505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e923b039-74f2-4801-8845-aae84acb1bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754645713a70>]}
[0m19:44:14.091298 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.11s]
[0m19:44:14.092045 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:44:14.092771 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:44:14.094605 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:14.095037 [debug] [MainThread]: On master: BEGIN
[0m19:44:14.095428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:44:14.104638 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:44:14.105284 [debug] [MainThread]: On master: COMMIT
[0m19:44:14.105764 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:14.106163 [debug] [MainThread]: On master: COMMIT
[0m19:44:14.107409 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:44:14.107858 [debug] [MainThread]: On master: Close
[0m19:44:14.108477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:14.108881 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:44:14.109287 [info ] [MainThread]: 
[0m19:44:14.109762 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m19:44:14.110586 [debug] [MainThread]: Command end result
[0m19:44:14.134359 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:44:14.140173 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:44:14.151112 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:44:14.151791 [info ] [MainThread]: 
[0m19:44:14.152727 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:44:14.153476 [info ] [MainThread]: 
[0m19:44:14.154215 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:44:14.154945 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:44:14.155463 [info ] [MainThread]: 
[0m19:44:14.156065 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:44:14.156539 [info ] [MainThread]: 
[0m19:44:14.157032 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:44:14.158252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9836856, "process_in_blocks": "0", "process_kernel_time": 0.469254, "process_mem_max_rss": "125496", "process_out_blocks": "0", "process_user_time": 2.414455}
[0m19:44:14.158822 [debug] [MainThread]: Command `dbt run` failed at 19:44:14.158716 after 0.98 seconds
[0m19:44:14.159361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754647d3dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546483e4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7546457172f0>]}
[0m19:44:14.159901 [debug] [MainThread]: Flushing usage events
[0m19:44:15.010336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:46:00.447509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8ee61940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8ecfc320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8ecfcce0>]}


============================== 19:46:00.490362 | e6e6a48f-4ec7-4106-a918-2eba14c9a009 ==============================
[0m19:46:00.490362 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:46:00.491155 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error': 'None', 'empty': 'False', 'invocation_command': 'dbt run', 'introspect': 'True', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'printer_width': '80', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False'}
[0m19:46:00.496901 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:46:00.650282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8da62540>]}
[0m19:46:00.702902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8db340e0>]}
[0m19:46:00.703876 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:46:00.783578 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:46:00.887684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:46:00.888395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:46:00.915584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8da634d0>]}
[0m19:46:00.977318 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:46:00.981624 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:46:01.013893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8d86aae0>]}
[0m19:46:01.014581 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:46:01.015064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8dc33200>]}
[0m19:46:01.016640 [info ] [MainThread]: 
[0m19:46:01.017133 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:46:01.017637 [info ] [MainThread]: 
[0m19:46:01.018298 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:46:01.019371 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:46:01.066620 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:46:01.067236 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:46:01.067733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:01.078887 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m19:46:01.080497 [debug] [ThreadPool]: On list_postgres: Close
[0m19:46:01.081967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:46:01.087091 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:46:01.087580 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:46:01.088038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:01.098027 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:46:01.098715 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:46:01.099175 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:46:01.103602 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:46:01.104940 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:46:01.106556 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:46:01.111152 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:01.111819 [debug] [MainThread]: On master: BEGIN
[0m19:46:01.112346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:46:01.122606 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:46:01.123226 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:01.123712 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:46:01.128164 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:46:01.129520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8bf7bc80>]}
[0m19:46:01.130157 [debug] [MainThread]: On master: ROLLBACK
[0m19:46:01.131427 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:01.131890 [debug] [MainThread]: On master: BEGIN
[0m19:46:01.133975 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:46:01.134433 [debug] [MainThread]: On master: COMMIT
[0m19:46:01.134850 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:01.135261 [debug] [MainThread]: On master: COMMIT
[0m19:46:01.136520 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:46:01.136960 [debug] [MainThread]: On master: Close
[0m19:46:01.139739 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:46:01.140517 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:46:01.141201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:46:01.141680 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:46:01.149041 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:46:01.154662 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:46:01.192580 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:46:01.198550 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:46:01.199202 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:46:01.199737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:46:01.209776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m19:46:01.210611 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:46:01.211273 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:46:01.241393 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.029 seconds
[0m19:46:01.251390 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:46:01.252067 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:46:01.254023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:46:01.256249 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:46:01.256777 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:46:01.260346 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:46:01.260975 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:46:01.262386 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:46:01.266356 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:46:01.268152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6e6a48f-4ec7-4106-a918-2eba14c9a009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8bf24380>]}
[0m19:46:01.268948 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.13s]
[0m19:46:01.269782 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:46:01.270453 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:46:01.272475 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:01.272908 [debug] [MainThread]: On master: BEGIN
[0m19:46:01.273296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:46:01.282618 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:46:01.283264 [debug] [MainThread]: On master: COMMIT
[0m19:46:01.283784 [debug] [MainThread]: Using postgres connection "master"
[0m19:46:01.284254 [debug] [MainThread]: On master: COMMIT
[0m19:46:01.285439 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:46:01.285887 [debug] [MainThread]: On master: Close
[0m19:46:01.286478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:01.286961 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:46:01.287467 [info ] [MainThread]: 
[0m19:46:01.288013 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m19:46:01.288937 [debug] [MainThread]: Command end result
[0m19:46:01.311864 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:46:01.316224 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:46:01.324103 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:46:01.324676 [info ] [MainThread]: 
[0m19:46:01.325241 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:46:01.325695 [info ] [MainThread]: 
[0m19:46:01.326253 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:46:01.326784 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:46:01.327244 [info ] [MainThread]: 
[0m19:46:01.327825 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:46:01.328307 [info ] [MainThread]: 
[0m19:46:01.328788 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:46:01.329968 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.94080716, "process_in_blocks": "0", "process_kernel_time": 0.418693, "process_mem_max_rss": "125784", "process_out_blocks": "0", "process_user_time": 2.436394}
[0m19:46:01.330500 [debug] [MainThread]: Command `dbt run` failed at 19:46:01.330400 after 0.94 seconds
[0m19:46:01.331024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8dda52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8db51100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771f8dc1f050>]}
[0m19:46:01.331506 [debug] [MainThread]: Flushing usage events
[0m19:46:02.185348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:50.597245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367322a0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736730060a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672fda2780>]}


============================== 19:47:50.646488 | edd88da0-9a31-414f-8123-779b15990977 ==============================
[0m19:47:50.646488 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:47:50.647256 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'introspect': 'True', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'invocation_command': 'dbt run', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None'}
[0m19:47:50.653456 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:47:50.827345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736731ffdd00>]}
[0m19:47:50.882720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672f4836e0>]}
[0m19:47:50.883840 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:47:50.969348 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:47:51.086670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:47:51.087391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:47:51.117643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672f4358e0>]}
[0m19:47:51.188919 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:47:51.193929 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:47:51.229708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672f195640>]}
[0m19:47:51.230420 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:47:51.230931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672e5e5eb0>]}
[0m19:47:51.232787 [info ] [MainThread]: 
[0m19:47:51.233366 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:47:51.233892 [info ] [MainThread]: 
[0m19:47:51.234608 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:47:51.235909 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:47:51.293033 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:47:51.293810 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:47:51.294424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:51.306258 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m19:47:51.307871 [debug] [ThreadPool]: On list_postgres: Close
[0m19:47:51.309558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:47:51.315479 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:47:51.316237 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:47:51.316838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:51.327160 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:47:51.327874 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:47:51.328400 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:47:51.332945 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:47:51.334682 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:47:51.336028 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:47:51.340333 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:51.340863 [debug] [MainThread]: On master: BEGIN
[0m19:47:51.341273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:51.351000 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:47:51.351773 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:51.352397 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:47:51.357051 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:47:51.358492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672e581910>]}
[0m19:47:51.359081 [debug] [MainThread]: On master: ROLLBACK
[0m19:47:51.360847 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:51.361581 [debug] [MainThread]: On master: BEGIN
[0m19:47:51.364216 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:47:51.364808 [debug] [MainThread]: On master: COMMIT
[0m19:47:51.365291 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:51.365760 [debug] [MainThread]: On master: COMMIT
[0m19:47:51.366962 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:47:51.367392 [debug] [MainThread]: On master: Close
[0m19:47:51.370217 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:47:51.370969 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:47:51.371619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:47:51.372158 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:47:51.379967 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:47:51.385377 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:47:51.422504 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:47:51.428036 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:47:51.428663 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:47:51.429195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:51.439290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m19:47:51.440047 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:47:51.440643 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:47:51.472559 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.031 seconds
[0m19:47:51.483364 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:47:51.484137 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:47:51.486305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:47:51.488814 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:47:51.489433 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:47:51.492901 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:47:51.493596 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:47:51.495137 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:47:51.499434 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:47:51.501299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edd88da0-9a31-414f-8123-779b15990977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672f153fe0>]}
[0m19:47:51.502181 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.13s]
[0m19:47:51.503014 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:47:51.503718 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:47:51.505785 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:51.506214 [debug] [MainThread]: On master: BEGIN
[0m19:47:51.506610 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:51.516560 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:47:51.517370 [debug] [MainThread]: On master: COMMIT
[0m19:47:51.517917 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:51.518393 [debug] [MainThread]: On master: COMMIT
[0m19:47:51.519771 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:47:51.520236 [debug] [MainThread]: On master: Close
[0m19:47:51.520899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:51.521329 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:47:51.521819 [info ] [MainThread]: 
[0m19:47:51.522296 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m19:47:51.523044 [debug] [MainThread]: Command end result
[0m19:47:51.547755 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:47:51.551975 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:47:51.562431 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:47:51.563118 [info ] [MainThread]: 
[0m19:47:51.563949 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:47:51.564535 [info ] [MainThread]: 
[0m19:47:51.565093 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:47:51.565666 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:47:51.566103 [info ] [MainThread]: 
[0m19:47:51.566626 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:47:51.567070 [info ] [MainThread]: 
[0m19:47:51.567575 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:47:51.568787 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0339226, "process_in_blocks": "0", "process_kernel_time": 0.411693, "process_mem_max_rss": "125268", "process_out_blocks": "0", "process_user_time": 2.47016}
[0m19:47:51.569337 [debug] [MainThread]: Command `dbt run` failed at 19:47:51.569216 after 1.03 seconds
[0m19:47:51.569866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736732317260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73672f810c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367308f35c0>]}
[0m19:47:51.570413 [debug] [MainThread]: Flushing usage events
[0m19:47:52.411410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:49:18.438223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bbac2ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bee26b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bbae2f30>]}


============================== 19:49:18.483453 | f5c05b5b-f3a7-4a0d-a785-f298192f5f20 ==============================
[0m19:49:18.483453 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:49:18.484325 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'debug': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'use_colors': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'target_path': 'None', 'write_json': 'True', 'invocation_command': 'dbt run'}
[0m19:49:18.490377 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:49:18.648895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bdcb2150>]}
[0m19:49:18.701157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0baffc0e0>]}
[0m19:49:18.702207 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:49:18.782801 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:49:18.886719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:49:18.887361 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:49:18.914596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bb2357f0>]}
[0m19:49:18.977719 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:49:18.981864 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:49:19.014583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bae6b4d0>]}
[0m19:49:19.015220 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:49:19.015695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bb31a360>]}
[0m19:49:19.017282 [info ] [MainThread]: 
[0m19:49:19.017824 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:49:19.018362 [info ] [MainThread]: 
[0m19:49:19.019082 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:49:19.020245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:49:19.069013 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:49:19.069613 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:49:19.070054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:19.080974 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m19:49:19.082559 [debug] [ThreadPool]: On list_postgres: Close
[0m19:49:19.084071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:49:19.089494 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:49:19.089983 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:49:19.090398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:19.100260 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:49:19.100886 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:49:19.101399 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:49:19.105481 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:49:19.106829 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:49:19.108143 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:49:19.111894 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:19.112394 [debug] [MainThread]: On master: BEGIN
[0m19:49:19.112878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:19.122607 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m19:49:19.123246 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:19.123751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:49:19.128055 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:49:19.129352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bd0fe090>]}
[0m19:49:19.129888 [debug] [MainThread]: On master: ROLLBACK
[0m19:49:19.131072 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:19.131493 [debug] [MainThread]: On master: BEGIN
[0m19:49:19.133448 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:49:19.133863 [debug] [MainThread]: On master: COMMIT
[0m19:49:19.134295 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:19.134700 [debug] [MainThread]: On master: COMMIT
[0m19:49:19.135875 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:49:19.136298 [debug] [MainThread]: On master: Close
[0m19:49:19.138975 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:49:19.139714 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:49:19.140403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:49:19.140940 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:49:19.148521 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:49:19.153261 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:49:19.187708 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:49:19.193971 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:49:19.194519 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:49:19.195016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:19.204625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:49:19.205281 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:49:19.205786 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:49:19.249643 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.043 seconds
[0m19:49:19.258926 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:49:19.259468 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:49:19.261173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:49:19.263137 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:49:19.263628 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:49:19.266846 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:49:19.267511 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:49:19.268963 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:49:19.272998 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:49:19.274704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5c05b5b-f3a7-4a0d-a785-f298192f5f20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0b9524530>]}
[0m19:49:19.275476 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.13s]
[0m19:49:19.276341 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:49:19.277008 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:49:19.278896 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:19.279327 [debug] [MainThread]: On master: BEGIN
[0m19:49:19.279673 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:49:19.288944 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:49:19.289536 [debug] [MainThread]: On master: COMMIT
[0m19:49:19.289994 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:19.290360 [debug] [MainThread]: On master: COMMIT
[0m19:49:19.291538 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:49:19.291977 [debug] [MainThread]: On master: Close
[0m19:49:19.292583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:19.292981 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:49:19.293398 [info ] [MainThread]: 
[0m19:49:19.293869 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m19:49:19.294683 [debug] [MainThread]: Command end result
[0m19:49:19.316926 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:49:19.321031 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:49:19.328657 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:49:19.329318 [info ] [MainThread]: 
[0m19:49:19.330022 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:49:19.330540 [info ] [MainThread]: 
[0m19:49:19.331118 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:49:19.331621 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:49:19.332078 [info ] [MainThread]: 
[0m19:49:19.332560 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:49:19.332993 [info ] [MainThread]: 
[0m19:49:19.333455 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:49:19.334516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9555712, "process_in_blocks": "0", "process_kernel_time": 0.373051, "process_mem_max_rss": "125400", "process_out_blocks": "0", "process_user_time": 2.434862}
[0m19:49:19.335064 [debug] [MainThread]: Command `dbt run` failed at 19:49:19.334928 after 0.96 seconds
[0m19:49:19.335558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bf8faf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bb06c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d0bb0bff80>]}
[0m19:49:19.335982 [debug] [MainThread]: Flushing usage events
[0m19:49:20.334383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:06.046738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7a97f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a79bbc4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7a06a840>]}


============================== 19:51:06.091098 | 7c1b8844-8e79-4dc1-8045-d2458a7c5b2d ==============================
[0m19:51:06.091098 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:51:06.091892 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'debug': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'quiet': 'False', 'use_colors': 'True', 'introspect': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'target_path': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt run'}
[0m19:51:06.097856 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:51:06.262100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a79fbe450>]}
[0m19:51:06.316712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7a97d760>]}
[0m19:51:06.317813 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:51:06.401074 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:51:06.507578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:06.508094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:06.534993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7937a5d0>]}
[0m19:51:06.597973 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:51:06.602285 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:51:06.634131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7919f710>]}
[0m19:51:06.634782 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:51:06.635275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a79379970>]}
[0m19:51:06.636836 [info ] [MainThread]: 
[0m19:51:06.637302 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:51:06.637800 [info ] [MainThread]: 
[0m19:51:06.638413 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:51:06.639527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:51:06.686555 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:51:06.687211 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:51:06.687829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:06.698965 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.011 seconds
[0m19:51:06.700581 [debug] [ThreadPool]: On list_postgres: Close
[0m19:51:06.702023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:51:06.707184 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:51:06.707665 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:51:06.708092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:06.717771 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m19:51:06.718374 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:51:06.718827 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:51:06.723411 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m19:51:06.724817 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:51:06.726076 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:51:06.730053 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:06.730505 [debug] [MainThread]: On master: BEGIN
[0m19:51:06.730939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:06.740452 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:51:06.741052 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:06.741563 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:51:06.746439 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:51:06.747799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a77901460>]}
[0m19:51:06.748325 [debug] [MainThread]: On master: ROLLBACK
[0m19:51:06.749492 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:06.749899 [debug] [MainThread]: On master: BEGIN
[0m19:51:06.751918 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:51:06.752350 [debug] [MainThread]: On master: COMMIT
[0m19:51:06.752750 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:06.753120 [debug] [MainThread]: On master: COMMIT
[0m19:51:06.754213 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:51:06.754651 [debug] [MainThread]: On master: Close
[0m19:51:06.757301 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:51:06.757966 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:51:06.758583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:51:06.759064 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:51:06.765919 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:51:06.771200 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:51:06.805069 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:51:06.810577 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:51:06.811087 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:51:06.811560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:06.821053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:51:06.821724 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:51:06.822234 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:51:06.852912 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.030 seconds
[0m19:51:06.861583 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:51:06.862124 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:51:06.863831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:51:06.865669 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:51:06.866134 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:51:06.869279 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:51:06.869999 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:51:06.871428 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:51:06.875295 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:51:06.877015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1b8844-8e79-4dc1-8045-d2458a7c5b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a77539fa0>]}
[0m19:51:06.877720 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.12s]
[0m19:51:06.878498 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:51:06.879203 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:51:06.881108 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:06.881507 [debug] [MainThread]: On master: BEGIN
[0m19:51:06.881860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:06.890911 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:51:06.891509 [debug] [MainThread]: On master: COMMIT
[0m19:51:06.891913 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:06.892263 [debug] [MainThread]: On master: COMMIT
[0m19:51:06.893400 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:51:06.893811 [debug] [MainThread]: On master: Close
[0m19:51:06.894364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:06.894785 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:51:06.895205 [info ] [MainThread]: 
[0m19:51:06.895700 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m19:51:06.896456 [debug] [MainThread]: Command end result
[0m19:51:06.918775 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:51:06.923074 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:51:06.930742 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:51:06.931269 [info ] [MainThread]: 
[0m19:51:06.931821 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:51:06.932271 [info ] [MainThread]: 
[0m19:51:06.932791 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:51:06.933298 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:51:06.933750 [info ] [MainThread]: 
[0m19:51:06.934275 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:51:06.934704 [info ] [MainThread]: 
[0m19:51:06.935219 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:51:06.936365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9464002, "process_in_blocks": "0", "process_kernel_time": 0.382956, "process_mem_max_rss": "125172", "process_out_blocks": "0", "process_user_time": 2.393477}
[0m19:51:06.936881 [debug] [MainThread]: Command `dbt run` failed at 19:51:06.936769 after 0.95 seconds
[0m19:51:06.937380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7a091280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7a64c4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768a7a64c9b0>]}
[0m19:51:06.937888 [debug] [MainThread]: Flushing usage events
[0m19:51:07.740648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:52:55.470477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6d9cb830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6e6d21b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6d7319d0>]}


============================== 19:52:55.513954 | d9c3bc4b-6792-4f8d-a9c5-91d408215bbd ==============================
[0m19:52:55.513954 [info ] [MainThread]: Running with dbt=1.10.11
[0m19:52:55.514748 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'quiet': 'False', 'invocation_command': 'dbt run', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'False', 'introspect': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'use_colors': 'True', 'debug': 'False'}
[0m19:52:55.520645 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m19:52:55.675906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6c526900>]}
[0m19:52:55.727868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6d346e70>]}
[0m19:52:55.728990 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:52:55.809564 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m19:52:55.912557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:52:55.913192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:52:55.940576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6c40f320>]}
[0m19:52:56.002974 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:52:56.007319 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:52:56.038762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6c2ab050>]}
[0m19:52:56.039353 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m19:52:56.039913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6c3f0380>]}
[0m19:52:56.041477 [info ] [MainThread]: 
[0m19:52:56.041970 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m19:52:56.042386 [info ] [MainThread]: 
[0m19:52:56.043016 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:52:56.044114 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m19:52:56.091272 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:52:56.091958 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:52:56.092441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:56.102953 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.010 seconds
[0m19:52:56.104456 [debug] [ThreadPool]: On list_postgres: Close
[0m19:52:56.105745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m19:52:56.111111 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:52:56.111665 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:52:56.112112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:56.121285 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m19:52:56.121954 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:52:56.122398 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m19:52:56.126168 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m19:52:56.127499 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:52:56.128609 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:52:56.132427 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:56.132903 [debug] [MainThread]: On master: BEGIN
[0m19:52:56.133278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:52:56.142055 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:52:56.142687 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:56.143147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:52:56.147472 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:52:56.148829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6c3c6b40>]}
[0m19:52:56.149336 [debug] [MainThread]: On master: ROLLBACK
[0m19:52:56.150644 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:56.151087 [debug] [MainThread]: On master: BEGIN
[0m19:52:56.153050 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:52:56.153598 [debug] [MainThread]: On master: COMMIT
[0m19:52:56.154127 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:56.154534 [debug] [MainThread]: On master: COMMIT
[0m19:52:56.155906 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:52:56.156357 [debug] [MainThread]: On master: Close
[0m19:52:56.158827 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m19:52:56.159453 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m19:52:56.160073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m19:52:56.160567 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m19:52:56.167608 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m19:52:56.173079 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m19:52:56.206789 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m19:52:56.211766 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:52:56.212268 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m19:52:56.212678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:56.222057 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:52:56.222690 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:52:56.223174 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    CAST(acq_time as VARCHAR(10)) as acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m19:52:56.251944 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.028 seconds
[0m19:52:56.260726 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:52:56.261308 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m19:52:56.262857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:56.264734 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m19:52:56.265211 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                CAST(acq_time as VARCHAR(10)),
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m19:52:56.268201 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "acq_time" is of type bigint but expression is of type character varying
LINE 16:                 CAST(acq_time as VARCHAR(10)),
                         ^
HINT:  You will need to rewrite or cast the expression.

[0m19:52:56.268777 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: ROLLBACK
[0m19:52:56.270164 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m19:52:56.274087 [debug] [Thread-1 (]: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:52:56.275817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9c3bc4b-6792-4f8d-a9c5-91d408215bbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6a9454c0>]}
[0m19:52:56.276515 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public_public.fires_raw .................. [[31mERROR[0m in 0.11s]
[0m19:52:56.277195 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m19:52:56.277930 [debug] [Thread-4 (]: Marking all children of 'model.fires_dbt.fires_raw' to be skipped because of status 'error'.  Reason: Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql.
[0m19:52:56.279764 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:56.280187 [debug] [MainThread]: On master: BEGIN
[0m19:52:56.280572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:52:56.289434 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m19:52:56.290039 [debug] [MainThread]: On master: COMMIT
[0m19:52:56.290482 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:56.290832 [debug] [MainThread]: On master: COMMIT
[0m19:52:56.292070 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:52:56.292460 [debug] [MainThread]: On master: Close
[0m19:52:56.293043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:56.293413 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m19:52:56.293842 [info ] [MainThread]: 
[0m19:52:56.294333 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m19:52:56.295078 [debug] [MainThread]: Command end result
[0m19:52:56.316778 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m19:52:56.320856 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m19:52:56.328304 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m19:52:56.328814 [info ] [MainThread]: 
[0m19:52:56.329335 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:52:56.329813 [info ] [MainThread]: 
[0m19:52:56.330424 [error] [MainThread]: [31mFailure in model fires_raw (models/fires_raw.sql)[0m
[0m19:52:56.330920 [error] [MainThread]:   Database Error in model fires_raw (models/fires_raw.sql)
  column "acq_time" is of type bigint but expression is of type character varying
  LINE 16:                 CAST(acq_time as VARCHAR(10)),
                           ^
  HINT:  You will need to rewrite or cast the expression.
  compiled code at target/run/fires_dbt/models/fires_raw.sql
[0m19:52:56.331358 [info ] [MainThread]: 
[0m19:52:56.331845 [info ] [MainThread]:   compiled code at target/compiled/fires_dbt/models/fires_raw.sql
[0m19:52:56.332266 [info ] [MainThread]: 
[0m19:52:56.332716 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:52:56.333766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.92035383, "process_in_blocks": "0", "process_kernel_time": 0.405948, "process_mem_max_rss": "125712", "process_out_blocks": "0", "process_user_time": 2.347265}
[0m19:52:56.334312 [debug] [MainThread]: Command `dbt run` failed at 19:52:56.334216 after 0.92 seconds
[0m19:52:56.334766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6d438980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6da82a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705e6a94ae70>]}
[0m19:52:56.335226 [debug] [MainThread]: Flushing usage events
[0m19:52:57.132683 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:25.320203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d581a733080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5819986570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5819984a70>]}


============================== 20:54:25.361147 | edef70bc-74a3-4194-97c0-eb6f3b8309ba ==============================
[0m20:54:25.361147 [info ] [MainThread]: Running with dbt=1.10.11
[0m20:54:25.361759 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error': 'None', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'invocation_command': 'dbt run', 'introspect': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'version_check': 'True', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'partial_parse': 'True'}
[0m20:54:25.367488 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m20:54:25.647672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58192b7230>]}
[0m20:54:25.704905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d581bc8e8d0>]}
[0m20:54:25.706439 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:54:25.794383 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m20:54:26.002415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:54:26.003305 [debug] [MainThread]: Partial parsing: updated file: fires_dbt://models/fires_raw.sql
[0m20:54:26.250287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5817fa9970>]}
[0m20:54:26.315755 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m20:54:26.320690 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m20:54:26.368348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58183fc620>]}
[0m20:54:26.369130 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m20:54:26.369783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5818347410>]}
[0m20:54:26.371619 [info ] [MainThread]: 
[0m20:54:26.372206 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m20:54:26.372677 [info ] [MainThread]: 
[0m20:54:26.373316 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:54:26.374444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m20:54:26.433898 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m20:54:26.434941 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m20:54:26.435567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:26.449083 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.013 seconds
[0m20:54:26.450793 [debug] [ThreadPool]: On list_postgres: Close
[0m20:54:26.452483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m20:54:26.458330 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m20:54:26.458885 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m20:54:26.459298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:26.469242 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:54:26.470098 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m20:54:26.470646 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m20:54:26.475780 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m20:54:26.477176 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m20:54:26.478564 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m20:54:26.482987 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:26.483548 [debug] [MainThread]: On master: BEGIN
[0m20:54:26.483962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:26.493534 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:54:26.494164 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:26.494718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:54:26.500625 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m20:54:26.502228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5816f04f20>]}
[0m20:54:26.503303 [debug] [MainThread]: On master: ROLLBACK
[0m20:54:26.505030 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:26.505513 [debug] [MainThread]: On master: BEGIN
[0m20:54:26.507427 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:54:26.507894 [debug] [MainThread]: On master: COMMIT
[0m20:54:26.508331 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:26.508733 [debug] [MainThread]: On master: COMMIT
[0m20:54:26.509885 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:54:26.510300 [debug] [MainThread]: On master: Close
[0m20:54:26.514179 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m20:54:26.514855 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m20:54:26.515438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m20:54:26.515869 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m20:54:26.523544 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m20:54:26.528765 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m20:54:26.564102 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m20:54:26.569277 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m20:54:26.570211 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m20:54:26.570746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:26.580489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:54:26.581172 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m20:54:26.581705 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m20:54:26.664412 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.082 seconds
[0m20:54:26.673497 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m20:54:26.674156 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m20:54:26.676749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:54:26.678781 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m20:54:26.679274 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m20:54:26.772339 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.092 seconds
[0m20:54:26.785454 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m20:54:26.786220 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m20:54:26.786829 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m20:54:26.971473 [debug] [Thread-1 (]: SQL status: COMMIT in 0.184 seconds
[0m20:54:26.977225 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m20:54:26.982107 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m20:54:26.982596 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m20:54:26.984187 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:54:26.986480 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m20:54:26.989014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edef70bc-74a3-4194-97c0-eb6f3b8309ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5816fba000>]}
[0m20:54:26.989823 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 0.47s]
[0m20:54:26.990478 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m20:54:26.991938 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:26.992375 [debug] [MainThread]: On master: BEGIN
[0m20:54:26.992762 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:27.001182 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:54:27.001767 [debug] [MainThread]: On master: COMMIT
[0m20:54:27.002182 [debug] [MainThread]: Using postgres connection "master"
[0m20:54:27.002537 [debug] [MainThread]: On master: COMMIT
[0m20:54:27.004289 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:54:27.004859 [debug] [MainThread]: On master: Close
[0m20:54:27.005411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:27.005811 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m20:54:27.006310 [info ] [MainThread]: 
[0m20:54:27.006773 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m20:54:27.007572 [debug] [MainThread]: Command end result
[0m20:54:27.031060 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m20:54:27.035509 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m20:54:27.043749 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m20:54:27.044287 [info ] [MainThread]: 
[0m20:54:27.044834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:54:27.045284 [info ] [MainThread]: 
[0m20:54:27.045756 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:54:27.047187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7855008, "process_in_blocks": "65656", "process_kernel_time": 0.466441, "process_mem_max_rss": "128400", "process_out_blocks": "0", "process_user_time": 2.83886}
[0m20:54:27.047756 [debug] [MainThread]: Command `dbt run` succeeded at 20:54:27.047663 after 1.79 seconds
[0m20:54:27.048218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d581a421d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58187583e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58187c95e0>]}
[0m20:54:27.048687 [debug] [MainThread]: Flushing usage events
[0m20:54:27.928662 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:25.619693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e12f7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e32e99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e12f6d20>]}


============================== 21:02:25.664303 | 8a69ccf1-7b85-4f7f-989f-45fdf085205d ==============================
[0m21:02:25.664303 [info ] [MainThread]: Running with dbt=1.10.11
[0m21:02:25.665033 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/usr/local/airflow/dags/dbt/fire_dbt/logs', 'printer_width': '80', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/usr/local/airflow/dags/dbt/fire_dbt', 'version_check': 'True', 'static_parser': 'True', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'debug': 'False'}
[0m21:02:25.671032 [info ] [MainThread]: target not specified in profile 'fires_project', using 'default'
[0m21:02:26.754601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e0b6b230>]}
[0m21:02:26.806623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e04c2b10>]}
[0m21:02:26.820861 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:02:26.976360 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m21:02:27.348433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:02:27.349052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:02:27.376553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e0339790>]}
[0m21:02:27.440740 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m21:02:27.445422 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m21:02:27.491542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e01d8ec0>]}
[0m21:02:27.492181 [info ] [MainThread]: Found 1 model, 2 sources, 434 macros
[0m21:02:27.492682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e03617c0>]}
[0m21:02:27.494287 [info ] [MainThread]: 
[0m21:02:27.494780 [info ] [MainThread]: Concurrency: 1 threads (target='default')
[0m21:02:27.495223 [info ] [MainThread]: 
[0m21:02:27.495861 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:02:27.497127 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m21:02:27.556845 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m21:02:27.557453 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m21:02:27.557860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:27.570167 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.012 seconds
[0m21:02:27.571813 [debug] [ThreadPool]: On list_postgres: Close
[0m21:02:27.573458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_public)
[0m21:02:27.578730 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m21:02:27.579317 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m21:02:27.579745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:27.588804 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m21:02:27.589414 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m21:02:27.589877 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:02:27.594712 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m21:02:27.596234 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m21:02:27.597441 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m21:02:27.601464 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.601930 [debug] [MainThread]: On master: BEGIN
[0m21:02:27.602329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:27.611866 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m21:02:27.612519 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.613010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:02:27.618003 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m21:02:27.619327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0df56f260>]}
[0m21:02:27.619888 [debug] [MainThread]: On master: ROLLBACK
[0m21:02:27.621231 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.621719 [debug] [MainThread]: On master: BEGIN
[0m21:02:27.624030 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m21:02:27.624542 [debug] [MainThread]: On master: COMMIT
[0m21:02:27.624986 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:27.625477 [debug] [MainThread]: On master: COMMIT
[0m21:02:27.626808 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:02:27.627283 [debug] [MainThread]: On master: Close
[0m21:02:27.631238 [debug] [Thread-1 (]: Began running node model.fires_dbt.fires_raw
[0m21:02:27.631932 [info ] [Thread-1 (]: 1 of 1 START sql table model public_public.fires_raw ........................... [RUN]
[0m21:02:27.632512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_public, now model.fires_dbt.fires_raw)
[0m21:02:27.632992 [debug] [Thread-1 (]: Began compiling node model.fires_dbt.fires_raw
[0m21:02:27.640257 [debug] [Thread-1 (]: Writing injected SQL for node "model.fires_dbt.fires_raw"
[0m21:02:27.645619 [debug] [Thread-1 (]: Began executing node model.fires_dbt.fires_raw
[0m21:02:27.680886 [debug] [Thread-1 (]: Writing runtime sql for node "model.fires_dbt.fires_raw"
[0m21:02:27.686366 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:27.686880 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: BEGIN
[0m21:02:27.687330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:27.696804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m21:02:27.697446 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:27.697930 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

  
    

  create  table "postgres"."public_public"."fires_raw__dbt_tmp"
  
  
    as
  
  (
    



-- Modelo Bronze: datos MODIS validados y con metadata
SELECT
    CAST(latitude as FLOAT) as latitude,
    CAST(longitude as FLOAT) as longitude,
    CAST(brightness as FLOAT) as brightness,
    CAST(scan as FLOAT) as scan,
    CAST(track as FLOAT) as track,
    CAST(acq_date as DATE) as acq_date,
    acq_time,
    CAST(satellite as VARCHAR(10)) as satellite,
    CAST(instrument as VARCHAR(10)) as instrument,
    CAST(confidence as INTEGER) as confidence,
    CAST(version as VARCHAR(10)) as version,
    CAST(bright_t31 as FLOAT) as bright_t31,
    CAST(frp as FLOAT) as frp,
    CAST(daynight as VARCHAR(5)) as daynight,

    -- Metadata Bronze
    CURRENT_TIMESTAMP as ingested_at,
    'valid' as validation_status,
    'modis-fire-two-months.csv' as source_file,
    CURRENT_DATE as processing_date,

    -- Data Quality Score basado en confidence
    CASE
        WHEN CAST(confidence as INTEGER) >= 80 THEN 100
        WHEN CAST(confidence as INTEGER) >= 50 THEN 75
        ELSE 50
    END as data_quality_score

FROM "postgres"."public"."fires_raw"

-- Validaciones Bronze aplicadas en WHERE
WHERE CAST(frp as FLOAT) > 0
    AND CAST(confidence as INTEGER) > 30
    AND CAST(latitude as FLOAT) IS NOT NULL
    AND CAST(longitude as FLOAT) IS NOT NULL
    AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
    AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
    AND CAST(acq_date as DATE) IS NOT NULL
  );
  
[0m21:02:27.860929 [debug] [Thread-1 (]: SQL status: SELECT 13143 in 0.162 seconds
[0m21:02:27.869300 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:27.869778 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw" rename to "fires_raw__dbt_backup"
[0m21:02:27.871581 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:02:27.874648 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:27.875181 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
alter table "postgres"."public_public"."fires_raw__dbt_tmp" rename to "fires_raw"
[0m21:02:27.877060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:02:27.879153 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:27.879678 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */

        INSERT INTO fires_bronze (
                latitude, longitude, brightness, scan, track,
                acq_date, acq_time, satellite, instrument, confidence,
                version, bright_t31, frp, daynight, ingested_at,
                validation_status, source_file, processing_date, data_quality_score
            )
            SELECT
                CAST(latitude as FLOAT),
                CAST(longitude as FLOAT),
                CAST(brightness as FLOAT),
                CAST(scan as FLOAT),
                CAST(track as FLOAT),
                CAST(acq_date as DATE),
                acq_time,
                CAST(satellite as VARCHAR(10)),
                CAST(instrument as VARCHAR(10)),
                CAST(confidence as INTEGER),
                CAST(version as VARCHAR(10)),
                CAST(bright_t31 as FLOAT),
                CAST(frp as FLOAT),
                CAST(daynight as VARCHAR(5)),
                CURRENT_TIMESTAMP,
                'valid',
                'modis-fire-two-months.csv',
                CURRENT_DATE,
                CASE
                    WHEN CAST(confidence as INTEGER) >= 80 THEN 100
                    WHEN CAST(confidence as INTEGER) >= 50 THEN 75
                    ELSE 50
                END
            FROM "postgres"."public"."fires_raw"
            WHERE CAST(frp as FLOAT) > 0
                AND CAST(confidence as INTEGER) > 30
                AND CAST(latitude as FLOAT) IS NOT NULL
                AND CAST(longitude as FLOAT) IS NOT NULL
                AND CAST(latitude as FLOAT) BETWEEN -55 AND -21
                AND CAST(longitude as FLOAT) BETWEEN -73 AND -53
                AND CAST(acq_date as DATE) IS NOT NULL
      
[0m21:02:27.910115 [debug] [Thread-1 (]: SQL status: INSERT 0 13143 in 0.030 seconds
[0m21:02:27.924100 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m21:02:27.924780 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:27.925279 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: COMMIT
[0m21:02:28.700364 [debug] [Thread-1 (]: SQL status: COMMIT in 0.774 seconds
[0m21:02:28.706464 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_public"."fires_raw__dbt_backup"
[0m21:02:28.711703 [debug] [Thread-1 (]: Using postgres connection "model.fires_dbt.fires_raw"
[0m21:02:28.712192 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "fires_project", "target_name": "default", "node_id": "model.fires_dbt.fires_raw"} */
drop table if exists "postgres"."public_public"."fires_raw__dbt_backup" cascade
[0m21:02:28.716167 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m21:02:28.718673 [debug] [Thread-1 (]: On model.fires_dbt.fires_raw: Close
[0m21:02:28.848549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a69ccf1-7b85-4f7f-989f-45fdf085205d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e2fdf9b0>]}
[0m21:02:28.849590 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_public.fires_raw ...................... [[32mSELECT 13143[0m in 1.09s]
[0m21:02:28.850365 [debug] [Thread-1 (]: Finished running node model.fires_dbt.fires_raw
[0m21:02:28.851913 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:28.852310 [debug] [MainThread]: On master: BEGIN
[0m21:02:28.852675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:02:28.862604 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m21:02:28.863246 [debug] [MainThread]: On master: COMMIT
[0m21:02:28.863705 [debug] [MainThread]: Using postgres connection "master"
[0m21:02:28.864128 [debug] [MainThread]: On master: COMMIT
[0m21:02:28.865284 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m21:02:28.865676 [debug] [MainThread]: On master: Close
[0m21:02:28.866246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:28.866633 [debug] [MainThread]: Connection 'model.fires_dbt.fires_raw' was properly closed.
[0m21:02:28.867044 [info ] [MainThread]: 
[0m21:02:28.867569 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m21:02:28.868388 [debug] [MainThread]: Command end result
[0m21:02:28.892229 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/manifest.json
[0m21:02:28.896135 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dags/dbt/fire_dbt/target/semantic_manifest.json
[0m21:02:28.903392 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dags/dbt/fire_dbt/target/run_results.json
[0m21:02:28.903895 [info ] [MainThread]: 
[0m21:02:28.904414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:28.904868 [info ] [MainThread]: 
[0m21:02:28.905335 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:02:28.907011 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4980469, "process_in_blocks": "65288", "process_kernel_time": 0.567091, "process_mem_max_rss": "124764", "process_out_blocks": "0", "process_user_time": 2.684761}
[0m21:02:28.907728 [debug] [MainThread]: Command `dbt run` succeeded at 21:02:28.907615 after 3.50 seconds
[0m21:02:28.908196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e32e44a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0df995bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d0e075b380>]}
[0m21:02:28.908661 [debug] [MainThread]: Flushing usage events
[0m21:02:29.658031 [debug] [MainThread]: An error was encountered while trying to flush usage events
